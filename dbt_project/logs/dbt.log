[0m02:13:44.182376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e7d47cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e824e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e7d3b650>]}


============================== 02:13:44.186786 | b5ae9c88-161a-40f9-8363-b601df7de8b8 ==============================
[0m02:13:44.186786 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:13:44.187888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models marts/*', 'send_anonymous_usage_stats': 'True'}
[0m02:13:44.189245 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:13:44.190346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5ae9c88-161a-40f9-8363-b601df7de8b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e7d9b990>]}
[0m02:13:44.401003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5ae9c88-161a-40f9-8363-b601df7de8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e75eead0>]}
[0m02:13:44.453781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5ae9c88-161a-40f9-8363-b601df7de8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e9aaa510>]}
[0m02:13:44.456567 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:13:44.475920 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:13:44.479487 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:13:44.480344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5ae9c88-161a-40f9-8363-b601df7de8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e717e7d0>]}
[0m02:13:45.743806 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.content_performance_mart' (models/content_performance_mart/content_performance_mart.sql) depends on a node named 'fact_post_interactions' which was not found
[0m02:13:45.746852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6256087, "process_user_time": 2.420923, "process_kernel_time": 0.547945, "process_mem_max_rss": "104272", "process_in_blocks": "2160", "process_out_blocks": "32", "command_success": false}
[0m02:13:45.748516 [debug] [MainThread]: Command `dbt run` failed at 02:13:45.748351 after 1.63 seconds
[0m02:13:45.749766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e7d9bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e7d848d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e6102b50>]}
[0m02:13:45.750588 [debug] [MainThread]: Flushing usage events
[0m02:14:43.035863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a881710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a4df790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a9f2450>]}


============================== 02:14:43.038985 | d2277a65-a523-43c6-a4b7-d9eb42cebc9b ==============================
[0m02:14:43.038985 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:14:43.040179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models marts/*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:14:43.041050 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:14:43.042028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2277a65-a523-43c6-a4b7-d9eb42cebc9b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a53f490>]}
[0m02:14:43.193270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2277a65-a523-43c6-a4b7-d9eb42cebc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a529a10>]}
[0m02:14:43.248768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2277a65-a523-43c6-a4b7-d9eb42cebc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5cdeb0d0>]}
[0m02:14:43.250179 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:14:43.262119 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:14:43.265568 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:14:43.266585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2277a65-a523-43c6-a4b7-d9eb42cebc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5999d450>]}
[0m02:14:44.448893 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.content_performance_mart' (models/content_performance_mart/content_performance_mart.sql) depends on a node named 'fact_post_interactions' which was not found
[0m02:14:44.451000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4666418, "process_user_time": 2.325481, "process_kernel_time": 0.069565, "process_mem_max_rss": "104032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:14:44.452183 [debug] [MainThread]: Command `dbt run` failed at 02:14:44.452062 after 1.47 seconds
[0m02:14:44.453016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a881710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a53fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c58d7f090>]}
[0m02:14:44.453955 [debug] [MainThread]: Flushing usage events
[0m02:30:36.689946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efb0e49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efb123b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efb0e4110>]}


============================== 02:30:36.693869 | b4ccbea2-5211-4742-830c-9eebc643de6a ==============================
[0m02:30:36.693869 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:30:36.695237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:30:36.696371 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:30:36.697382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4ccbea2-5211-4742-830c-9eebc643de6a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efb0e6690>]}
[0m02:30:36.863696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4ccbea2-5211-4742-830c-9eebc643de6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efb179790>]}
[0m02:30:36.919191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4ccbea2-5211-4742-830c-9eebc643de6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efce4e190>]}
[0m02:30:36.921133 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:30:36.933857 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:30:36.938158 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:30:36.939008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4ccbea2-5211-4742-830c-9eebc643de6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efc76ce50>]}
[0m02:30:37.877327 [error] [MainThread]: Encountered an error:
Compilation Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  source() takes exactly two arguments (1 given)
[0m02:30:37.879275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2480322, "process_user_time": 2.141753, "process_kernel_time": 0.150827, "process_mem_max_rss": "103800", "process_in_blocks": "16", "command_success": false, "process_out_blocks": "0"}
[0m02:30:37.880491 [debug] [MainThread]: Command `dbt run` failed at 02:30:37.880346 after 1.25 seconds
[0m02:30:37.881342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efb112150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efa128650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef9d8e810>]}
[0m02:30:37.882370 [debug] [MainThread]: Flushing usage events
[0m02:32:25.993782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce9fa0ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cea43e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cea43e010>]}


============================== 02:32:25.996819 | 06437a26-0fb9-4ace-9ffa-c18c9cba5124 ==============================
[0m02:32:25.996819 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:32:25.997982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:32:25.998717 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:32:25.999644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06437a26-0fb9-4ace-9ffa-c18c9cba5124', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce9fa0550>]}
[0m02:32:26.146954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06437a26-0fb9-4ace-9ffa-c18c9cba5124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce9fdc490>]}
[0m02:32:26.195210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06437a26-0fb9-4ace-9ffa-c18c9cba5124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cebd45750>]}
[0m02:32:26.196678 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:32:26.209445 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:32:26.212250 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:32:26.213289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06437a26-0fb9-4ace-9ffa-c18c9cba5124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce9300f10>]}
[0m02:32:27.389767 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.content_performance_mart' (models/marts/content_performance_mart.sql) depends on a node named 'dim_posts' which was not found
[0m02:32:27.392105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.450866, "process_user_time": 2.362017, "process_kernel_time": 0.050255, "process_mem_max_rss": "107064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:32:27.393474 [debug] [MainThread]: Command `dbt run` failed at 02:32:27.393335 after 1.45 seconds
[0m02:32:27.394546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce9fce090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce9fde0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce871de10>]}
[0m02:32:27.395888 [debug] [MainThread]: Flushing usage events
[0m02:36:27.888835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb94a63950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb94df13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb94a636d0>]}


============================== 02:36:27.891894 | b3c366e5-1730-4712-b032-2161206c60da ==============================
[0m02:36:27.891894 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:36:27.892967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models dim_posts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:36:27.893824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:36:27.894765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b3c366e5-1730-4712-b032-2161206c60da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb94a9dd10>]}
[0m02:36:28.036068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3c366e5-1730-4712-b032-2161206c60da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb93ff6bd0>]}
[0m02:36:28.085559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3c366e5-1730-4712-b032-2161206c60da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb967cd890>]}
[0m02:36:28.087514 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:36:28.099188 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:36:28.103191 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:36:28.104048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3c366e5-1730-4712-b032-2161206c60da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb94a61510>]}
[0m02:36:29.183539 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named my_first_dbt_model. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for my_first_dbt_model in one of these files:
   - models/marts/schema.yml
  models/example/schema.yml
[0m02:36:29.185363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3482404, "process_user_time": 2.220617, "process_kernel_time": 0.110528, "process_mem_max_rss": "104340", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:36:29.186824 [debug] [MainThread]: Command `dbt run` failed at 02:36:29.186705 after 1.35 seconds
[0m02:36:29.188017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb98695890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb94a9dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb93740350>]}
[0m02:36:29.189163 [debug] [MainThread]: Flushing usage events
[0m02:37:07.589033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0622057690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0622119cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062204bc50>]}


============================== 02:37:07.592256 | 04371a87-765c-4f18-81cf-87cabf59938f ==============================
[0m02:37:07.592256 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:37:07.593926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models dim_posts', 'send_anonymous_usage_stats': 'True'}
[0m02:37:07.595010 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:37:07.596043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '04371a87-765c-4f18-81cf-87cabf59938f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0622091fd0>]}
[0m02:37:07.747730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04371a87-765c-4f18-81cf-87cabf59938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06220ab850>]}
[0m02:37:07.797921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04371a87-765c-4f18-81cf-87cabf59938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0623dbdd10>]}
[0m02:37:07.799496 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:37:07.812261 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:37:07.815489 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:37:07.816497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04371a87-765c-4f18-81cf-87cabf59938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0621128350>]}
[0m02:37:08.824395 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/marts/schema.yml'
[0m02:37:08.826919 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/marts/schema.yml'
[0m02:37:09.006940 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.content_performance_mart' (models/marts/content_performance_mart.sql) depends on a source named 'social_media_sources.dim_posts' which was not found
[0m02:37:09.009283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.484067, "process_user_time": 2.384323, "process_kernel_time": 0.069833, "process_mem_max_rss": "105048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:37:09.011116 [debug] [MainThread]: Command `dbt run` failed at 02:37:09.010926 after 1.49 seconds
[0m02:37:09.012443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0622091fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0625b14f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0620dc9b50>]}
[0m02:37:09.013409 [debug] [MainThread]: Flushing usage events
[0m02:39:37.263492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee30c0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee34516d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee34513d0>]}


============================== 02:39:37.266768 | 056cbb4e-1a52-4c99-a687-dfca6cec4050 ==============================
[0m02:39:37.266768 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:39:37.267818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:39:37.268763 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:39:37.269862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '056cbb4e-1a52-4c99-a687-dfca6cec4050', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee30c0890>]}
[0m02:39:37.421211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '056cbb4e-1a52-4c99-a687-dfca6cec4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee25dedd0>]}
[0m02:39:37.469332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '056cbb4e-1a52-4c99-a687-dfca6cec4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee4e26390>]}
[0m02:39:37.471363 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:39:37.483363 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:39:37.486746 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:39:37.487768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '056cbb4e-1a52-4c99-a687-dfca6cec4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee3102850>]}
[0m02:39:38.493281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:39:38.495069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '056cbb4e-1a52-4c99-a687-dfca6cec4050', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee257f7d0>]}
[0m02:39:38.685186 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "social_media_sources_fact_post_interactions".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("social_media_sources", "fact_post_interactions").
  
  To fix this, change the name of one of these resources:
  - source.dbt_project.social_media_sources.fact_post_interactions (models/sources/fact_sources.yml)
  - source.dbt_project.social_media_sources.fact_post_interactions (models/marts/schema.yml)
[0m02:39:38.687243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4771065, "process_user_time": 2.393606, "process_kernel_time": 0.129115, "process_mem_max_rss": "107212", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:39:38.688761 [debug] [MainThread]: Command `dbt run` failed at 02:39:38.688614 after 1.48 seconds
[0m02:39:38.690271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee3451550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee30fc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee30c0890>]}
[0m02:39:38.691422 [debug] [MainThread]: Flushing usage events
[0m02:40:18.936525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43278fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4327cff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc432c96490>]}


============================== 02:40:18.939026 | 7f0a31e9-fdcf-4f44-abc1-f7264e681d4b ==============================
[0m02:40:18.939026 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:40:18.940090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'send_anonymous_usage_stats': 'True'}
[0m02:40:18.940918 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:40:18.941897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f0a31e9-fdcf-4f44-abc1-f7264e681d4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4363b5810>]}
[0m02:40:19.089937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f0a31e9-fdcf-4f44-abc1-f7264e681d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4327c9010>]}
[0m02:40:19.140761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f0a31e9-fdcf-4f44-abc1-f7264e681d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc432782a50>]}
[0m02:40:19.142270 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:40:19.155433 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:40:19.158658 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:40:19.159714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f0a31e9-fdcf-4f44-abc1-f7264e681d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4327c8090>]}
[0m02:40:20.119915 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:40:20.121211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f0a31e9-fdcf-4f44-abc1-f7264e681d4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4317aea90>]}
[0m02:40:20.305924 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.location_analysis_mart' (models/marts/location_analysis_mart.sql) depends on a node named 'fact_post_interactions' which was not found
[0m02:40:20.308201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4227147, "process_user_time": 2.289204, "process_kernel_time": 0.121015, "process_mem_max_rss": "105048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:40:20.309281 [debug] [MainThread]: Command `dbt run` failed at 02:40:20.309152 after 1.42 seconds
[0m02:40:20.310494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc432b21190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc431733210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43139fa50>]}
[0m02:40:20.311462 [debug] [MainThread]: Flushing usage events
[0m02:41:32.989646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce960950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cfb972d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce9626d0>]}


============================== 02:41:32.992760 | 47ec6403-3814-4338-917b-3b9080440518 ==============================
[0m02:41:32.992760 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:41:32.993819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:41:32.994868 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:41:32.995818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47ec6403-3814-4338-917b-3b9080440518', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce962b10>]}
[0m02:41:33.154277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ec6403-3814-4338-917b-3b9080440518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce9b6f90>]}
[0m02:41:33.207473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47ec6403-3814-4338-917b-3b9080440518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d0705cd0>]}
[0m02:41:33.209179 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:41:33.220633 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:41:33.223990 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:41:33.224949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47ec6403-3814-4338-917b-3b9080440518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cdd0d550>]}
[0m02:41:34.289592 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:41:34.291196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47ec6403-3814-4338-917b-3b9080440518', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce164610>]}
[0m02:41:34.562844 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.location_analysis_mart' (models/marts/location_analysis_mart.sql) depends on a node named 'fact_post_interactions' which was not found
[0m02:41:34.564624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6349846, "process_user_time": 2.633624, "process_kernel_time": 0.150206, "process_mem_max_rss": "105212", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:41:34.566111 [debug] [MainThread]: Command `dbt run` failed at 02:41:34.565875 after 1.64 seconds
[0m02:41:34.567247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ceef9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce98e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ce98d7d0>]}
[0m02:41:34.568614 [debug] [MainThread]: Flushing usage events
[0m02:41:40.815348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6572bba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6576493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6572afd50>]}


============================== 02:41:40.818397 | 5f82db30-6c8e-472b-bb7f-eccf9f517bbe ==============================
[0m02:41:40.818397 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:41:40.819538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:41:40.820375 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:41:40.821430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f82db30-6c8e-472b-bb7f-eccf9f517bbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6572e6c90>]}
[0m02:41:40.973127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f82db30-6c8e-472b-bb7f-eccf9f517bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6572ae5d0>]}
[0m02:41:41.028225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f82db30-6c8e-472b-bb7f-eccf9f517bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa657918490>]}
[0m02:41:41.029606 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:41:41.041243 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:41:41.044673 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:41:41.045620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f82db30-6c8e-472b-bb7f-eccf9f517bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa656778050>]}
[0m02:41:42.046705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:41:42.048014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f82db30-6c8e-472b-bb7f-eccf9f517bbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6563e7c10>]}
[0m02:41:42.251421 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.location_analysis_mart' (models/marts/location_analysis_mart.sql) depends on a node named 'fact_post_interactions' which was not found
[0m02:41:42.253196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4884807, "process_user_time": 2.32899, "process_kernel_time": 0.119948, "process_mem_max_rss": "107120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:41:42.254471 [debug] [MainThread]: Command `dbt run` failed at 02:41:42.254290 after 1.49 seconds
[0m02:41:42.255450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6572f68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6572fb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6557ee210>]}
[0m02:41:42.256355 [debug] [MainThread]: Flushing usage events
[0m02:41:52.482972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad8d38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad913bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad913fd0>]}


============================== 02:41:52.485947 | 19f5a337-09fd-40a2-824c-b260fe378840 ==============================
[0m02:41:52.485947 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:41:52.487157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_post_interactions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:41:52.488065 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:41:52.489208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '19f5a337-09fd-40a2-824c-b260fe378840', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad8fe110>]}
[0m02:41:52.645695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19f5a337-09fd-40a2-824c-b260fe378840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad931010>]}
[0m02:41:52.696773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19f5a337-09fd-40a2-824c-b260fe378840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11af666910>]}
[0m02:41:52.699071 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:41:52.709149 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:41:52.712453 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:41:52.713631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19f5a337-09fd-40a2-824c-b260fe378840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad15a2d0>]}
[0m02:41:53.637492 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:41:53.639030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '19f5a337-09fd-40a2-824c-b260fe378840', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad1bdd50>]}
[0m02:41:53.825272 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.location_analysis_mart' (models/marts/location_analysis_mart.sql) depends on a node named 'fact_post_interactions' which was not found
[0m02:41:53.827204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.399668, "process_user_time": 2.30753, "process_kernel_time": 0.098612, "process_mem_max_rss": "105068", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:41:53.828329 [debug] [MainThread]: Command `dbt run` failed at 02:41:53.828178 after 1.40 seconds
[0m02:41:53.829334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad8fe110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ade65290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ad9960d0>]}
[0m02:41:53.830643 [debug] [MainThread]: Flushing usage events
[0m02:42:50.921046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e5d71250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e5db3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e64e1210>]}


============================== 02:42:50.924083 | bb9fd6dd-ecf4-471a-9a60-87c118b22764 ==============================
[0m02:42:50.924083 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:42:50.925614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'send_anonymous_usage_stats': 'True'}
[0m02:42:50.927253 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:42:50.928764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb9fd6dd-ecf4-471a-9a60-87c118b22764', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e5d72750>]}
[0m02:42:51.099372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb9fd6dd-ecf4-471a-9a60-87c118b22764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e559a710>]}
[0m02:42:51.151118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb9fd6dd-ecf4-471a-9a60-87c118b22764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e7b19d90>]}
[0m02:42:51.152807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:42:51.163838 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:42:51.166900 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:42:51.167825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb9fd6dd-ecf4-471a-9a60-87c118b22764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e5538fd0>]}
[0m02:42:52.204154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:42:52.205818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb9fd6dd-ecf4-471a-9a60-87c118b22764', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e5df6050>]}
[0m02:42:52.319590 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "social_media_sources_fact_post_interactions".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("social_media_sources", "fact_post_interactions").
  
  To fix this, change the name of one of these resources:
  - source.dbt_project.social_media_sources.fact_post_interactions (models/marts/schema.yml)
  - source.dbt_project.social_media_sources.fact_post_interactions (models/source.yml)
[0m02:42:52.321878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4633011, "process_user_time": 2.415902, "process_kernel_time": 0.080867, "process_mem_max_rss": "105500", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:42:52.323440 [debug] [MainThread]: Command `dbt run` failed at 02:42:52.323322 after 1.46 seconds
[0m02:42:52.324525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e5d9d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e6309190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e418d250>]}
[0m02:42:52.325486 [debug] [MainThread]: Flushing usage events
[0m12:50:43.744827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ce23310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ce5af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ce16b90>]}


============================== 12:50:43.752284 | 10cd58e2-5a2b-4cf8-9309-5d00a77e256f ==============================
[0m12:50:43.752284 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:50:43.754269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:43.755978 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:50:43.757486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10cd58e2-5a2b-4cf8-9309-5d00a77e256f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ce622d0>]}
[0m12:50:43.807810 [info ] [MainThread]: dbt version: 1.8.6
[0m12:50:43.809795 [info ] [MainThread]: python version: 3.11.7
[0m12:50:43.811415 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:50:43.813031 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:50:43.983836 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m12:50:43.985915 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m12:50:43.987477 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt_project/dbt_project.yml
[0m12:50:43.989727 [info ] [MainThread]: adapter type: postgres
[0m12:50:43.991321 [info ] [MainThread]: adapter version: 1.8.2
[0m12:50:44.136837 [info ] [MainThread]: Configuration:
[0m12:50:44.138673 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:50:44.140412 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:50:44.142188 [info ] [MainThread]: Required dependencies:
[0m12:50:44.143912 [debug] [MainThread]: Executing "git --help"
[0m12:50:44.192663 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:44.194570 [debug] [MainThread]: STDERR: "b''"
[0m12:50:44.196144 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:44.197691 [info ] [MainThread]: Connection:
[0m12:50:44.199145 [info ] [MainThread]:   host: postgres_warehouse
[0m12:50:44.200543 [info ] [MainThread]:   port: 5432
[0m12:50:44.201920 [info ] [MainThread]:   user: warehouse
[0m12:50:44.203121 [info ] [MainThread]:   database: warehouse
[0m12:50:44.204572 [info ] [MainThread]:   schema: public
[0m12:50:44.206231 [info ] [MainThread]:   connect_timeout: 10
[0m12:50:44.207639 [info ] [MainThread]:   role: None
[0m12:50:44.208972 [info ] [MainThread]:   search_path: None
[0m12:50:44.210179 [info ] [MainThread]:   keepalives_idle: 0
[0m12:50:44.211348 [info ] [MainThread]:   sslmode: None
[0m12:50:44.212532 [info ] [MainThread]:   sslcert: None
[0m12:50:44.213717 [info ] [MainThread]:   sslkey: None
[0m12:50:44.214871 [info ] [MainThread]:   sslrootcert: None
[0m12:50:44.216046 [info ] [MainThread]:   application_name: dbt
[0m12:50:44.217247 [info ] [MainThread]:   retries: 1
[0m12:50:44.218599 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:50:44.222444 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:50:44.542441 [debug] [MainThread]: Using postgres connection "debug"
[0m12:50:44.544551 [debug] [MainThread]: On debug: select 1 as id
[0m12:50:44.546406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:44.658656 [debug] [MainThread]: SQL status: SELECT 1 in 0.112 seconds
[0m12:50:44.661229 [debug] [MainThread]: On debug: Close
[0m12:50:44.662866 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:50:44.664518 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:50:44.667405 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0244714, "process_user_time": 2.268951, "process_kernel_time": 0.956905, "process_mem_max_rss": "101472", "process_in_blocks": "4584", "process_out_blocks": "0"}
[0m12:50:44.669071 [debug] [MainThread]: Command `dbt debug` succeeded at 12:50:44.668878 after 1.03 seconds
[0m12:50:44.670400 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:50:44.671973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6e234e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70904c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70904390>]}
[0m12:50:44.673584 [debug] [MainThread]: Flushing usage events
[0m13:06:56.787226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253c0cd510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253c7ed090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253d5020d0>]}


============================== 13:06:56.793908 | a08033cb-3168-4e57-b51f-6c672d95682d ==============================
[0m13:06:56.793908 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:06:56.795983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:06:56.798516 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:06:56.802899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a08033cb-3168-4e57-b51f-6c672d95682d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253c10f950>]}
[0m13:06:57.082364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a08033cb-3168-4e57-b51f-6c672d95682d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253c12c2d0>]}
[0m13:06:57.165650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a08033cb-3168-4e57-b51f-6c672d95682d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253de71990>]}
[0m13:06:57.168055 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:06:57.184655 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:06:57.191126 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:06:57.193037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a08033cb-3168-4e57-b51f-6c672d95682d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253b52f390>]}
[0m13:06:58.947883 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:06:58.949893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a08033cb-3168-4e57-b51f-6c672d95682d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253b106450>]}
[0m13:06:59.146214 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "social_media_sources_fact_post_interactions".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("social_media_sources", "fact_post_interactions").
  
  To fix this, change the name of one of these resources:
  - source.dbt_project.social_media_sources.fact_post_interactions (models/marts/schema.yml)
  - source.dbt_project.social_media_sources.fact_post_interactions (models/source.yml)
[0m13:06:59.149201 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.4697013, "process_user_time": 3.90577, "process_kernel_time": 0.319653, "process_mem_max_rss": "105200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:06:59.151135 [debug] [MainThread]: Command `dbt test` failed at 13:06:59.150954 after 2.47 seconds
[0m13:06:59.152880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253c10f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253c661990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253a550b10>]}
[0m13:06:59.154809 [debug] [MainThread]: Flushing usage events
[0m13:10:16.396008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7eccdba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ed06d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ecccf810>]}


============================== 13:10:16.400994 | 2a006cee-272f-4167-ac2a-ff43a7a43cea ==============================
[0m13:10:16.400994 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:10:16.402901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:10:16.404629 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:10:16.406255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a006cee-272f-4167-ac2a-ff43a7a43cea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ecd9ded0>]}
[0m13:10:16.684235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a006cee-272f-4167-ac2a-ff43a7a43cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ec18d310>]}
[0m13:10:16.774948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a006cee-272f-4167-ac2a-ff43a7a43cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7eea3ea10>]}
[0m13:10:16.777880 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:10:16.797645 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:10:16.804245 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:10:16.805992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a006cee-272f-4167-ac2a-ff43a7a43cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ebd71810>]}
[0m13:10:18.631656 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:10:18.633395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a006cee-272f-4167-ac2a-ff43a7a43cea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ebd1e050>]}
[0m13:10:18.849463 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "social_media_sources_fact_post_interactions".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("social_media_sources", "fact_post_interactions").
  
  To fix this, change the name of one of these resources:
  - source.dbt_project.social_media_sources.fact_post_interactions (models/marts/schema.yml)
  - source.dbt_project.social_media_sources.fact_post_interactions (models/source.yml)
[0m13:10:18.852035 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.5499113, "process_user_time": 4.041274, "process_kernel_time": 0.120037, "process_mem_max_rss": "105228", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:10:18.853941 [debug] [MainThread]: Command `dbt test` failed at 13:10:18.853708 after 2.55 seconds
[0m13:10:18.855662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ecd9dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ecd09c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7eb5bd5d0>]}
[0m13:10:18.857487 [debug] [MainThread]: Flushing usage events
[0m13:13:08.440572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6ba15290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6beb2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6bfa9990>]}


============================== 13:13:08.446952 | f0ec0a8e-c33e-41d6-bd4c-da55add71dbd ==============================
[0m13:13:08.446952 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:13:08.449501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:13:08.451485 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:13:08.453533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6ba6bc90>]}
[0m13:13:08.736147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6b510690>]}
[0m13:13:08.821955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6b12ee10>]}
[0m13:13:08.824319 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:13:08.842380 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:13:08.848575 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:13:08.850202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6c6d0050>]}
[0m13:13:10.586896 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:13:10.588827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6adc8550>]}
[0m13:13:10.948721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m13:13:10.968563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6a59c7d0>]}
[0m13:13:11.286368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6add9250>]}
[0m13:13:11.288506 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m13:13:11.290301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6a141550>]}
[0m13:13:11.294614 [info ] [MainThread]: 
[0m13:13:11.296658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:13:11.304439 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m13:13:11.372322 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m13:13:11.374256 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m13:13:11.376003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:11.396746 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m13:13:11.398571 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m13:13:11.400192 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:13:11.526238 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.125 seconds
[0m13:13:11.530944 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m13:13:11.533417 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m13:13:11.543710 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:11.545733 [debug] [MainThread]: On master: BEGIN
[0m13:13:11.547660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:11.555857 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:13:11.557915 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:11.559841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:13:11.669789 [debug] [MainThread]: SQL status: SELECT 0 in 0.108 seconds
[0m13:13:11.673272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0ec0a8e-c33e-41d6-bd4c-da55add71dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6a133310>]}
[0m13:13:11.675443 [debug] [MainThread]: On master: ROLLBACK
[0m13:13:11.677822 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:11.680108 [debug] [MainThread]: On master: BEGIN
[0m13:13:11.683149 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:13:11.685305 [debug] [MainThread]: On master: COMMIT
[0m13:13:11.687958 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:11.690463 [debug] [MainThread]: On master: COMMIT
[0m13:13:11.693663 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:13:11.697027 [debug] [MainThread]: On master: Close
[0m13:13:11.700943 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:13:11.704794 [info ] [MainThread]: 
[0m13:13:11.749168 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m13:13:11.751494 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m13:13:11.755652 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m13:13:11.760098 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m13:13:11.763997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m13:13:11.767965 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m13:13:11.770743 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m13:13:11.773238 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m13:13:11.812869 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m13:13:11.816294 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m13:13:11.841892 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m13:13:11.856159 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m13:13:11.871902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m13:13:11.875795 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m13:13:11.897616 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m13:13:11.899289 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m13:13:11.901013 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:11.902681 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m13:13:11.904326 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m13:13:11.905960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:11.907442 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m13:13:11.909518 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m13:13:11.911871 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m13:13:11.913968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:13:11.915025 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.content_performance_mart" does not exist
LINE 14: from "warehouse"."public"."content_performance_mart"
              ^

[0m13:13:11.916117 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m13:13:11.917940 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m13:13:11.919811 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m13:13:11.922128 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m13:13:11.924238 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.content_performance_mart" does not exist
LINE 14: from "warehouse"."public"."content_performance_mart"
              ^

[0m13:13:11.927859 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m13:13:11.930126 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m13:13:11.944434 [debug] [Thread-1 (]: Database Error in test not_null_content_performance_mart_post_sk (models/marts/schema.yml)
  relation "public.content_performance_mart" does not exist
  LINE 14: from "warehouse"."public"."content_performance_mart"
                ^
  compiled code at target/run/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_post_sk.sql
[0m13:13:11.946445 [debug] [Thread-2 (]: Database Error in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)
  relation "public.content_performance_mart" does not exist
  LINE 14: from "warehouse"."public"."content_performance_mart"
                ^
  compiled code at target/run/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m13:13:11.948134 [error] [Thread-1 (]: 1 of 5 ERROR not_null_content_performance_mart_post_sk ......................... [[31mERROR[0m in 0.18s]
[0m13:13:11.950102 [error] [Thread-2 (]: 2 of 5 ERROR not_null_content_performance_mart_total_likes ..................... [[31mERROR[0m in 0.18s]
[0m13:13:11.952043 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m13:13:11.954140 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m13:13:11.956228 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m13:13:11.959869 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05  [[31mCANCEL[0m]
[0m13:13:11.962077 [info ] [Thread-1 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m13:13:11.963593 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c  [[31mCANCEL[0m]
[0m13:13:11.965102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m13:13:11.967713 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m13:13:11.975159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m13:13:11.989039 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m13:13:11.993735 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m13:13:12.010386 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m13:13:12.012159 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m13:13:12.013657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:12.020231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:13:12.021996 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m13:13:12.023789 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m13:13:12.026241 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.location_analysis_mart" does not exist
LINE 14: from "warehouse"."public"."location_analysis_mart"
              ^

[0m13:13:12.028106 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m13:13:12.030248 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m13:13:12.035061 [debug] [Thread-1 (]: Database Error in test not_null_location_analysis_mart_location (models/marts/schema.yml)
  relation "public.location_analysis_mart" does not exist
  LINE 14: from "warehouse"."public"."location_analysis_mart"
                ^
  compiled code at target/run/dbt_project/models/marts/schema.yml/not_null_location_analysis_mart_location.sql
[0m13:13:12.036992 [error] [Thread-1 (]: 3 of 5 ERROR not_null_location_analysis_mart_location .......................... [[31mERROR[0m in 0.07s]
[0m13:13:12.039264 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m13:13:12.041189 [info ] [MainThread]: 
[0m13:13:12.042911 [error] [MainThread]:   Database Error in test not_null_content_performance_mart_post_sk (models/marts/schema.yml)
  relation "public.content_performance_mart" does not exist
  LINE 14: from "warehouse"."public"."content_performance_mart"
                ^
  compiled code at target/run/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_post_sk.sql
[0m13:13:12.044582 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:12.045824 [debug] [MainThread]: On master: BEGIN
[0m13:13:12.046968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:12.052631 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:13:12.054178 [debug] [MainThread]: On master: COMMIT
[0m13:13:12.055443 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:12.056649 [debug] [MainThread]: On master: COMMIT
[0m13:13:12.058006 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:13:12.059136 [debug] [MainThread]: On master: Close
[0m13:13:12.060510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:12.061636 [debug] [MainThread]: Connection 'test.dbt_project.not_null_location_analysis_mart_location.7230e57461' was properly closed.
[0m13:13:12.062915 [debug] [MainThread]: Connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c' was properly closed.
[0m13:13:12.064334 [info ] [MainThread]: 
[0m13:13:12.065821 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:13:12.068176 [debug] [MainThread]: Command end result
[0m13:13:12.150525 [info ] [MainThread]: 
[0m13:13:12.152553 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m13:13:12.154176 [info ] [MainThread]: 
[0m13:13:12.155745 [error] [MainThread]:   Database Error in test not_null_content_performance_mart_post_sk (models/marts/schema.yml)
  relation "public.content_performance_mart" does not exist
  LINE 14: from "warehouse"."public"."content_performance_mart"
                ^
  compiled code at target/run/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_post_sk.sql
[0m13:13:12.157300 [info ] [MainThread]: 
[0m13:13:12.158990 [error] [MainThread]:   Skipping due to fail_fast
[0m13:13:12.160387 [info ] [MainThread]: 
[0m13:13:12.161849 [error] [MainThread]:   Skipping due to fail_fast
[0m13:13:12.163333 [info ] [MainThread]: 
[0m13:13:12.164688 [error] [MainThread]:   Skipping due to fail_fast
[0m13:13:12.166003 [info ] [MainThread]: 
[0m13:13:12.167510 [error] [MainThread]:   Skipping due to fail_fast
[0m13:13:12.168721 [info ] [MainThread]: 
[0m13:13:12.170013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m13:13:12.172002 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.824116, "process_user_time": 4.631551, "process_kernel_time": 0.238534, "process_mem_max_rss": "119604", "process_in_blocks": "2784", "process_out_blocks": "120", "command_success": false}
[0m13:13:12.173384 [debug] [MainThread]: Command `dbt test` failed at 13:13:12.173212 after 3.83 seconds
[0m13:13:12.174658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6ba50950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6bfa9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6f519050>]}
[0m13:13:12.175799 [debug] [MainThread]: Flushing usage events
[0m14:23:07.787421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ef993f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ef993d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37efd2d6d0>]}


============================== 14:23:07.790191 | 3d67d04f-b8cc-41f7-8e11-21b92da58152 ==============================
[0m14:23:07.790191 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:23:07.791276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:07.792090 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:23:07.793573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d67d04f-b8cc-41f7-8e11-21b92da58152', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f35d1890>]}
[0m14:23:07.936293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d67d04f-b8cc-41f7-8e11-21b92da58152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ef1daa10>]}
[0m14:23:07.981716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d67d04f-b8cc-41f7-8e11-21b92da58152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f1705d90>]}
[0m14:23:07.983400 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:23:07.994277 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:23:08.181711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:08.182538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:08.187631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m14:23:08.227801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d67d04f-b8cc-41f7-8e11-21b92da58152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ee9a5c10>]}
[0m14:23:08.336337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d67d04f-b8cc-41f7-8e11-21b92da58152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ef1d9690>]}
[0m14:23:08.337306 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:23:08.338167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d67d04f-b8cc-41f7-8e11-21b92da58152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ef14b890>]}
[0m14:23:08.340074 [warn ] [MainThread]: The selection criterion 'marts/content_performance_mart.sql' does not match any enabled nodes
[0m14:23:08.341624 [warn ] [MainThread]: The selection criterion 'marts/location_analysis_mart.sql' does not match any enabled nodes
[0m14:23:08.343126 [warn ] [MainThread]: The selection criterion 'marts/schema.yml' does not match any enabled nodes
[0m14:23:08.344491 [warn ] [MainThread]: The selection criterion 'marts/tag_analysis_mart.sql' does not match any enabled nodes
[0m14:23:08.345791 [warn ] [MainThread]: The selection criterion 'marts/user_engagement_mart.sql' does not match any enabled nodes
[0m14:23:08.347247 [info ] [MainThread]: 
[0m14:23:08.347964 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:23:08.350030 [debug] [MainThread]: Command end result
[0m14:23:08.388804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6532843, "process_user_time": 1.457682, "process_kernel_time": 0.059497, "process_mem_max_rss": "99508", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:08.389816 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:08.389696 after 0.65 seconds
[0m14:23:08.390865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37efa65e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ef9db950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f32dcb50>]}
[0m14:23:08.391700 [debug] [MainThread]: Flushing usage events
[0m14:27:04.368092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5578efd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd557e81490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd557e81050>]}


============================== 14:27:04.372416 | 8aa6a9da-45ee-468e-86ed-1c34529d08ac ==============================
[0m14:27:04.372416 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:27:04.373517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:04.374472 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:27:04.375532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5578e11d0>]}
[0m14:27:04.527448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd557145050>]}
[0m14:27:04.578700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5571b3cd0>]}
[0m14:27:04.580533 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:27:04.594150 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:27:04.696892 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:27:04.698109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd558df7c10>]}
[0m14:27:05.705449 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:27:05.707590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd556d91a50>]}
[0m14:27:05.949199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd556115890>]}
[0m14:27:06.054446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd556d0ecd0>]}
[0m14:27:06.055405 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:27:06.056227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa6a9da-45ee-468e-86ed-1c34529d08ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5571f3ad0>]}
[0m14:27:06.058076 [warn ] [MainThread]: The selection criterion 'marts/content_performance_mart.sql' does not match any enabled nodes
[0m14:27:06.059946 [warn ] [MainThread]: The selection criterion 'marts/location_analysis_mart.sql' does not match any enabled nodes
[0m14:27:06.061387 [warn ] [MainThread]: The selection criterion 'marts/schema.yml' does not match any enabled nodes
[0m14:27:06.062811 [warn ] [MainThread]: The selection criterion 'marts/tag_analysis_mart.sql' does not match any enabled nodes
[0m14:27:06.064315 [warn ] [MainThread]: The selection criterion 'marts/user_engagement_mart.sql' does not match any enabled nodes
[0m14:27:06.066188 [info ] [MainThread]: 
[0m14:27:06.067046 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:27:06.067928 [debug] [MainThread]: Command end result
[0m14:27:06.107747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8072681, "process_user_time": 2.62034, "process_kernel_time": 0.059779, "process_mem_max_rss": "108652", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:06.108711 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:06.108584 after 1.81 seconds
[0m14:27:06.109531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd558d03d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd55b3405d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd55b3d0fd0>]}
[0m14:27:06.110412 [debug] [MainThread]: Flushing usage events
[0m14:28:02.701110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0a2b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0a2b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0f7d490>]}


============================== 14:28:02.704172 | f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd ==============================
[0m14:28:02.704172 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:28:02.705173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models marts/content_performance_mart.sql marts/location_analysis_mart.sql marts/schema.yml marts/tag_analysis_mart.sql marts/user_engagement_mart.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:02.706090 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:28:02.707016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0a3fad0>]}
[0m14:28:02.876989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0a2b750>]}
[0m14:28:02.936671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b277e010>]}
[0m14:28:02.938225 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:28:02.950804 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:28:03.151720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:03.152656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:03.201186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0afd862d0>]}
[0m14:28:03.321623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b249bf90>]}
[0m14:28:03.322622 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:28:03.323463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f46f9c77-6cb1-43d0-8f4b-ad1309cc07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b09eaf50>]}
[0m14:28:03.325571 [warn ] [MainThread]: The selection criterion 'marts/content_performance_mart.sql' does not match any enabled nodes
[0m14:28:03.327937 [warn ] [MainThread]: The selection criterion 'marts/location_analysis_mart.sql' does not match any enabled nodes
[0m14:28:03.329392 [warn ] [MainThread]: The selection criterion 'marts/schema.yml' does not match any enabled nodes
[0m14:28:03.331184 [warn ] [MainThread]: The selection criterion 'marts/tag_analysis_mart.sql' does not match any enabled nodes
[0m14:28:03.333099 [warn ] [MainThread]: The selection criterion 'marts/user_engagement_mart.sql' does not match any enabled nodes
[0m14:28:03.335801 [info ] [MainThread]: 
[0m14:28:03.336896 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:28:03.339140 [debug] [MainThread]: Command end result
[0m14:28:03.385486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7384099, "process_user_time": 1.618776, "process_kernel_time": 0.11129, "process_mem_max_rss": "99392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:03.386924 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:03.386760 after 0.74 seconds
[0m14:28:03.387945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b0f7d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b44cce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b44ccd10>]}
[0m14:28:03.388960 [debug] [MainThread]: Flushing usage events
[0m14:33:46.537692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4f83bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4f83b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4f83b50>]}


============================== 14:33:46.540835 | cba4aaca-fe43-4a8a-8ecf-edbc9150ce29 ==============================
[0m14:33:46.540835 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:33:46.541861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models marts.content_performance_mart', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:46.542719 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:33:46.543575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4fba250>]}
[0m14:33:46.684008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4766710>]}
[0m14:33:46.730467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f6cf9d50>]}
[0m14:33:46.732092 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:33:46.743197 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:33:46.832553 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:33:46.834170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f647fbd0>]}
[0m14:33:47.833478 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:33:47.834960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f43ea850>]}
[0m14:33:48.091565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f3730710>]}
[0m14:33:48.196168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4344050>]}
[0m14:33:48.197042 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:33:48.197949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4305cd0>]}
[0m14:33:48.200369 [info ] [MainThread]: 
[0m14:33:48.201703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:48.202932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:33:48.238609 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:33:48.239908 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:33:48.240938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:48.247059 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m14:33:48.248671 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:33:48.253207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m14:33:48.259615 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:33:48.260566 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:33:48.261277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:48.265275 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:33:48.265958 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:33:48.266570 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:33:48.271073 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m14:33:48.272660 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:33:48.273362 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:33:48.278299 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.278939 [debug] [MainThread]: On master: BEGIN
[0m14:33:48.279485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:48.282977 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:33:48.283722 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.284362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:33:48.293057 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:33:48.294690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f43f3cd0>]}
[0m14:33:48.295778 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:48.296806 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.297442 [debug] [MainThread]: On master: BEGIN
[0m14:33:48.298632 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:33:48.299305 [debug] [MainThread]: On master: COMMIT
[0m14:33:48.299984 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.300540 [debug] [MainThread]: On master: COMMIT
[0m14:33:48.301205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:48.301917 [debug] [MainThread]: On master: Close
[0m14:33:48.302895 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:33:48.303882 [info ] [MainThread]: 
[0m14:33:48.307629 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m14:33:48.308696 [info ] [Thread-1 (]: 1 of 1 START sql view model public.content_performance_mart .................... [RUN]
[0m14:33:48.309849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m14:33:48.310743 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m14:33:48.318959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m14:33:48.325220 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m14:33:48.360788 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m14:33:48.367732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:33:48.368500 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m14:33:48.369159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:48.372739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:33:48.373601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:33:48.374318 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance;
  );
[0m14:33:48.377745 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: SELECT * FROM content_performance;
                                          ^

[0m14:33:48.378437 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: ROLLBACK
[0m14:33:48.379245 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m14:33:48.383700 [debug] [Thread-1 (]: Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  syntax error at or near ";"
  LINE 27: SELECT * FROM content_performance;
                                            ^
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:33:48.385415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba4aaca-fe43-4a8a-8ecf-edbc9150ce29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f3732d90>]}
[0m14:33:48.386291 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.content_performance_mart ........... [[31mERROR[0m in 0.07s]
[0m14:33:48.387384 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m14:33:48.389980 [error] [MainThread]: CANCEL query model.dbt_project.content_performance_mart ........................ [[31mCANCEL[0m]
[0m14:33:48.391022 [info ] [MainThread]: 
[0m14:33:48.391988 [error] [MainThread]:   Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  syntax error at or near ";"
  LINE 27: SELECT * FROM content_performance;
                                            ^
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:33:48.392988 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.393677 [debug] [MainThread]: On master: BEGIN
[0m14:33:48.394306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:48.398275 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:33:48.399003 [debug] [MainThread]: On master: COMMIT
[0m14:33:48.399556 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.400094 [debug] [MainThread]: On master: COMMIT
[0m14:33:48.400725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:48.401280 [debug] [MainThread]: On master: Close
[0m14:33:48.402038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:48.402657 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m14:33:48.403291 [info ] [MainThread]: 
[0m14:33:48.404225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:33:48.405582 [debug] [MainThread]: Command end result
[0m14:33:48.446499 [info ] [MainThread]: 
[0m14:33:48.447670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:33:48.448550 [info ] [MainThread]: 
[0m14:33:48.449573 [error] [MainThread]:   Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  syntax error at or near ";"
  LINE 27: SELECT * FROM content_performance;
                                            ^
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:33:48.450388 [info ] [MainThread]: 
[0m14:33:48.451180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:33:48.452324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.96673, "process_user_time": 2.652561, "process_kernel_time": 0.098976, "process_mem_max_rss": "116036", "process_in_blocks": "40", "command_success": false, "process_out_blocks": "0"}
[0m14:33:48.453256 [debug] [MainThread]: Command `dbt run` failed at 14:33:48.453130 after 1.97 seconds
[0m14:33:48.453949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f4fba250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f8a4cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f8a4d250>]}
[0m14:33:48.454692 [debug] [MainThread]: Flushing usage events
[0m14:34:24.008714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62ae8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62ae8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62ae86d0>]}


============================== 14:34:24.014124 | a2960d61-5d14-4a40-abf4-873ae68968f3 ==============================
[0m14:34:24.014124 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:34:24.016302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --models marts/*', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:34:24.017528 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:34:24.018485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2960d61-5d14-4a40-abf4-873ae68968f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62b49190>]}
[0m14:34:24.164162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2960d61-5d14-4a40-abf4-873ae68968f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c623517d0>]}
[0m14:34:24.212145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2960d61-5d14-4a40-abf4-873ae68968f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c64891d10>]}
[0m14:34:24.213860 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:34:24.226143 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:34:24.421420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:24.422147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:24.465322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2960d61-5d14-4a40-abf4-873ae68968f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c61b399d0>]}
[0m14:34:24.589658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2960d61-5d14-4a40-abf4-873ae68968f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c60f90f50>]}
[0m14:34:24.590703 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:34:24.591693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2960d61-5d14-4a40-abf4-873ae68968f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c61f42b90>]}
[0m14:34:24.593907 [warn ] [MainThread]: The selection criterion 'marts/*' does not match any enabled nodes
[0m14:34:24.594889 [warn ] [MainThread]: No nodes selected!
[0m14:34:24.596740 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6432446, "process_user_time": 1.457168, "process_kernel_time": 0.059074, "process_mem_max_rss": "101028", "process_in_blocks": "24", "process_out_blocks": "0"}
[0m14:34:24.598209 [debug] [MainThread]: Command `dbt ls` succeeded at 14:34:24.598065 after 0.64 seconds
[0m14:34:24.599385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62b4b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c63259490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6646cb10>]}
[0m14:34:24.600299 [debug] [MainThread]: Flushing usage events
[0m14:37:39.067065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e359190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e397f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e358550>]}


============================== 14:37:39.069582 | c8825987-b06f-49b9-b8ab-766122a56f6a ==============================
[0m14:37:39.069582 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:37:39.070752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models marts.content_performance_mart', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:39.071800 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:37:39.072797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e35aa50>]}
[0m14:37:39.215169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5db5ecd0>]}
[0m14:37:39.262007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c600c5dd0>]}
[0m14:37:39.263833 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:37:39.274189 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:37:39.465038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:39.465722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:39.505671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5db79b90>]}
[0m14:37:39.624496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5dbd9b90>]}
[0m14:37:39.625648 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:37:39.626594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5fddd4d0>]}
[0m14:37:39.628622 [info ] [MainThread]: 
[0m14:37:39.630053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:39.631913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:37:39.665113 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:37:39.666420 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:37:39.667621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:39.672484 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m14:37:39.674227 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:37:39.678968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m14:37:39.684882 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:37:39.685997 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:37:39.686984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:39.690460 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:37:39.691209 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:37:39.691930 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:39.694389 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:37:39.696132 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:37:39.697558 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:37:39.704377 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:39.705277 [debug] [MainThread]: On master: BEGIN
[0m14:37:39.706011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:39.709449 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:37:39.710422 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:39.711142 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:39.717966 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:37:39.719650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5efa4ed0>]}
[0m14:37:39.720504 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:39.721288 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:39.721898 [debug] [MainThread]: On master: BEGIN
[0m14:37:39.722902 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:39.723657 [debug] [MainThread]: On master: COMMIT
[0m14:37:39.724607 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:39.725498 [debug] [MainThread]: On master: COMMIT
[0m14:37:39.726725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:39.727636 [debug] [MainThread]: On master: Close
[0m14:37:39.728524 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:37:39.729290 [info ] [MainThread]: 
[0m14:37:39.732448 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m14:37:39.733513 [info ] [Thread-1 (]: 1 of 1 START sql view model public.content_performance_mart .................... [RUN]
[0m14:37:39.734404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m14:37:39.735079 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m14:37:39.742963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m14:37:39.748701 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m14:37:39.780815 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m14:37:39.787868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:37:39.788712 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m14:37:39.789383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:39.792769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:37:39.793461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:37:39.794103 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance;
  );
[0m14:37:39.795293 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: SELECT * FROM content_performance;
                                          ^

[0m14:37:39.796052 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: ROLLBACK
[0m14:37:39.797091 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m14:37:39.800255 [debug] [Thread-1 (]: Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  syntax error at or near ";"
  LINE 27: SELECT * FROM content_performance;
                                            ^
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:37:39.801758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8825987-b06f-49b9-b8ab-766122a56f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b705450>]}
[0m14:37:39.802612 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.content_performance_mart ........... [[31mERROR[0m in 0.07s]
[0m14:37:39.803759 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m14:37:39.806438 [error] [MainThread]: CANCEL query model.dbt_project.content_performance_mart ........................ [[31mCANCEL[0m]
[0m14:37:39.807483 [info ] [MainThread]: 
[0m14:37:39.808449 [error] [MainThread]:   Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  syntax error at or near ";"
  LINE 27: SELECT * FROM content_performance;
                                            ^
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:37:39.809358 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:39.810023 [debug] [MainThread]: On master: BEGIN
[0m14:37:39.810657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:39.814486 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:37:39.815408 [debug] [MainThread]: On master: COMMIT
[0m14:37:39.816030 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:39.816602 [debug] [MainThread]: On master: COMMIT
[0m14:37:39.817350 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:39.817964 [debug] [MainThread]: On master: Close
[0m14:37:39.818734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:39.819361 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m14:37:39.820051 [info ] [MainThread]: 
[0m14:37:39.820778 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:37:39.821813 [debug] [MainThread]: Command end result
[0m14:37:39.861205 [info ] [MainThread]: 
[0m14:37:39.862366 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:37:39.863417 [info ] [MainThread]: 
[0m14:37:39.864792 [error] [MainThread]:   Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  syntax error at or near ";"
  LINE 27: SELECT * FROM content_performance;
                                            ^
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:37:39.865692 [info ] [MainThread]: 
[0m14:37:39.866622 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:37:39.867978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.85115904, "process_user_time": 1.576977, "process_kernel_time": 0.09918, "process_mem_max_rss": "109140", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:37:39.868877 [debug] [MainThread]: Command `dbt run` failed at 14:37:39.868760 after 0.85 seconds
[0m14:37:39.869605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e6e9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e359e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5e358790>]}
[0m14:37:39.870337 [debug] [MainThread]: Flushing usage events
[0m14:39:02.108826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6855474050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f685546bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68566ab2d0>]}


============================== 14:39:02.112637 | a03c7323-149d-44ce-8121-b81de1fbe5d9 ==============================
[0m14:39:02.112637 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:39:02.114095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models marts.content_performance_mart', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:02.115392 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:39:02.116626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68554cbe90>]}
[0m14:39:02.284398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68554b55d0>]}
[0m14:39:02.338983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f685452ed50>]}
[0m14:39:02.340169 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:39:02.349889 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:39:02.552898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m14:39:02.553891 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/location_analysis_mart.sql
[0m14:39:02.554667 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/content_performance_mart.sql
[0m14:39:02.555416 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/user_engagement_mart.sql
[0m14:39:02.556186 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/tag_analysis_mart.sql
[0m14:39:02.775387 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:39:02.776651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68541b6110>]}
[0m14:39:02.960810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6853914710>]}
[0m14:39:03.067361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6854924a90>]}
[0m14:39:03.068340 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:39:03.069424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68539acfd0>]}
[0m14:39:03.071736 [info ] [MainThread]: 
[0m14:39:03.073017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:03.074541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:39:03.107708 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:39:03.108644 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:39:03.109447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:03.114957 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m14:39:03.116777 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:39:03.122288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m14:39:03.130086 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:39:03.131005 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:39:03.131777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:03.135626 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:39:03.136434 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:39:03.137115 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:39:03.139758 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:39:03.141511 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:39:03.142483 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:39:03.148228 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:03.149284 [debug] [MainThread]: On master: BEGIN
[0m14:39:03.150146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:03.154289 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:39:03.155177 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:03.155834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:03.162241 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:39:03.164086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6851904210>]}
[0m14:39:03.165096 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:03.166220 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:03.167199 [debug] [MainThread]: On master: BEGIN
[0m14:39:03.168320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:39:03.169165 [debug] [MainThread]: On master: COMMIT
[0m14:39:03.169881 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:03.170586 [debug] [MainThread]: On master: COMMIT
[0m14:39:03.171346 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:03.171995 [debug] [MainThread]: On master: Close
[0m14:39:03.173005 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:39:03.174085 [info ] [MainThread]: 
[0m14:39:03.178102 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m14:39:03.179254 [info ] [Thread-1 (]: 1 of 1 START sql view model public.content_performance_mart .................... [RUN]
[0m14:39:03.180272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m14:39:03.181266 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m14:39:03.189957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m14:39:03.198955 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m14:39:03.236277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m14:39:03.242696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:39:03.243613 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m14:39:03.244267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:03.247860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:39:03.248772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:39:03.249461 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m14:39:03.341323 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.091 seconds
[0m14:39:03.347811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:39:03.348835 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m14:39:03.351081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:03.364677 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m14:39:03.365982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:39:03.367109 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m14:39:03.372518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:39:03.378574 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m14:39:03.383963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:39:03.385101 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m14:39:03.387787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:39:03.390273 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m14:39:03.391959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03c7323-149d-44ce-8121-b81de1fbe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68535e60d0>]}
[0m14:39:03.393014 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.21s]
[0m14:39:03.394285 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m14:39:03.396449 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:03.397013 [debug] [MainThread]: On master: BEGIN
[0m14:39:03.397613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:03.400857 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:39:03.401505 [debug] [MainThread]: On master: COMMIT
[0m14:39:03.402057 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:03.402638 [debug] [MainThread]: On master: COMMIT
[0m14:39:03.403381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:03.403957 [debug] [MainThread]: On master: Close
[0m14:39:03.404644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:03.405160 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m14:39:03.405684 [info ] [MainThread]: 
[0m14:39:03.406374 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:39:03.407657 [debug] [MainThread]: Command end result
[0m14:39:03.443824 [info ] [MainThread]: 
[0m14:39:03.445115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:03.446367 [info ] [MainThread]: 
[0m14:39:03.447276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:03.448559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4099005, "process_user_time": 2.044956, "process_kernel_time": 0.079803, "process_mem_max_rss": "116904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:39:03.449447 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:03.449309 after 1.41 seconds
[0m14:39:03.450198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68554a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6855be5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6858df8b50>]}
[0m14:39:03.450893 [debug] [MainThread]: Flushing usage events
[0m14:39:45.069814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00cc74fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00cc74c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00cc742d0>]}


============================== 14:39:45.072720 | 1c6e3c5a-71ef-4205-b7f2-ec553418bc5c ==============================
[0m14:39:45.072720 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:39:45.073682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models marts/*', 'send_anonymous_usage_stats': 'True'}
[0m14:39:45.074495 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:39:45.075747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c6e3c5a-71ef-4205-b7f2-ec553418bc5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00ccd3a90>]}
[0m14:39:45.221777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c6e3c5a-71ef-4205-b7f2-ec553418bc5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00c1d74d0>]}
[0m14:39:45.270408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c6e3c5a-71ef-4205-b7f2-ec553418bc5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00ea06290>]}
[0m14:39:45.271971 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:39:45.282448 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:39:45.489342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:45.490319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:45.535813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c6e3c5a-71ef-4205-b7f2-ec553418bc5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00b9549d0>]}
[0m14:39:45.668082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c6e3c5a-71ef-4205-b7f2-ec553418bc5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00c159a50>]}
[0m14:39:45.669380 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:39:45.670574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c6e3c5a-71ef-4205-b7f2-ec553418bc5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00ccaf6d0>]}
[0m14:39:45.673072 [warn ] [MainThread]: The selection criterion 'marts/*' does not match any enabled nodes
[0m14:39:45.675376 [info ] [MainThread]: 
[0m14:39:45.676818 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:39:45.679866 [debug] [MainThread]: Command end result
[0m14:39:45.724956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.71008587, "process_user_time": 1.692847, "process_kernel_time": 0.060101, "process_mem_max_rss": "99380", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:39:45.726531 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:45.726311 after 0.71 seconds
[0m14:39:45.727755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0105d4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0107545d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc010754ed0>]}
[0m14:39:45.728589 [debug] [MainThread]: Flushing usage events
[0m14:42:54.387315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5933b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5e3a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5cc5310>]}


============================== 14:42:54.391300 | 6cfcd75d-8f8c-4477-85a1-c3951069a36e ==============================
[0m14:42:54.391300 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:42:54.392640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models marts', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:42:54.393804 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:42:54.394992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c596cad0>]}
[0m14:42:54.536053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c59e6c90>]}
[0m14:42:54.582355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c7696b10>]}
[0m14:42:54.583858 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:42:54.594220 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:42:54.782255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:54.782891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:54.824857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c49b1cd0>]}
[0m14:42:54.934989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c41295d0>]}
[0m14:42:54.936239 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:42:54.937374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c4dbe650>]}
[0m14:42:54.940523 [info ] [MainThread]: 
[0m14:42:54.941985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:54.947013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:42:54.980573 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:42:54.981804 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:42:54.982890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:54.987623 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m14:42:54.989437 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:42:54.991557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m14:42:54.997583 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:42:54.998876 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:42:54.999696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:55.004097 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:42:55.005157 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:42:55.006222 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:42:55.009964 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m14:42:55.012696 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:42:55.014019 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:42:55.021125 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.022480 [debug] [MainThread]: On master: BEGIN
[0m14:42:55.023580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:55.028616 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:42:55.029762 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.030749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:55.041727 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m14:42:55.044309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c4129910>]}
[0m14:42:55.045678 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:55.047056 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.048119 [debug] [MainThread]: On master: BEGIN
[0m14:42:55.049290 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:42:55.050100 [debug] [MainThread]: On master: COMMIT
[0m14:42:55.050835 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.051473 [debug] [MainThread]: On master: COMMIT
[0m14:42:55.052220 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:42:55.052810 [debug] [MainThread]: On master: Close
[0m14:42:55.053598 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:42:55.054427 [info ] [MainThread]: 
[0m14:42:55.058794 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m14:42:55.059262 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m14:42:55.060198 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m14:42:55.061199 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m14:42:55.062115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m14:42:55.062971 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m14:42:55.063706 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m14:42:55.064392 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m14:42:55.073062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m14:42:55.076171 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m14:42:55.080716 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m14:42:55.087279 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m14:42:55.127327 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m14:42:55.127829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m14:42:55.133819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:42:55.134977 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m14:42:55.136334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:42:55.136680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:55.137399 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m14:42:55.138663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:55.140997 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:42:55.142161 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:42:55.142489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:42:55.143063 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        du.location,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY du.location
)

SELECT * FROM location_performance
  );
[0m14:42:55.143726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:42:55.144773 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m14:42:55.148053 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column du.location does not exist
LINE 9:         du.location,
                ^

[0m14:42:55.148893 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: ROLLBACK
[0m14:42:55.149742 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m14:42:55.153209 [debug] [Thread-2 (]: Database Error in model location_analysis_mart (models/marts/location_analysis_mart.sql)
  column du.location does not exist
  LINE 9:         du.location,
                  ^
  compiled code at target/run/dbt_project/models/marts/location_analysis_mart.sql
[0m14:42:55.153561 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:42:55.155062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c4910090>]}
[0m14:42:55.161260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:42:55.162031 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.location_analysis_mart ............. [[31mERROR[0m in 0.09s]
[0m14:42:55.163010 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m14:42:55.164142 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m14:42:55.165697 [debug] [Thread-2 (]: Began running node model.dbt_project.tag_analysis_mart
[0m14:42:55.166146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:42:55.168559 [debug] [MainThread]: Postgres adapter: Cancelling query 'model.dbt_project.content_performance_mart' (1995)
[0m14:42:55.168090 [info ] [Thread-2 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m14:42:55.172359 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.173508 [debug] [MainThread]: On master: BEGIN
[0m14:42:55.174081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:55.177213 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:42:55.177859 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.178430 [debug] [MainThread]: On master: select pg_terminate_backend(1995)
[0m14:42:55.182220 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:42:55.183436 [debug] [MainThread]: Postgres adapter: Cancel query 'model.dbt_project.content_performance_mart': (True,)
[0m14:42:55.184624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:42:55.184215 [error] [MainThread]: CANCEL query model.dbt_project.content_performance_mart ........................ [[31mCANCEL[0m]
[0m14:42:55.185406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.location_analysis_mart, now model.dbt_project.tag_analysis_mart)
[0m14:42:55.186301 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m14:42:55.186991 [error] [MainThread]: CANCEL query model.dbt_project.location_analysis_mart .......................... [[31mCANCEL[0m]
[0m14:42:55.187984 [debug] [Thread-2 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m14:42:55.188829 [debug] [Thread-1 (]: Postgres adapter: Postgres error: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m14:42:55.189390 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:55.192760 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m14:42:55.193467 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: ROLLBACK
[0m14:42:55.194370 [debug] [MainThread]: On master: Close
[0m14:42:55.196727 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.content_performance_mart'
[0m14:42:55.197595 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:42:55.198316 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:42:55.199290 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m14:42:55.201799 [debug] [Thread-2 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m14:42:55.205749 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m14:42:55.207304 [debug] [Thread-1 (]: Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:42:55.208448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c414aa50>]}
[0m14:42:55.209331 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.content_performance_mart ........... [[31mERROR[0m in 0.15s]
[0m14:42:55.210677 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m14:42:55.213595 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:42:55.214436 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m14:42:55.215241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:55.219351 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:42:55.220295 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:42:55.221014 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m14:42:55.228808 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:42:55.232049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:42:55.232842 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m14:42:55.234339 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:42:55.248049 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m14:42:55.249325 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:42:55.250388 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m14:42:55.252803 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:42:55.258547 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m14:42:55.263831 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:42:55.264761 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m14:42:55.266044 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:42:55.268336 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: Close
[0m14:42:55.269279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cfcd75d-8f8c-4477-85a1-c3951069a36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c51e9690>]}
[0m14:42:55.270323 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:42:55.271924 [debug] [Thread-2 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m14:42:55.272917 [info ] [MainThread]: 
[0m14:42:55.274137 [error] [MainThread]:   Database Error in model location_analysis_mart (models/marts/location_analysis_mart.sql)
  column du.location does not exist
  LINE 9:         du.location,
                  ^
  compiled code at target/run/dbt_project/models/marts/location_analysis_mart.sql
[0m14:42:55.275156 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.275818 [debug] [MainThread]: On master: BEGIN
[0m14:42:55.276453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:55.279590 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:42:55.280221 [debug] [MainThread]: On master: COMMIT
[0m14:42:55.280836 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:55.281509 [debug] [MainThread]: On master: COMMIT
[0m14:42:55.282347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:42:55.283025 [debug] [MainThread]: On master: Close
[0m14:42:55.283800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:55.284475 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m14:42:55.285063 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m14:42:55.285751 [info ] [MainThread]: 
[0m14:42:55.286612 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:42:55.287943 [debug] [MainThread]: Command end result
[0m14:42:55.327635 [info ] [MainThread]: 
[0m14:42:55.328825 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:42:55.329789 [info ] [MainThread]: 
[0m14:42:55.330645 [error] [MainThread]:   Database Error in model location_analysis_mart (models/marts/location_analysis_mart.sql)
  column du.location does not exist
  LINE 9:         du.location,
                  ^
  compiled code at target/run/dbt_project/models/marts/location_analysis_mart.sql
[0m14:42:55.331492 [info ] [MainThread]: 
[0m14:42:55.332484 [error] [MainThread]:   Skipping due to fail_fast
[0m14:42:55.333509 [info ] [MainThread]: 
[0m14:42:55.334417 [error] [MainThread]:   Skipping due to fail_fast
[0m14:42:55.335192 [info ] [MainThread]: 
[0m14:42:55.336004 [error] [MainThread]:   Skipping due to fail_fast
[0m14:42:55.336727 [info ] [MainThread]: 
[0m14:42:55.337455 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m14:42:55.338565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0026085, "process_user_time": 1.679554, "process_kernel_time": 0.069981, "process_mem_max_rss": "110548", "process_in_blocks": "64", "command_success": false, "process_out_blocks": "0"}
[0m14:42:55.339376 [debug] [MainThread]: Command `dbt run` failed at 14:42:55.339274 after 1.00 seconds
[0m14:42:55.340027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c93e4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c93e5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5932450>]}
[0m14:42:55.340656 [debug] [MainThread]: Flushing usage events
[0m14:58:06.912922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd39b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd38f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd38f790>]}


============================== 14:58:06.915551 | 3e32baac-faf6-44c9-8874-34e964aab9f4 ==============================
[0m14:58:06.915551 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:58:06.916687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models marts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:06.917794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:58:06.918852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd3d6b50>]}
[0m14:58:07.074568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bcba4e90>]}
[0m14:58:07.126762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bc77eed0>]}
[0m14:58:07.128563 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:58:07.139479 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:58:07.359496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:07.360430 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/location_analysis_mart.sql
[0m14:58:07.549641 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:58:07.551361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bbfeedd0>]}
[0m14:58:07.706873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bc319810>]}
[0m14:58:07.809351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bb3d75d0>]}
[0m14:58:07.810245 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:58:07.811145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bbbcdd10>]}
[0m14:58:07.813460 [info ] [MainThread]: 
[0m14:58:07.814657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:07.818856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:58:07.849111 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:58:07.850401 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:58:07.851613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:07.859082 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m14:58:07.860932 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:58:07.862852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m14:58:07.868746 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:58:07.869800 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:58:07.870781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:07.873931 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:58:07.874582 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:58:07.875180 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:58:07.877610 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:58:07.879104 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:58:07.879784 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:58:07.884903 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.885672 [debug] [MainThread]: On master: BEGIN
[0m14:58:07.886277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:07.889250 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:58:07.889877 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.890525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:07.897979 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m14:58:07.900212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8e2d910>]}
[0m14:58:07.901268 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:07.902221 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.902915 [debug] [MainThread]: On master: BEGIN
[0m14:58:07.903751 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:58:07.904464 [debug] [MainThread]: On master: COMMIT
[0m14:58:07.905068 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.905657 [debug] [MainThread]: On master: COMMIT
[0m14:58:07.906326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:07.906923 [debug] [MainThread]: On master: Close
[0m14:58:07.907661 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:58:07.908566 [info ] [MainThread]: 
[0m14:58:07.911998 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m14:58:07.912380 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m14:58:07.913225 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m14:58:07.914187 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m14:58:07.915032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m14:58:07.915866 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m14:58:07.916585 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m14:58:07.917276 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m14:58:07.925240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m14:58:07.928243 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m14:58:07.932918 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m14:58:07.933593 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m14:58:07.974749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m14:58:07.976141 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m14:58:07.982457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:58:07.983084 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:58:07.983776 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m14:58:07.984634 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m14:58:07.985454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:07.986257 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:58:07.990281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:58:07.990708 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:58:07.991344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:58:07.992047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:58:07.992825 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m14:58:07.993562 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        dp.location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance;
  );
[0m14:58:07.997405 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: SELECT * FROM location_performance;
                                           ^

[0m14:58:07.998170 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: ROLLBACK
[0m14:58:07.999048 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m14:58:08.002939 [debug] [Thread-2 (]: Database Error in model location_analysis_mart (models/marts/location_analysis_mart.sql)
  syntax error at or near ";"
  LINE 24: SELECT * FROM location_performance;
                                             ^
  compiled code at target/run/dbt_project/models/marts/location_analysis_mart.sql
[0m14:58:08.004771 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8ecfdd0>]}
[0m14:58:08.005812 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.location_analysis_mart ............. [[31mERROR[0m in 0.09s]
[0m14:58:08.006666 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:58:08.007470 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m14:58:08.014742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:58:08.015558 [debug] [Thread-2 (]: Began running node model.dbt_project.tag_analysis_mart
[0m14:58:08.017276 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m14:58:08.017804 [debug] [MainThread]: Postgres adapter: Cancelling query 'model.dbt_project.content_performance_mart' (2036)
[0m14:58:08.018511 [info ] [Thread-2 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m14:58:08.019941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:08.020250 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.024399 [debug] [MainThread]: On master: BEGIN
[0m14:58:08.025100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:08.028581 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:58:08.029454 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.030089 [debug] [MainThread]: On master: select pg_terminate_backend(2036)
[0m14:58:08.031592 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m14:58:08.032557 [debug] [MainThread]: Postgres adapter: Cancel query 'model.dbt_project.content_performance_mart': (True,)
[0m14:58:08.033555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.location_analysis_mart, now model.dbt_project.tag_analysis_mart)
[0m14:58:08.033293 [error] [MainThread]: CANCEL query model.dbt_project.content_performance_mart ........................ [[31mCANCEL[0m]
[0m14:58:08.034106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:58:08.034859 [debug] [Thread-2 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m14:58:08.035499 [error] [MainThread]: CANCEL query model.dbt_project.location_analysis_mart .......................... [[31mCANCEL[0m]
[0m14:58:08.036457 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m14:58:08.039930 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m14:58:08.040645 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:08.041470 [debug] [Thread-1 (]: Postgres adapter: Postgres error: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m14:58:08.042658 [debug] [MainThread]: On master: Close
[0m14:58:08.043216 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: ROLLBACK
[0m14:58:08.045411 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.content_performance_mart'
[0m14:58:08.046442 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:58:08.047185 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:58:08.047991 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m14:58:08.048415 [debug] [Thread-2 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m14:58:08.051493 [debug] [Thread-1 (]: Database Error in model content_performance_mart (models/marts/content_performance_mart.sql)
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled code at target/run/dbt_project/models/marts/content_performance_mart.sql
[0m14:58:08.056369 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m14:58:08.057200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bb78e010>]}
[0m14:58:08.058626 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.content_performance_mart ........... [[31mERROR[0m in 0.14s]
[0m14:58:08.059983 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m14:58:08.063724 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:58:08.064412 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m14:58:08.065028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:08.068239 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m14:58:08.068886 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:58:08.069527 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m14:58:08.076225 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:58:08.079973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:58:08.080659 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m14:58:08.081781 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:58:08.084585 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:58:08.085350 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m14:58:08.086452 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:58:08.101475 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m14:58:08.102835 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:58:08.104085 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m14:58:08.106763 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:58:08.112828 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m14:58:08.118395 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:58:08.119324 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m14:58:08.137679 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m14:58:08.140625 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: Close
[0m14:58:08.142102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32baac-faf6-44c9-8874-34e964aab9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8ec0c90>]}
[0m14:58:08.143417 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:58:08.144798 [debug] [Thread-2 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m14:58:08.145803 [info ] [MainThread]: 
[0m14:58:08.146702 [error] [MainThread]:   Database Error in model location_analysis_mart (models/marts/location_analysis_mart.sql)
  syntax error at or near ";"
  LINE 24: SELECT * FROM location_performance;
                                             ^
  compiled code at target/run/dbt_project/models/marts/location_analysis_mart.sql
[0m14:58:08.147654 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.148395 [debug] [MainThread]: On master: BEGIN
[0m14:58:08.149007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:08.152333 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:58:08.153066 [debug] [MainThread]: On master: COMMIT
[0m14:58:08.153703 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.154284 [debug] [MainThread]: On master: COMMIT
[0m14:58:08.155020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:08.155609 [debug] [MainThread]: On master: Close
[0m14:58:08.156358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:08.156932 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m14:58:08.157521 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m14:58:08.158261 [info ] [MainThread]: 
[0m14:58:08.159034 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:58:08.160139 [debug] [MainThread]: Command end result
[0m14:58:08.201619 [info ] [MainThread]: 
[0m14:58:08.202917 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:58:08.204211 [info ] [MainThread]: 
[0m14:58:08.205220 [error] [MainThread]:   Database Error in model location_analysis_mart (models/marts/location_analysis_mart.sql)
  syntax error at or near ";"
  LINE 24: SELECT * FROM location_performance;
                                             ^
  compiled code at target/run/dbt_project/models/marts/location_analysis_mart.sql
[0m14:58:08.206085 [info ] [MainThread]: 
[0m14:58:08.207029 [error] [MainThread]:   Skipping due to fail_fast
[0m14:58:08.207832 [info ] [MainThread]: 
[0m14:58:08.208652 [error] [MainThread]:   Skipping due to fail_fast
[0m14:58:08.209388 [info ] [MainThread]: 
[0m14:58:08.210228 [error] [MainThread]:   Skipping due to fail_fast
[0m14:58:08.211047 [info ] [MainThread]: 
[0m14:58:08.211971 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m14:58:08.213231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3541836, "process_user_time": 2.182961, "process_kernel_time": 0.088498, "process_mem_max_rss": "119140", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:58:08.214067 [debug] [MainThread]: Command `dbt run` failed at 14:58:08.213958 after 1.36 seconds
[0m14:58:08.214755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c0e4ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c0e4d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd38f690>]}
[0m14:58:08.215390 [debug] [MainThread]: Flushing usage events
[0m14:59:35.920511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec719a7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7199bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7199b010>]}


============================== 14:59:35.923213 | c1e6670d-2fe3-420e-83a2-c02170590e50 ==============================
[0m14:59:35.923213 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:59:35.924268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models marts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:59:35.925114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:59:35.925906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec719e01d0>]}
[0m14:59:36.070302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec711db750>]}
[0m14:59:36.116657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7370d6d0>]}
[0m14:59:36.118327 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:59:36.129068 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:59:36.321863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:36.323439 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/location_analysis_mart.sql
[0m14:59:36.524068 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:59:36.525886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec70d91b10>]}
[0m14:59:36.682470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec719bd210>]}
[0m14:59:36.786627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7059f2d0>]}
[0m14:59:36.787627 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m14:59:36.788631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec701cddd0>]}
[0m14:59:36.791696 [info ] [MainThread]: 
[0m14:59:36.792998 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:59:36.797396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:59:36.827196 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:59:36.828487 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:59:36.829483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:36.834375 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m14:59:36.836068 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:59:36.837970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m14:59:36.844407 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:59:36.845308 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:59:36.846349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:36.850071 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:59:36.850894 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:59:36.851604 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:59:36.854141 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:59:36.855692 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:59:36.856401 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:59:36.861539 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:36.862360 [debug] [MainThread]: On master: BEGIN
[0m14:59:36.862998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:36.866070 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:59:36.866714 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:36.867350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:59:36.874704 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m14:59:36.877141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec711dd610>]}
[0m14:59:36.878058 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:36.878957 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:36.879852 [debug] [MainThread]: On master: BEGIN
[0m14:59:36.880901 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:59:36.881529 [debug] [MainThread]: On master: COMMIT
[0m14:59:36.882117 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:36.882692 [debug] [MainThread]: On master: COMMIT
[0m14:59:36.883378 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:59:36.884012 [debug] [MainThread]: On master: Close
[0m14:59:36.884839 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:59:36.885878 [info ] [MainThread]: 
[0m14:59:36.889416 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m14:59:36.889880 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m14:59:36.890960 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m14:59:36.892203 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m14:59:36.893135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m14:59:36.893984 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m14:59:36.894715 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m14:59:36.895560 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m14:59:36.903680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m14:59:36.906624 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m14:59:36.911335 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m14:59:36.912125 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m14:59:36.955971 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m14:59:36.956431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m14:59:36.960952 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:59:36.961608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:59:36.962327 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m14:59:36.963175 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m14:59:36.964077 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:36.964891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:36.968878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m14:59:36.969323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:59:36.970014 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:59:36.970789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:59:36.971554 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        dp.location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m14:59:36.972355 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m14:59:36.978635 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:59:36.985224 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:59:36.986035 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m14:59:36.987172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:36.995936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m14:59:37.002076 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m14:59:37.006052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:59:37.007543 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:59:37.008714 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m14:59:37.009661 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m14:59:37.010993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:37.014354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:59:37.015054 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m14:59:37.015375 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:59:37.016337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:37.023447 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m14:59:37.026953 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m14:59:37.032449 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m14:59:37.033658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:59:37.034753 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m14:59:37.036015 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m14:59:37.037403 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:59:37.040070 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m14:59:37.040496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:59:37.043140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6c12e210>]}
[0m14:59:37.046083 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m14:59:37.047151 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.15s]
[0m14:59:37.048610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m14:59:37.049887 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m14:59:37.050779 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m14:59:37.051618 [debug] [Thread-2 (]: Began running node model.dbt_project.tag_analysis_mart
[0m14:59:37.053297 [info ] [Thread-2 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m14:59:37.054390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.location_analysis_mart, now model.dbt_project.tag_analysis_mart)
[0m14:59:37.055184 [debug] [Thread-2 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m14:59:37.055740 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:59:37.059501 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m14:59:37.061737 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m14:59:37.063888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec705f7f90>]}
[0m14:59:37.065151 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.17s]
[0m14:59:37.066466 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m14:59:37.067567 [debug] [Thread-1 (]: Began running node model.dbt_project.user_engagement_mart
[0m14:59:37.068331 [debug] [Thread-2 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m14:59:37.069259 [info ] [Thread-1 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m14:59:37.073849 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m14:59:37.075920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.content_performance_mart, now model.dbt_project.user_engagement_mart)
[0m14:59:37.078132 [debug] [Thread-1 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m14:59:37.083627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m14:59:37.088170 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:59:37.089255 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m14:59:37.090198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:59:37.090646 [debug] [Thread-1 (]: Began executing node model.dbt_project.user_engagement_mart
[0m14:59:37.095298 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m14:59:37.096135 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m14:59:37.097275 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:59:37.098185 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m14:59:37.102636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m14:59:37.103258 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:59:37.103824 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m14:59:37.108080 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:59:37.109610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:37.110674 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m14:59:37.112956 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:37.116320 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:59:37.117097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:59:37.117674 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m14:59:37.118590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m14:59:37.119834 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:37.120191 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m14:59:37.121890 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m14:59:37.123055 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:59:37.123739 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m14:59:37.126014 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:59:37.129974 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m14:59:37.130409 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:59:37.131410 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m14:59:37.134593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m14:59:37.136082 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m14:59:37.137553 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m14:59:37.139677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:59:37.141480 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m14:59:37.141934 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:59:37.142706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m14:59:37.144711 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: Close
[0m14:59:37.145444 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m14:59:37.146424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6c17f890>]}
[0m14:59:37.148332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:59:37.147967 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m14:59:37.151511 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m14:59:37.152589 [debug] [Thread-2 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m14:59:37.153631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m14:59:37.154843 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m14:59:37.155847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:59:37.158415 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: Close
[0m14:59:37.159813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e6670d-2fe3-420e-83a2-c02170590e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6d2e5950>]}
[0m14:59:37.160784 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:59:37.162104 [debug] [Thread-1 (]: Finished running node model.dbt_project.user_engagement_mart
[0m14:59:37.164271 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:37.164880 [debug] [MainThread]: On master: BEGIN
[0m14:59:37.165431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:37.168696 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:59:37.169407 [debug] [MainThread]: On master: COMMIT
[0m14:59:37.170069 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:37.170672 [debug] [MainThread]: On master: COMMIT
[0m14:59:37.171339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:59:37.171984 [debug] [MainThread]: On master: Close
[0m14:59:37.172735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:37.173461 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m14:59:37.174241 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m14:59:37.175264 [info ] [MainThread]: 
[0m14:59:37.176123 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m14:59:37.177613 [debug] [MainThread]: Command end result
[0m14:59:37.268911 [info ] [MainThread]: 
[0m14:59:37.270092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:37.271311 [info ] [MainThread]: 
[0m14:59:37.272561 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:59:37.274017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4059112, "process_user_time": 2.093484, "process_kernel_time": 0.139565, "process_mem_max_rss": "117916", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:59:37.275063 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:37.274938 after 1.41 seconds
[0m14:59:37.275915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec701baad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec701bb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec701b9ad0>]}
[0m14:59:37.276670 [debug] [MainThread]: Flushing usage events
[0m19:08:29.004213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700464b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700464e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700464610>]}


============================== 19:08:29.007879 | 9efda36c-57dc-4d5c-952c-62e362853976 ==============================
[0m19:08:29.007879 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:08:29.009345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:08:29.010391 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:08:29.011446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27004a0f90>]}
[0m19:08:29.177885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700491990>]}
[0m19:08:29.232496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27021cd990>]}
[0m19:08:29.234155 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:08:29.246019 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:08:29.466490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:08:29.467247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:08:29.509674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27004b7790>]}
[0m19:08:29.656115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fe5bba90>]}
[0m19:08:29.657306 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m19:08:29.658340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27004a0890>]}
[0m19:08:29.661961 [info ] [MainThread]: 
[0m19:08:29.663954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:08:29.669684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:08:29.707114 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:08:29.708287 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:08:29.709370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:29.714576 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:08:29.715519 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:08:29.716561 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:08:29.720395 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m19:08:29.722375 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:08:29.723280 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:08:29.729385 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:29.730546 [debug] [MainThread]: On master: BEGIN
[0m19:08:29.731725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:29.736635 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:08:29.737516 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:29.738236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:08:29.748209 [debug] [MainThread]: SQL status: SELECT 8 in 0.009 seconds
[0m19:08:29.751867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efda36c-57dc-4d5c-952c-62e362853976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ff5f99d0>]}
[0m19:08:29.753184 [debug] [MainThread]: On master: ROLLBACK
[0m19:08:29.754707 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:29.755780 [debug] [MainThread]: On master: BEGIN
[0m19:08:29.757063 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:08:29.757986 [debug] [MainThread]: On master: COMMIT
[0m19:08:29.758897 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:29.759545 [debug] [MainThread]: On master: COMMIT
[0m19:08:29.760497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:08:29.761263 [debug] [MainThread]: On master: Close
[0m19:08:29.762330 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:08:29.763578 [info ] [MainThread]: 
[0m19:08:29.767275 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:08:29.767776 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:08:29.768501 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m19:08:29.769412 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m19:08:29.770526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m19:08:29.771524 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m19:08:29.772708 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:08:29.773498 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:08:29.792393 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:08:29.797091 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:08:29.802111 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:08:29.808985 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:08:29.818243 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:08:29.821122 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:08:29.827058 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:08:29.827821 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:08:29.828202 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m19:08:29.828975 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m19:08:29.829887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:29.830618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:08:29.834369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:08:29.834733 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:08:29.835447 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:08:29.836140 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:08:29.836813 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m19:08:29.837494 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m19:08:35.733093 [debug] [Thread-1 (]: SQL status: SELECT 1 in 5.895 seconds
[0m19:08:35.733534 [debug] [Thread-2 (]: SQL status: SELECT 1 in 5.895 seconds
[0m19:08:35.737885 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m19:08:35.740025 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m19:08:35.741206 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m19:08:35.742115 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m19:08:35.743242 [info ] [Thread-1 (]: 1 of 5 PASS not_null_content_performance_mart_post_sk .......................... [[32mPASS[0m in 5.97s]
[0m19:08:35.744600 [error] [Thread-2 (]: 2 of 5 FAIL 162093 not_null_content_performance_mart_total_likes ............... [[31mFAIL 162093[0m in 5.97s]
[0m19:08:35.749841 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:08:35.751049 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:08:35.752035 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:08:35.753171 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m19:08:35.754466 [info ] [Thread-1 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m19:08:35.755634 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05  [[31mCANCEL[0m]
[0m19:08:35.756654 [info ] [Thread-2 (]: 4 of 5 START test not_null_tag_analysis_mart_tags .............................. [RUN]
[0m19:08:35.757688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m19:08:35.758406 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c  [[31mCANCEL[0m]
[0m19:08:35.759388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c, now test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288)
[0m19:08:35.760194 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:08:35.761649 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m19:08:35.766504 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:08:35.771327 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m19:08:35.775646 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:08:35.778416 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:08:35.778862 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m19:08:35.782873 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m19:08:35.786682 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:08:35.787480 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m19:08:35.788183 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m19:08:35.788954 [debug] [Thread-2 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: BEGIN
[0m19:08:35.789842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:35.790585 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:35.794283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:08:35.795008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:08:35.795571 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:08:35.796319 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m19:08:35.797075 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m19:08:35.797909 [debug] [Thread-2 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tags
from "warehouse"."public"."tag_analysis_mart"
where tags is null



      
    ) dbt_internal_test
[0m19:08:35.908019 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.109 seconds
[0m19:08:35.910747 [debug] [Thread-2 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: ROLLBACK
[0m19:08:35.912264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.114 seconds
[0m19:08:35.912695 [debug] [Thread-2 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: Close
[0m19:08:35.914580 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m19:08:35.915920 [error] [Thread-2 (]: 4 of 5 FAIL 1 not_null_tag_analysis_mart_tags .................................. [[31mFAIL 1[0m in 0.16s]
[0m19:08:35.917161 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m19:08:35.918318 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m19:08:35.919829 [error] [Thread-1 (]: 3 of 5 FAIL 1 not_null_location_analysis_mart_location ......................... [[31mFAIL 1[0m in 0.16s]
[0m19:08:35.921559 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:08:35.922390 [info ] [MainThread]: 
[0m19:08:35.923296 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m19:08:35.924114 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m19:08:35.925125 [info ] [MainThread]: 
[0m19:08:35.925944 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m19:08:35.926941 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:35.927566 [debug] [MainThread]: On master: BEGIN
[0m19:08:35.928189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:35.931721 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:08:35.932494 [debug] [MainThread]: On master: COMMIT
[0m19:08:35.933118 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:35.933725 [debug] [MainThread]: On master: COMMIT
[0m19:08:35.934415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:08:35.935022 [debug] [MainThread]: On master: Close
[0m19:08:35.935745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:35.936332 [debug] [MainThread]: Connection 'test.dbt_project.not_null_location_analysis_mart_location.7230e57461' was properly closed.
[0m19:08:35.936924 [debug] [MainThread]: Connection 'test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288' was properly closed.
[0m19:08:35.937620 [info ] [MainThread]: 
[0m19:08:35.938374 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m19:08:35.939776 [debug] [MainThread]: Command end result
[0m19:08:35.983911 [info ] [MainThread]: 
[0m19:08:35.985023 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m19:08:35.986169 [info ] [MainThread]: 
[0m19:08:35.987487 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m19:08:35.988517 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m19:08:35.989277 [info ] [MainThread]: 
[0m19:08:35.990129 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m19:08:35.991091 [info ] [MainThread]: 
[0m19:08:35.992017 [error] [MainThread]:   Skipping due to fail_fast
[0m19:08:35.992717 [info ] [MainThread]: 
[0m19:08:35.993549 [error] [MainThread]:   Skipping due to fail_fast
[0m19:08:35.994260 [info ] [MainThread]: 
[0m19:08:35.995022 [error] [MainThread]:   Skipping due to fail_fast
[0m19:08:35.995786 [info ] [MainThread]: 
[0m19:08:35.996594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m19:08:35.998054 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.0503993, "process_user_time": 1.774035, "process_kernel_time": 0.13798, "process_mem_max_rss": "112856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:08:35.998876 [debug] [MainThread]: Command `dbt test` failed at 19:08:35.998771 after 7.05 seconds
[0m19:08:35.999578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700464590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2700465b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fc5a6cd0>]}
[0m19:08:36.000285 [debug] [MainThread]: Flushing usage events
[0m19:13:52.586625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccbdc9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccbdc8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccbdc8550>]}


============================== 19:13:52.589122 | b707e5c3-ef79-4d70-a041-e2b3b66fcd16 ==============================
[0m19:13:52.589122 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:13:52.590466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:52.591369 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:13:52.592407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccbe098d0>]}
[0m19:13:52.732782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccb931f10>]}
[0m19:13:52.787183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccdb5dd10>]}
[0m19:13:52.788560 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:13:52.797866 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:13:52.985781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:13:52.987000 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/tag_analysis_mart.sql
[0m19:13:52.987904 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/location_analysis_mart.sql
[0m19:13:53.193131 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:13:53.194335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccb9192d0>]}
[0m19:13:53.358939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecca560490>]}
[0m19:13:53.461700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecca5f9ed0>]}
[0m19:13:53.462535 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m19:13:53.463489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccadb86d0>]}
[0m19:13:53.466445 [info ] [MainThread]: 
[0m19:13:53.467611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:13:53.472190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:13:53.501825 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:13:53.503070 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:13:53.504182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:53.509223 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m19:13:53.511027 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:13:53.513116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m19:13:53.519214 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:13:53.520186 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:13:53.521016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:53.525851 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:13:53.526750 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:13:53.527472 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:13:53.529996 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m19:13:53.531745 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:13:53.532461 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:13:53.538232 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:53.538987 [debug] [MainThread]: On master: BEGIN
[0m19:13:53.539593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:53.543704 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m19:13:53.544786 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:53.545523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:13:53.555620 [debug] [MainThread]: SQL status: SELECT 8 in 0.009 seconds
[0m19:13:53.559481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecca1b9b10>]}
[0m19:13:53.560766 [debug] [MainThread]: On master: ROLLBACK
[0m19:13:53.562155 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:53.563028 [debug] [MainThread]: On master: BEGIN
[0m19:13:53.564284 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:13:53.565070 [debug] [MainThread]: On master: COMMIT
[0m19:13:53.565877 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:53.566587 [debug] [MainThread]: On master: COMMIT
[0m19:13:53.567488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:13:53.568402 [debug] [MainThread]: On master: Close
[0m19:13:53.569364 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:13:53.570433 [info ] [MainThread]: 
[0m19:13:53.574271 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m19:13:53.574700 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m19:13:53.575493 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m19:13:53.576510 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m19:13:53.577392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m19:13:53.578346 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m19:13:53.579336 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m19:13:53.580043 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m19:13:53.587997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m19:13:53.591275 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m19:13:53.597157 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m19:13:53.603912 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m19:13:53.641269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m19:13:53.642483 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m19:13:53.648914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m19:13:53.649645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m19:13:53.650577 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m19:13:53.651621 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m19:13:53.652671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:53.653945 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:13:53.658966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m19:13:53.659391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m19:13:53.660408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m19:13:53.661494 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m19:13:53.662479 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m19:13:53.663267 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m19:13:53.675063 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m19:13:53.682547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m19:13:53.683100 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m19:13:53.687098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m19:13:53.688318 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
alter table "warehouse"."public"."location_analysis_mart" rename to "location_analysis_mart__dbt_backup"
[0m19:13:53.689262 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m19:13:53.691102 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:13:53.691434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:13:53.694682 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m19:13:53.697583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m19:13:53.698473 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m19:13:53.699601 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m19:13:53.701769 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:13:53.702150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:13:53.720064 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m19:13:53.721497 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m19:13:53.722749 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m19:13:53.723866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m19:13:53.724967 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m19:13:53.725831 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m19:13:53.728418 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:13:53.734328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m19:13:53.734554 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m19:13:53.736959 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m19:13:53.742474 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m19:13:53.743585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m19:13:53.744658 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m19:13:53.745595 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m19:13:53.749342 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:13:53.751889 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m19:13:53.752219 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m19:13:53.753941 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccadebe10>]}
[0m19:13:53.755527 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m19:13:53.756493 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.17s]
[0m19:13:53.757602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b68afd0>]}
[0m19:13:53.758518 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m19:13:53.759526 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.18s]
[0m19:13:53.760708 [debug] [Thread-2 (]: Began running node model.dbt_project.tag_analysis_mart
[0m19:13:53.761704 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m19:13:53.762507 [info ] [Thread-2 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m19:13:53.763513 [debug] [Thread-1 (]: Began running node model.dbt_project.user_engagement_mart
[0m19:13:53.764293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.location_analysis_mart, now model.dbt_project.tag_analysis_mart)
[0m19:13:53.765083 [info ] [Thread-1 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m19:13:53.766201 [debug] [Thread-2 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m19:13:53.767095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.content_performance_mart, now model.dbt_project.user_engagement_mart)
[0m19:13:53.770614 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m19:13:53.771388 [debug] [Thread-1 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m19:13:53.774845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m19:13:53.777846 [debug] [Thread-2 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m19:13:53.782097 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m19:13:53.782554 [debug] [Thread-1 (]: Began executing node model.dbt_project.user_engagement_mart
[0m19:13:53.787405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m19:13:53.791557 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m19:13:53.792251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m19:13:53.792762 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m19:13:53.793450 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m19:13:53.794119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:13:53.794760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:53.798273 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:13:53.798712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:13:53.799463 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m19:13:53.800279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m19:13:53.801333 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        COALESCE(dp.tags, '') AS tags,
        COALESCE(SUM(fpi.like_count), 0) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m19:13:53.802085 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m19:13:53.807016 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:13:53.807465 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:13:53.810753 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m19:13:53.814141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m19:13:53.814823 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m19:13:53.815529 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
alter table "warehouse"."public"."user_engagement_mart" rename to "user_engagement_mart__dbt_backup"
[0m19:13:53.817133 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:13:53.820246 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m19:13:53.820553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m19:13:53.821211 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m19:13:53.824192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m19:13:53.825331 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:13:53.825640 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m19:13:53.827235 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m19:13:53.828209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:13:53.828652 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m19:13:53.830159 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m19:13:53.830808 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m19:13:53.831561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m19:13:53.832872 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m19:13:53.835121 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:13:53.839333 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m19:13:53.839659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:13:53.840512 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m19:13:53.884276 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m19:13:53.885649 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m19:13:53.887654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m19:13:53.889926 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m19:13:53.891650 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:13:53.893594 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: Close
[0m19:13:53.893972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:13:53.894934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b6b2050>]}
[0m19:13:53.896601 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: Close
[0m19:13:53.897660 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m19:13:53.898784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b707e5c3-ef79-4d70-a041-e2b3b66fcd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b625590>]}
[0m19:13:53.899770 [debug] [Thread-2 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m19:13:53.900976 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.13s]
[0m19:13:53.902804 [debug] [Thread-1 (]: Finished running node model.dbt_project.user_engagement_mart
[0m19:13:53.905016 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:53.905769 [debug] [MainThread]: On master: BEGIN
[0m19:13:53.906454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:53.909769 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:13:53.910504 [debug] [MainThread]: On master: COMMIT
[0m19:13:53.911248 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:53.911875 [debug] [MainThread]: On master: COMMIT
[0m19:13:53.912644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:13:53.913320 [debug] [MainThread]: On master: Close
[0m19:13:53.914089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:53.914678 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m19:13:53.915438 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m19:13:53.916249 [info ] [MainThread]: 
[0m19:13:53.916997 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m19:13:53.918482 [debug] [MainThread]: Command end result
[0m19:13:53.957810 [info ] [MainThread]: 
[0m19:13:53.958940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:53.959881 [info ] [MainThread]: 
[0m19:13:53.960844 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:13:53.962216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4261936, "process_user_time": 2.047291, "process_kernel_time": 0.109321, "process_mem_max_rss": "118112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:13:53.963079 [debug] [MainThread]: Command `dbt run` succeeded at 19:13:53.962964 after 1.43 seconds
[0m19:13:53.963813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccf81c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccf72cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feccf8aced0>]}
[0m19:13:53.964493 [debug] [MainThread]: Flushing usage events
[0m19:14:00.049729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da0febad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da1489250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da137d850>]}


============================== 19:14:00.052544 | cd6f5dcb-a61b-44f0-996c-6fa02d80a795 ==============================
[0m19:14:00.052544 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:14:00.053635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:00.054391 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:14:00.055319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da0feb210>]}
[0m19:14:00.196061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da07e6c50>]}
[0m19:14:00.241453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da2d52090>]}
[0m19:14:00.243700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:14:00.254479 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:14:00.443293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:00.444001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:00.485215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da3017890>]}
[0m19:14:00.600282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9f3cbe90>]}
[0m19:14:00.601188 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m19:14:00.602040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da1029750>]}
[0m19:14:00.605028 [info ] [MainThread]: 
[0m19:14:00.606325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:00.610957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:14:00.642876 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:14:00.644181 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:14:00.645260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:00.649954 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:14:00.651233 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:14:00.652014 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:14:00.654536 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m19:14:00.656184 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:14:00.657076 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:14:00.662616 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:00.663546 [debug] [MainThread]: On master: BEGIN
[0m19:14:00.664459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:00.667958 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:14:00.668626 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:00.669392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:00.678336 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m19:14:00.681869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f5dcb-a61b-44f0-996c-6fa02d80a795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da03fd910>]}
[0m19:14:00.683340 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:00.684450 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:00.685204 [debug] [MainThread]: On master: BEGIN
[0m19:14:00.686071 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:14:00.686671 [debug] [MainThread]: On master: COMMIT
[0m19:14:00.687227 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:00.687791 [debug] [MainThread]: On master: COMMIT
[0m19:14:00.688434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:14:00.689028 [debug] [MainThread]: On master: Close
[0m19:14:00.689768 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:14:00.690679 [info ] [MainThread]: 
[0m19:14:00.693538 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:14:00.693935 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:14:00.694557 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m19:14:00.695413 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m19:14:00.696307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m19:14:00.697117 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m19:14:00.697938 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:14:00.698757 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:14:00.713953 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:14:00.718360 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:14:00.723322 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:14:00.729274 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:14:00.737700 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:14:00.740046 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:14:00.745326 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:14:00.746223 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:14:00.746554 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m19:14:00.747243 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m19:14:00.747888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:00.748607 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:14:00.752262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:14:00.752651 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:14:00.753260 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m19:14:00.753921 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m19:14:00.754584 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m19:14:00.755246 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m19:14:01.627088 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.871 seconds
[0m19:14:01.632006 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m19:14:01.633533 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m19:14:01.634897 [error] [Thread-2 (]: 2 of 5 FAIL 162093 not_null_content_performance_mart_total_likes ............... [[31mFAIL 162093[0m in 0.94s]
[0m19:14:01.636199 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m19:14:01.637280 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:14:01.639549 [debug] [MainThread]: Postgres adapter: Cancelling query 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' (2303)
[0m19:14:01.638937 [info ] [Thread-2 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m19:14:01.640431 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:01.641906 [debug] [MainThread]: On master: BEGIN
[0m19:14:01.642670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:01.644590 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.889 seconds
[0m19:14:01.646814 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m19:14:01.647543 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:01.648271 [debug] [MainThread]: On master: select pg_terminate_backend(2303)
[0m19:14:01.649528 [debug] [MainThread]: SQL status: SELECT 1 in 0.000 seconds
[0m19:14:01.650506 [debug] [MainThread]: Postgres adapter: Cancel query 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05': (True,)
[0m19:14:01.651664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m19:14:01.651372 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05  [[31mCANCEL[0m]
[0m19:14:01.652217 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m19:14:01.652820 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:14:01.653657 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c  [[31mCANCEL[0m]
[0m19:14:01.659525 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:14:01.660377 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05'
[0m19:14:01.660905 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:01.662161 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m19:14:01.663103 [debug] [MainThread]: On master: Close
[0m19:14:01.663888 [info ] [Thread-1 (]: 1 of 5 PASS not_null_content_performance_mart_post_sk .......................... [[32mPASS[0m in 0.97s]
[0m19:14:01.665585 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m19:14:01.668778 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:14:01.672166 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:14:01.679112 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:14:01.679935 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m19:14:01.680681 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:14:01.685205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:14:01.686179 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m19:14:01.686984 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m19:14:01.705918 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m19:14:01.708059 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m19:14:01.709025 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m19:14:01.710076 [info ] [Thread-2 (]: 3 of 5 PASS not_null_location_analysis_mart_location ........................... [[32mPASS[0m in 0.07s]
[0m19:14:01.711420 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m19:14:01.712781 [info ] [MainThread]: 
[0m19:14:01.713771 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m19:14:01.714782 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m19:14:01.715730 [info ] [MainThread]: 
[0m19:14:01.716640 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m19:14:01.717706 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:01.718398 [debug] [MainThread]: On master: BEGIN
[0m19:14:01.719029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:01.722435 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:14:01.723147 [debug] [MainThread]: On master: COMMIT
[0m19:14:01.723795 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:01.724424 [debug] [MainThread]: On master: COMMIT
[0m19:14:01.725198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:14:01.725835 [debug] [MainThread]: On master: Close
[0m19:14:01.726648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:01.727277 [debug] [MainThread]: Connection 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' was properly closed.
[0m19:14:01.727863 [debug] [MainThread]: Connection 'test.dbt_project.not_null_location_analysis_mart_location.7230e57461' was properly closed.
[0m19:14:01.728519 [info ] [MainThread]: 
[0m19:14:01.729226 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m19:14:01.730369 [debug] [MainThread]: Command end result
[0m19:14:01.772861 [info ] [MainThread]: 
[0m19:14:01.773785 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m19:14:01.774775 [info ] [MainThread]: 
[0m19:14:01.775892 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m19:14:01.776833 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m19:14:01.777610 [info ] [MainThread]: 
[0m19:14:01.778444 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m19:14:01.779310 [info ] [MainThread]: 
[0m19:14:01.780380 [error] [MainThread]:   Skipping due to fail_fast
[0m19:14:01.781246 [info ] [MainThread]: 
[0m19:14:01.782342 [error] [MainThread]:   Skipping due to fail_fast
[0m19:14:01.783122 [info ] [MainThread]: 
[0m19:14:01.783926 [error] [MainThread]:   Skipping due to fail_fast
[0m19:14:01.784652 [info ] [MainThread]: 
[0m19:14:01.785470 [error] [MainThread]:   Skipping due to fail_fast
[0m19:14:01.786184 [info ] [MainThread]: 
[0m19:14:01.786924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m19:14:01.788080 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7924604, "process_user_time": 1.603703, "process_kernel_time": 0.069295, "process_mem_max_rss": "110348", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:14:01.788942 [debug] [MainThread]: Command `dbt test` failed at 19:14:01.788839 after 1.79 seconds
[0m19:14:01.789683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da0fe9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da1019cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da4a9ce90>]}
[0m19:14:01.790376 [debug] [MainThread]: Flushing usage events
[0m21:30:46.566455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a96cc7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a96cbbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a96cbbcd0>]}


============================== 21:30:46.569415 | 07c10b92-2516-4bce-a6e0-b7319b47b4e1 ==============================
[0m21:30:46.569415 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:30:46.570333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models marts.content_performance_mart', 'send_anonymous_usage_stats': 'True'}
[0m21:30:46.571124 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:30:46.572001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a96cd0410>]}
[0m21:30:46.710918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a96d24dd0>]}
[0m21:30:46.760476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a98a31910>]}
[0m21:30:46.762224 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:30:46.773258 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:30:46.964298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:46.965131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:47.004744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a959755d0>]}
[0m21:30:47.107874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a961a6010>]}
[0m21:30:47.108785 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:30:47.109599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a981b72d0>]}
[0m21:30:47.111669 [info ] [MainThread]: 
[0m21:30:47.112819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:47.114444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m21:30:47.145183 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m21:30:47.146514 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:30:47.147716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:47.153205 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:30:47.155068 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:30:47.160660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m21:30:47.167450 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:30:47.168372 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:30:47.169348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:47.173320 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:30:47.174641 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:30:47.175524 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:47.178404 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m21:30:47.180055 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:30:47.180830 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:30:47.186245 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:47.187003 [debug] [MainThread]: On master: BEGIN
[0m21:30:47.187896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:47.191164 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:30:47.191997 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:47.192745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:47.201737 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m21:30:47.205584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a961c9fd0>]}
[0m21:30:47.206969 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:47.208199 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:47.208882 [debug] [MainThread]: On master: BEGIN
[0m21:30:47.209776 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:30:47.210404 [debug] [MainThread]: On master: COMMIT
[0m21:30:47.210988 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:47.211532 [debug] [MainThread]: On master: COMMIT
[0m21:30:47.212241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:47.213279 [debug] [MainThread]: On master: Close
[0m21:30:47.214681 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:30:47.215969 [info ] [MainThread]: 
[0m21:30:47.219499 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m21:30:47.220579 [info ] [Thread-1 (]: 1 of 1 START sql view model public.content_performance_mart .................... [RUN]
[0m21:30:47.221570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m21:30:47.222339 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m21:30:47.231088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m21:30:47.237915 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m21:30:47.269367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m21:30:47.276065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:30:47.277213 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m21:30:47.278273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:47.282071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:30:47.282819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:30:47.283689 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m21:30:47.291742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:30:47.297942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:30:47.298992 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m21:30:47.300295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:30:47.304372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:30:47.305254 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m21:30:47.307223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:30:47.321748 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m21:30:47.322921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:30:47.324045 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m21:30:47.328785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:30:47.334895 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m21:30:47.340036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:30:47.341231 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m21:30:47.347532 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m21:30:47.351343 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m21:30:47.353079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07c10b92-2516-4bce-a6e0-b7319b47b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8fe30b90>]}
[0m21:30:47.353932 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.13s]
[0m21:30:47.355345 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m21:30:47.357458 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:47.358196 [debug] [MainThread]: On master: BEGIN
[0m21:30:47.358819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:47.362010 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:30:47.362820 [debug] [MainThread]: On master: COMMIT
[0m21:30:47.363795 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:47.364499 [debug] [MainThread]: On master: COMMIT
[0m21:30:47.365262 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:47.365908 [debug] [MainThread]: On master: Close
[0m21:30:47.366698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:47.367320 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m21:30:47.367983 [info ] [MainThread]: 
[0m21:30:47.368761 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m21:30:47.370083 [debug] [MainThread]: Command end result
[0m21:30:47.408991 [info ] [MainThread]: 
[0m21:30:47.410188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:47.411230 [info ] [MainThread]: 
[0m21:30:47.412016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:30:47.413217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8980165, "process_user_time": 1.546895, "process_kernel_time": 0.127276, "process_mem_max_rss": "109080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:47.414087 [debug] [MainThread]: Command `dbt run` succeeded at 21:30:47.413979 after 0.90 seconds
[0m21:30:47.414871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a96d07f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a604b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a784fd0>]}
[0m21:30:47.415729 [debug] [MainThread]: Flushing usage events
[0m21:30:50.646183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a3494e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a38256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a3494ad0>]}


============================== 21:30:50.650139 | 8d19b6eb-bd73-4827-8ce6-2b218d113408 ==============================
[0m21:30:50.650139 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:30:50.651859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:30:50.653357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:30:50.654656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a34d0c50>]}
[0m21:30:50.801255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a34d2e10>]}
[0m21:30:50.848012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a51fda50>]}
[0m21:30:50.849429 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:30:50.859857 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:30:51.035233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:51.036147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:51.081508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a3512c10>]}
[0m21:30:51.208237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a15bbc50>]}
[0m21:30:51.209270 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:30:51.210238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a256c790>]}
[0m21:30:51.213442 [info ] [MainThread]: 
[0m21:30:51.214797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:51.219965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m21:30:51.255049 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:30:51.256260 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:30:51.257357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:51.262781 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m21:30:51.263845 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:30:51.264798 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:51.268388 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m21:30:51.270636 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:30:51.271634 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:30:51.278773 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:51.279899 [debug] [MainThread]: On master: BEGIN
[0m21:30:51.280883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:51.286494 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:30:51.287776 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:51.289467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:51.303387 [debug] [MainThread]: SQL status: SELECT 8 in 0.013 seconds
[0m21:30:51.307898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d19b6eb-bd73-4827-8ce6-2b218d113408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a15e2150>]}
[0m21:30:51.309077 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:51.310113 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:51.310856 [debug] [MainThread]: On master: BEGIN
[0m21:30:51.311885 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:30:51.312537 [debug] [MainThread]: On master: COMMIT
[0m21:30:51.313122 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:51.313739 [debug] [MainThread]: On master: COMMIT
[0m21:30:51.314523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:51.315183 [debug] [MainThread]: On master: Close
[0m21:30:51.316363 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:30:51.317734 [info ] [MainThread]: 
[0m21:30:51.321796 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:30:51.322284 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:30:51.323041 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m21:30:51.323898 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m21:30:51.324906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m21:30:51.325927 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m21:30:51.326992 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:30:51.327816 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:30:51.346430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:30:51.352790 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:30:51.357274 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:30:51.363203 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:30:51.373773 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:30:51.376667 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:30:51.381538 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:30:51.382511 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:30:51.383052 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m21:30:51.384078 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m21:30:51.384891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:51.385685 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:30:51.389374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:30:51.390086 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:30:51.390635 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:30:51.391388 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:30:51.392161 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m21:30:51.392945 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m21:30:52.299215 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.905 seconds
[0m21:30:52.303484 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m21:30:52.303887 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.910 seconds
[0m21:30:52.304996 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m21:30:52.306732 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m21:30:52.308091 [error] [Thread-2 (]: 2 of 5 FAIL 162093 not_null_content_performance_mart_total_likes ............... [[31mFAIL 162093[0m in 0.98s]
[0m21:30:52.309195 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m21:30:52.310052 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:30:52.311200 [info ] [Thread-1 (]: 1 of 5 PASS not_null_content_performance_mart_post_sk .......................... [[32mPASS[0m in 0.99s]
[0m21:30:52.312250 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:30:52.313734 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:30:52.314240 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05  [[31mCANCEL[0m]
[0m21:30:52.315158 [info ] [Thread-2 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m21:30:52.316539 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c  [[31mCANCEL[0m]
[0m21:30:52.317411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m21:30:52.318670 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:30:52.322861 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:30:52.329167 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:30:52.332049 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:30:52.337540 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:30:52.338176 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m21:30:52.338773 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:30:52.341779 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m21:30:52.342868 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:30:52.343955 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m21:30:52.361242 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m21:30:52.363192 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m21:30:52.364127 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m21:30:52.365131 [info ] [Thread-2 (]: 3 of 5 PASS not_null_location_analysis_mart_location ........................... [[32mPASS[0m in 0.05s]
[0m21:30:52.366650 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:30:52.367606 [info ] [MainThread]: 
[0m21:30:52.368857 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m21:30:52.369812 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m21:30:52.370748 [info ] [MainThread]: 
[0m21:30:52.371611 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m21:30:52.372476 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:52.373164 [debug] [MainThread]: On master: BEGIN
[0m21:30:52.373751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:52.377677 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:30:52.378520 [debug] [MainThread]: On master: COMMIT
[0m21:30:52.379141 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:52.379736 [debug] [MainThread]: On master: COMMIT
[0m21:30:52.380532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:52.381131 [debug] [MainThread]: On master: Close
[0m21:30:52.381909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:52.382534 [debug] [MainThread]: Connection 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' was properly closed.
[0m21:30:52.383084 [debug] [MainThread]: Connection 'test.dbt_project.not_null_location_analysis_mart_location.7230e57461' was properly closed.
[0m21:30:52.383719 [info ] [MainThread]: 
[0m21:30:52.384430 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m21:30:52.385664 [debug] [MainThread]: Command end result
[0m21:30:52.435054 [info ] [MainThread]: 
[0m21:30:52.436395 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:30:52.437490 [info ] [MainThread]: 
[0m21:30:52.438711 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m21:30:52.439719 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m21:30:52.440768 [info ] [MainThread]: 
[0m21:30:52.441875 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m21:30:52.442930 [info ] [MainThread]: 
[0m21:30:52.444604 [error] [MainThread]:   Skipping due to fail_fast
[0m21:30:52.445715 [info ] [MainThread]: 
[0m21:30:52.447096 [error] [MainThread]:   Skipping due to fail_fast
[0m21:30:52.448093 [info ] [MainThread]: 
[0m21:30:52.449108 [error] [MainThread]:   Skipping due to fail_fast
[0m21:30:52.450001 [info ] [MainThread]: 
[0m21:30:52.450926 [error] [MainThread]:   Skipping due to fail_fast
[0m21:30:52.451746 [info ] [MainThread]: 
[0m21:30:52.452574 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m21:30:52.453853 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.8640438, "process_user_time": 1.713433, "process_kernel_time": 0.060474, "process_mem_max_rss": "111464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:52.454820 [debug] [MainThread]: Command `dbt test` failed at 21:30:52.454700 after 1.87 seconds
[0m21:30:52.455648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a3496610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a34d0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a6f54350>]}
[0m21:30:52.456421 [debug] [MainThread]: Flushing usage events
[0m21:31:21.079734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201da78c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201da6f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db3e0d0>]}


============================== 21:31:21.082174 | ad322305-eacf-4f2e-9961-d05609f16580 ==============================
[0m21:31:21.082174 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:31:21.083399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:21.084546 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:31:21.085693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db3e010>]}
[0m21:31:21.235252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201da6e150>]}
[0m21:31:21.285234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201da86d50>]}
[0m21:31:21.286963 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:31:21.299223 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:31:21.490981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:21.491750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:21.531488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201c7c3c10>]}
[0m21:31:21.635335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201cf88dd0>]}
[0m21:31:21.636242 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:31:21.637289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201dab7e50>]}
[0m21:31:21.639692 [info ] [MainThread]: 
[0m21:31:21.641001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:21.646134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m21:31:21.677986 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m21:31:21.679383 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:31:21.680546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:21.685570 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:31:21.687092 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:31:21.689076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m21:31:21.695399 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:31:21.696399 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:31:21.697315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:21.700419 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:31:21.701308 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:31:21.702024 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:31:21.704656 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m21:31:21.707184 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:31:21.708641 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:31:21.714597 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:21.715484 [debug] [MainThread]: On master: BEGIN
[0m21:31:21.716166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:21.719849 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:31:21.720664 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:21.721525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:21.730874 [debug] [MainThread]: SQL status: SELECT 8 in 0.009 seconds
[0m21:31:21.733872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201cf6dcd0>]}
[0m21:31:21.734775 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:21.735741 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:21.736634 [debug] [MainThread]: On master: BEGIN
[0m21:31:21.737535 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:31:21.738161 [debug] [MainThread]: On master: COMMIT
[0m21:31:21.738729 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:21.739308 [debug] [MainThread]: On master: COMMIT
[0m21:31:21.739974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:31:21.740592 [debug] [MainThread]: On master: Close
[0m21:31:21.741364 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:31:21.742229 [info ] [MainThread]: 
[0m21:31:21.745901 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m21:31:21.746447 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m21:31:21.747309 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m21:31:21.748558 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m21:31:21.749491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m21:31:21.750651 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m21:31:21.751866 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m21:31:21.752686 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m21:31:21.761768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m21:31:21.764820 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m21:31:21.769173 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m21:31:21.770023 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m21:31:21.812200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m21:31:21.813502 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m21:31:21.819208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:31:21.820087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m21:31:21.820429 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m21:31:21.821183 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m21:31:21.821876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:21.822562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:31:21.826233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:31:21.826613 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:31:21.827218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:31:21.827943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m21:31:21.828616 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    WITH content_performance AS (
    SELECT 
        fpi.post_sk,
        dp.post_text,
        dp.tags,
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        AVG(fpi.like_count) AS avg_likes_per_post,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS performance_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY fpi.post_sk, dp.post_text, dp.tags
)

SELECT * FROM content_performance
  );
[0m21:31:21.829326 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m21:31:21.835843 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:31:21.836186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m21:31:21.842539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m21:31:21.850566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:31:21.851517 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
alter table "warehouse"."public"."location_analysis_mart" rename to "location_analysis_mart__dbt_backup"
[0m21:31:21.852631 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m21:31:21.854330 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:31:21.854635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:31:21.857523 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m21:31:21.860375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:31:21.861061 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m21:31:21.861747 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m21:31:21.862841 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:21.869034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:31:21.878579 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m21:31:21.880096 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m21:31:21.881389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m21:31:21.882326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:31:21.883149 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m21:31:21.883955 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m21:31:21.886889 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:31:21.892754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m21:31:21.892562 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m21:31:21.895674 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m21:31:21.901103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m21:31:21.902551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:31:21.903440 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.location_analysis_mart"} */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m21:31:21.904503 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m21:31:21.907191 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:31:21.908086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:31:21.910054 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m21:31:21.911536 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m21:31:21.913245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201ae5cc10>]}
[0m21:31:21.914074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201afc2690>]}
[0m21:31:21.914977 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.16s]
[0m21:31:21.916511 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.16s]
[0m21:31:21.917831 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m21:31:21.918738 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m21:31:21.919779 [debug] [Thread-2 (]: Began running node model.dbt_project.tag_analysis_mart
[0m21:31:21.920653 [debug] [Thread-1 (]: Began running node model.dbt_project.user_engagement_mart
[0m21:31:21.921567 [info ] [Thread-2 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m21:31:21.922498 [info ] [Thread-1 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m21:31:21.923425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.location_analysis_mart, now model.dbt_project.tag_analysis_mart)
[0m21:31:21.924285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.content_performance_mart, now model.dbt_project.user_engagement_mart)
[0m21:31:21.925029 [debug] [Thread-2 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m21:31:21.925755 [debug] [Thread-1 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m21:31:21.928943 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m21:31:21.932240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m21:31:21.935886 [debug] [Thread-2 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m21:31:21.936702 [debug] [Thread-1 (]: Began executing node model.dbt_project.user_engagement_mart
[0m21:31:21.940191 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m21:31:21.945073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m21:31:21.948816 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m21:31:21.949485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m21:31:21.950012 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m21:31:21.950774 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m21:31:21.951439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:31:21.952077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:21.956045 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:31:21.956496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:31:21.957130 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m21:31:21.957822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m21:31:21.958477 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        COALESCE(dp.tags, '') AS tags,
        COALESCE(SUM(fpi.like_count), 0) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m21:31:21.959186 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m21:31:21.963077 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:31:21.963629 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:31:21.967015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m21:31:21.970176 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m21:31:21.970832 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
alter table "warehouse"."public"."user_engagement_mart" rename to "user_engagement_mart__dbt_backup"
[0m21:31:21.971595 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m21:31:21.973013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:31:21.973329 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:31:21.976560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m21:31:21.979526 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m21:31:21.980200 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m21:31:21.980870 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m21:31:21.981881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:21.982487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:21.983680 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m21:31:21.985293 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m21:31:21.985962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m21:31:21.986665 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m21:31:21.987382 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m21:31:21.988124 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m21:31:21.990478 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:31:21.993153 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m21:31:21.993476 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m21:31:21.994327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m21:31:21.997008 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m21:31:21.997734 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.user_engagement_mart"} */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m21:31:21.998649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m21:31:21.999808 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.tag_analysis_mart"} */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m21:31:22.001973 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:31:22.003698 [debug] [Thread-1 (]: On model.dbt_project.user_engagement_mart: Close
[0m21:31:22.004050 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:31:22.004903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201cb05a50>]}
[0m21:31:22.006449 [debug] [Thread-2 (]: On model.dbt_project.tag_analysis_mart: Close
[0m21:31:22.007391 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:31:22.008510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad322305-eacf-4f2e-9961-d05609f16580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201adba110>]}
[0m21:31:22.009524 [debug] [Thread-1 (]: Finished running node model.dbt_project.user_engagement_mart
[0m21:31:22.010556 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:31:22.012690 [debug] [Thread-2 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m21:31:22.014638 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:22.015363 [debug] [MainThread]: On master: BEGIN
[0m21:31:22.015967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:22.019459 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:31:22.020223 [debug] [MainThread]: On master: COMMIT
[0m21:31:22.020938 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:22.021700 [debug] [MainThread]: On master: COMMIT
[0m21:31:22.022496 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:31:22.023265 [debug] [MainThread]: On master: Close
[0m21:31:22.024052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:22.024865 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m21:31:22.025558 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m21:31:22.026243 [info ] [MainThread]: 
[0m21:31:22.027214 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m21:31:22.029148 [debug] [MainThread]: Command end result
[0m21:31:22.067959 [info ] [MainThread]: 
[0m21:31:22.069121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:22.070313 [info ] [MainThread]: 
[0m21:31:22.071347 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:31:22.072700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0447295, "process_user_time": 1.654701, "process_kernel_time": 0.121075, "process_mem_max_rss": "108872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:22.073532 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:22.073427 after 1.05 seconds
[0m21:31:22.074208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db3e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20213a8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202152cf10>]}
[0m21:31:22.074928 [debug] [MainThread]: Flushing usage events
[0m21:31:26.609162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757860f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7576d15310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75767bfb10>]}


============================== 21:31:26.611631 | e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9 ==============================
[0m21:31:26.611631 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:31:26.612654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:31:26.613494 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:31:26.614499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757a3f5790>]}
[0m21:31:26.754830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7575f934d0>]}
[0m21:31:26.802076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75785297d0>]}
[0m21:31:26.803561 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:31:26.814379 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:31:27.002170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:27.003305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:27.042795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7575f39d10>]}
[0m21:31:27.153176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7574b7b990>]}
[0m21:31:27.154410 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:31:27.155453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7575385f10>]}
[0m21:31:27.158256 [info ] [MainThread]: 
[0m21:31:27.159576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:27.164703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m21:31:27.196416 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:31:27.198149 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:31:27.199514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:27.204298 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m21:31:27.205407 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:31:27.206196 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:31:27.208730 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m21:31:27.210382 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:31:27.211292 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:31:27.216908 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:27.217806 [debug] [MainThread]: On master: BEGIN
[0m21:31:27.218587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:27.221755 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:31:27.222551 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:27.223289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:27.232469 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m21:31:27.235829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3963d6f-7be4-4ff5-9b75-ffe36a9fbbd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75775e8dd0>]}
[0m21:31:27.236969 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:27.237843 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:27.238542 [debug] [MainThread]: On master: BEGIN
[0m21:31:27.239511 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:31:27.240210 [debug] [MainThread]: On master: COMMIT
[0m21:31:27.240806 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:27.241444 [debug] [MainThread]: On master: COMMIT
[0m21:31:27.242176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:31:27.242797 [debug] [MainThread]: On master: Close
[0m21:31:27.243582 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:31:27.244516 [info ] [MainThread]: 
[0m21:31:27.248134 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:31:27.248583 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:31:27.249330 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m21:31:27.250331 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m21:31:27.251373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m21:31:27.252248 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m21:31:27.253146 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:31:27.253823 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:31:27.269296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:31:27.274617 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:31:27.280131 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:31:27.280859 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:31:27.294489 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:31:27.296857 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:31:27.302187 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:31:27.302936 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:31:27.303406 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m21:31:27.304082 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m21:31:27.304767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:27.305484 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:31:27.308883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:31:27.309298 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:31:27.309890 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:31:27.310598 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:31:27.311270 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m21:31:27.311951 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m21:31:28.008235 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.695 seconds
[0m21:31:28.013361 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m21:31:28.014487 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m21:31:28.015518 [error] [Thread-2 (]: 2 of 5 FAIL 162093 not_null_content_performance_mart_total_likes ............... [[31mFAIL 162093[0m in 0.76s]
[0m21:31:28.016971 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:31:28.018035 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:31:28.018849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.706 seconds
[0m21:31:28.020020 [info ] [Thread-2 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m21:31:28.021122 [debug] [MainThread]: Postgres adapter: Cancelling query 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' (2490)
[0m21:31:28.023875 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:28.024533 [debug] [MainThread]: On master: BEGIN
[0m21:31:28.025199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:28.028437 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:31:28.029113 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:28.029715 [debug] [MainThread]: On master: select pg_terminate_backend(2490)
[0m21:31:28.031468 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m21:31:28.032243 [debug] [MainThread]: Postgres adapter: Cancel query 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05': (True,)
[0m21:31:28.033304 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m21:31:28.032952 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05  [[31mCANCEL[0m]
[0m21:31:28.033734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m21:31:28.034867 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c  [[31mCANCEL[0m]
[0m21:31:28.035730 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:31:28.036474 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:28.040930 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:31:28.041744 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05'
[0m21:31:28.042524 [debug] [MainThread]: On master: Close
[0m21:31:28.043506 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m21:31:28.044935 [info ] [Thread-1 (]: 1 of 5 PASS not_null_content_performance_mart_post_sk .......................... [[32mPASS[0m in 0.79s]
[0m21:31:28.046044 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:31:28.049028 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:31:28.051906 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:31:28.057602 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:31:28.058293 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m21:31:28.058940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:31:28.062162 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m21:31:28.062864 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:31:28.063622 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m21:31:28.080725 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m21:31:28.083062 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m21:31:28.084256 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m21:31:28.085335 [info ] [Thread-2 (]: 3 of 5 PASS not_null_location_analysis_mart_location ........................... [[32mPASS[0m in 0.06s]
[0m21:31:28.086370 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:31:28.087235 [info ] [MainThread]: 
[0m21:31:28.088110 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m21:31:28.089162 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m21:31:28.090061 [info ] [MainThread]: 
[0m21:31:28.090947 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m21:31:28.091931 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:28.092572 [debug] [MainThread]: On master: BEGIN
[0m21:31:28.093193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:28.096496 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:31:28.097307 [debug] [MainThread]: On master: COMMIT
[0m21:31:28.097976 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:28.098597 [debug] [MainThread]: On master: COMMIT
[0m21:31:28.099390 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:31:28.100046 [debug] [MainThread]: On master: Close
[0m21:31:28.100766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:28.101342 [debug] [MainThread]: Connection 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' was properly closed.
[0m21:31:28.101926 [debug] [MainThread]: Connection 'test.dbt_project.not_null_location_analysis_mart_location.7230e57461' was properly closed.
[0m21:31:28.102688 [info ] [MainThread]: 
[0m21:31:28.103477 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m21:31:28.104865 [debug] [MainThread]: Command end result
[0m21:31:28.144170 [info ] [MainThread]: 
[0m21:31:28.145456 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:31:28.146587 [info ] [MainThread]: 
[0m21:31:28.147611 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m21:31:28.148554 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m21:31:28.149470 [info ] [MainThread]: 
[0m21:31:28.150384 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m21:31:28.151199 [info ] [MainThread]: 
[0m21:31:28.152104 [error] [MainThread]:   Skipping due to fail_fast
[0m21:31:28.153029 [info ] [MainThread]: 
[0m21:31:28.154011 [error] [MainThread]:   Skipping due to fail_fast
[0m21:31:28.154919 [info ] [MainThread]: 
[0m21:31:28.155833 [error] [MainThread]:   Skipping due to fail_fast
[0m21:31:28.156575 [info ] [MainThread]: 
[0m21:31:28.157408 [error] [MainThread]:   Skipping due to fail_fast
[0m21:31:28.158192 [info ] [MainThread]: 
[0m21:31:28.159009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m21:31:28.160212 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.6012563, "process_user_time": 1.549222, "process_kernel_time": 0.09173, "process_mem_max_rss": "110372", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:28.161080 [debug] [MainThread]: Command `dbt test` failed at 21:31:28.160967 after 1.60 seconds
[0m21:31:28.161810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757a3f5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757a284f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757a2844d0>]}
[0m21:31:28.162495 [debug] [MainThread]: Flushing usage events
[0m21:32:39.777418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6f6c7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6d94f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6de62450>]}


============================== 21:32:39.780019 | 0cda111c-6315-4017-aaad-d27e8ebe10a6 ==============================
[0m21:32:39.780019 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:32:39.781148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:32:39.781975 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:32:39.782838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6d9af950>]}
[0m21:32:39.925396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6d9b4090>]}
[0m21:32:39.972424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6e5beed0>]}
[0m21:32:39.974168 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:32:39.984891 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:32:40.176571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:32:40.177560 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/content_performance_mart.sql
[0m21:32:40.374799 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:32:40.376772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6c103fd0>]}
[0m21:32:40.540505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6c5be550>]}
[0m21:32:40.652289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f69c56450>]}
[0m21:32:40.653264 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:32:40.654264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f69c37dd0>]}
[0m21:32:40.657131 [info ] [MainThread]: 
[0m21:32:40.658458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:40.663122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m21:32:40.693378 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:32:40.694917 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:32:40.695953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:40.700591 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m21:32:40.701558 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:32:40.702388 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:32:40.705072 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m21:32:40.706962 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:32:40.707934 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:32:40.713676 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:40.714483 [debug] [MainThread]: On master: BEGIN
[0m21:32:40.715419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:40.719189 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:32:40.720107 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:40.720909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:40.730205 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m21:32:40.735066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cda111c-6315-4017-aaad-d27e8ebe10a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6c138550>]}
[0m21:32:40.736286 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:40.737556 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:40.738513 [debug] [MainThread]: On master: BEGIN
[0m21:32:40.739738 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:32:40.740831 [debug] [MainThread]: On master: COMMIT
[0m21:32:40.741639 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:40.742282 [debug] [MainThread]: On master: COMMIT
[0m21:32:40.743300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:40.743914 [debug] [MainThread]: On master: Close
[0m21:32:40.744671 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:32:40.745349 [info ] [MainThread]: 
[0m21:32:40.748443 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:40.748870 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:40.749544 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m21:32:40.750313 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m21:32:40.751192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m21:32:40.752115 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m21:32:40.752831 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:40.753508 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:40.768988 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:40.772544 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:40.778505 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:40.779025 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:40.793416 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:40.796020 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:40.802159 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:40.802682 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:40.803379 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m21:32:40.804185 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m21:32:40.804790 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:40.805442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:40.809210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:32:40.810018 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:40.810841 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m21:32:40.811203 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m21:32:40.812171 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:40.812797 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m21:32:41.506228 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.693 seconds
[0m21:32:41.510935 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m21:32:41.511927 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m21:32:41.513000 [error] [Thread-2 (]: 2 of 5 FAIL 162093 not_null_content_performance_mart_total_likes ............... [[31mFAIL 162093[0m in 0.76s]
[0m21:32:41.514352 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:41.515440 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:41.517549 [debug] [MainThread]: Postgres adapter: Cancelling query 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' (2506)
[0m21:32:41.518302 [info ] [Thread-2 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m21:32:41.519303 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:41.520628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.709 seconds
[0m21:32:41.521367 [debug] [MainThread]: On master: BEGIN
[0m21:32:41.523663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:41.527112 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:32:41.527898 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:41.528532 [debug] [MainThread]: On master: select pg_terminate_backend(2506)
[0m21:32:41.529454 [debug] [MainThread]: SQL status: SELECT 1 in 0.000 seconds
[0m21:32:41.530129 [debug] [MainThread]: Postgres adapter: Cancel query 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05': (True,)
[0m21:32:41.531110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m21:32:41.530813 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05  [[31mCANCEL[0m]
[0m21:32:41.531680 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m21:32:41.532558 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:41.533415 [error] [MainThread]: CANCEL query test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c  [[31mCANCEL[0m]
[0m21:32:41.539062 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:41.540272 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05'
[0m21:32:41.540735 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:41.542273 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m21:32:41.543323 [debug] [MainThread]: On master: Close
[0m21:32:41.544203 [info ] [Thread-1 (]: 1 of 5 PASS not_null_content_performance_mart_post_sk .......................... [[32mPASS[0m in 0.79s]
[0m21:32:41.545866 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:41.548180 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:41.552515 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:41.558930 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:41.559665 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m21:32:41.560293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:32:41.563584 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m21:32:41.564334 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:41.564995 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m21:32:41.583358 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m21:32:41.585869 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m21:32:41.586987 [debug] [Thread-2 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m21:32:41.588186 [info ] [Thread-2 (]: 3 of 5 PASS not_null_location_analysis_mart_location ........................... [[32mPASS[0m in 0.07s]
[0m21:32:41.589365 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:41.590463 [info ] [MainThread]: 
[0m21:32:41.591630 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m21:32:41.592726 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m21:32:41.593697 [info ] [MainThread]: 
[0m21:32:41.594656 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m21:32:41.595614 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:41.596262 [debug] [MainThread]: On master: BEGIN
[0m21:32:41.596879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:41.600080 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:32:41.600907 [debug] [MainThread]: On master: COMMIT
[0m21:32:41.603129 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:41.603928 [debug] [MainThread]: On master: COMMIT
[0m21:32:41.604773 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:41.605413 [debug] [MainThread]: On master: Close
[0m21:32:41.606162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:41.606738 [debug] [MainThread]: Connection 'test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05' was properly closed.
[0m21:32:41.607303 [debug] [MainThread]: Connection 'test.dbt_project.not_null_location_analysis_mart_location.7230e57461' was properly closed.
[0m21:32:41.607932 [info ] [MainThread]: 
[0m21:32:41.608639 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m21:32:41.609850 [debug] [MainThread]: Command end result
[0m21:32:41.649077 [info ] [MainThread]: 
[0m21:32:41.650452 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:32:41.651863 [info ] [MainThread]: 
[0m21:32:41.653048 [error] [MainThread]: [31mFailure in test not_null_content_performance_mart_total_likes (models/marts/schema.yml)[0m
[0m21:32:41.654148 [error] [MainThread]:   Got 162093 results, configured to fail if != 0
[0m21:32:41.655112 [info ] [MainThread]: 
[0m21:32:41.655981 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_content_performance_mart_total_likes.sql
[0m21:32:41.656803 [info ] [MainThread]: 
[0m21:32:41.657675 [error] [MainThread]:   Skipping due to fail_fast
[0m21:32:41.658518 [info ] [MainThread]: 
[0m21:32:41.659560 [error] [MainThread]:   Skipping due to fail_fast
[0m21:32:41.660353 [info ] [MainThread]: 
[0m21:32:41.661189 [error] [MainThread]:   Skipping due to fail_fast
[0m21:32:41.661941 [info ] [MainThread]: 
[0m21:32:41.662795 [error] [MainThread]:   Skipping due to fail_fast
[0m21:32:41.663619 [info ] [MainThread]: 
[0m21:32:41.664387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m21:32:41.665649 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.9403532, "process_user_time": 2.011764, "process_kernel_time": 0.108477, "process_mem_max_rss": "118684", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:32:41.666529 [debug] [MainThread]: Command `dbt test` failed at 21:32:41.666413 after 1.94 seconds
[0m21:32:41.667368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6d9af310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6d9af410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f7140d250>]}
[0m21:32:41.668203 [debug] [MainThread]: Flushing usage events
[0m21:32:52.029750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56c5f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56c9f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56c53dd0>]}


============================== 21:32:52.032305 | e09a712c-b770-488e-994e-c8cc138b4982 ==============================
[0m21:32:52.032305 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:32:52.033445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models marts.content_performance_mart', 'send_anonymous_usage_stats': 'True'}
[0m21:32:52.034231 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:32:52.035110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56c9a8d0>]}
[0m21:32:52.189395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56c5ed10>]}
[0m21:32:52.240582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5672f8d0>]}
[0m21:32:52.241998 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:32:52.251865 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:32:52.441002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:52.441690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:52.482053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd55fb6390>]}
[0m21:32:52.584904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5678ac10>]}
[0m21:32:52.585823 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:32:52.586734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd584ff410>]}
[0m21:32:52.589609 [info ] [MainThread]: 
[0m21:32:52.590893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:52.592413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m21:32:52.623418 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m21:32:52.624894 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:32:52.626220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:52.630898 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:32:52.632977 [debug] [ThreadPool]: On list_warehouse: Close
[0m21:32:52.637606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m21:32:52.643330 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:32:52.644435 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:32:52.645223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:52.648535 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:32:52.649443 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:32:52.650161 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:32:52.652849 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m21:32:52.654417 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:32:52.655378 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:32:52.661176 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.662068 [debug] [MainThread]: On master: BEGIN
[0m21:32:52.662738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:52.666371 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:32:52.667175 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.667936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:52.676797 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m21:32:52.679843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5572cc90>]}
[0m21:32:52.681255 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:52.682665 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.683743 [debug] [MainThread]: On master: BEGIN
[0m21:32:52.685218 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:32:52.685844 [debug] [MainThread]: On master: COMMIT
[0m21:32:52.686416 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.686957 [debug] [MainThread]: On master: COMMIT
[0m21:32:52.687614 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:52.688246 [debug] [MainThread]: On master: Close
[0m21:32:52.689118 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:32:52.690116 [info ] [MainThread]: 
[0m21:32:52.693305 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m21:32:52.694158 [info ] [Thread-1 (]: 1 of 1 START sql view model public.content_performance_mart .................... [RUN]
[0m21:32:52.695085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m21:32:52.695750 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m21:32:52.703989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m21:32:52.709380 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m21:32:52.740701 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m21:32:52.747638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:32:52.748379 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m21:32:52.749072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:52.752715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:32:52.753732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:32:52.754552 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    SELECT
    dp.post_sk,
    dp.post_id,
    dp.post_text,
    dp.post_timestamp,
    dp.tags,
    dp.location,
    COALESCE(SUM(fpi.like_count), 0) AS total_likes,  -- This ensures no NULLs in total_likes
    COALESCE(SUM(fpi.shares), 0) AS total_shares,
    COALESCE(COUNT(fpi.comment_text), 0) AS total_comments,
    COALESCE(SUM(fpi.angry), 0) AS total_angry,
    COALESCE(SUM(fpi.haha), 0) AS total_haha,
    COALESCE(SUM(fpi.love), 0) AS total_love,
    COALESCE(SUM(fpi.sad), 0) AS total_sad,
    COALESCE(SUM(fpi.wow), 0) AS total_wow,
    COALESCE(COUNT(DISTINCT fpi.user_sk), 0) AS total_users_interacted
FROM "warehouse"."public"."dim_posts" dp
LEFT JOIN "warehouse"."public"."fact_post_interactions" fpi
    ON dp.post_sk = fpi.post_sk
GROUP BY dp.post_sk, dp.post_id, dp.post_text, dp.post_timestamp, dp.tags, dp.location
  );
[0m21:32:52.766301 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m21:32:52.773357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:32:52.774425 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m21:32:52.776588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:32:52.780647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:32:52.781576 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m21:32:52.782832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:32:52.797893 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m21:32:52.799243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:32:52.800370 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m21:32:52.803805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:32:52.809722 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m21:32:52.814823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m21:32:52.815810 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.content_performance_mart"} */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m21:32:52.819878 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:32:52.822390 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m21:32:52.823925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e09a712c-b770-488e-994e-c8cc138b4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd53f33910>]}
[0m21:32:52.824964 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.13s]
[0m21:32:52.826120 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m21:32:52.828292 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.828937 [debug] [MainThread]: On master: BEGIN
[0m21:32:52.829552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:52.833304 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:32:52.834121 [debug] [MainThread]: On master: COMMIT
[0m21:32:52.834741 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.835313 [debug] [MainThread]: On master: COMMIT
[0m21:32:52.835998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:52.836584 [debug] [MainThread]: On master: Close
[0m21:32:52.837296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:52.837884 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m21:32:52.838489 [info ] [MainThread]: 
[0m21:32:52.839405 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m21:32:52.840703 [debug] [MainThread]: Command end result
[0m21:32:52.878937 [info ] [MainThread]: 
[0m21:32:52.880241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:52.881393 [info ] [MainThread]: 
[0m21:32:52.882635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:32:52.883893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9045249, "process_user_time": 1.625612, "process_kernel_time": 0.06096, "process_mem_max_rss": "107952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:32:52.884768 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:52.884659 after 0.91 seconds
[0m21:32:52.885472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56c9a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5a680510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd56d21ed0>]}
[0m21:32:52.886152 [debug] [MainThread]: Flushing usage events
[0m21:32:57.838598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb79a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cbc36350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb7d7fd0>]}


============================== 21:32:57.841147 | c45d34d4-a937-49f2-b0e6-7a6bb0f86114 ==============================
[0m21:32:57.841147 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:32:57.842401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:32:57.843380 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:32:57.844479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb78ded0>]}
[0m21:32:57.987345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37caf93290>]}
[0m21:32:58.033525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd542010>]}
[0m21:32:58.035058 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:32:58.045663 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:32:58.231079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:58.231804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:58.274634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca766390>]}
[0m21:32:58.390888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c9b7af90>]}
[0m21:32:58.392088 [info ] [MainThread]: Found 4 models, 5 data tests, 3 sources, 423 macros
[0m21:32:58.393110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cabb8d10>]}
[0m21:32:58.396528 [info ] [MainThread]: 
[0m21:32:58.398277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:58.403154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m21:32:58.433705 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:32:58.435170 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m21:32:58.436385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:58.440816 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:32:58.441896 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m21:32:58.442795 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:32:58.445642 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m21:32:58.447426 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m21:32:58.448241 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m21:32:58.453837 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:58.454591 [debug] [MainThread]: On master: BEGIN
[0m21:32:58.455231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:58.458368 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:32:58.459059 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:58.459906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:58.468357 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m21:32:58.471344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45d34d4-a937-49f2-b0e6-7a6bb0f86114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc604dd0>]}
[0m21:32:58.472579 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:58.473822 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:58.474695 [debug] [MainThread]: On master: BEGIN
[0m21:32:58.476030 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:32:58.476630 [debug] [MainThread]: On master: COMMIT
[0m21:32:58.477344 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:58.477878 [debug] [MainThread]: On master: COMMIT
[0m21:32:58.478694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:58.479256 [debug] [MainThread]: On master: Close
[0m21:32:58.480019 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:32:58.481017 [info ] [MainThread]: 
[0m21:32:58.484122 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:58.484503 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:58.485246 [info ] [Thread-1 (]: 1 of 5 START test not_null_content_performance_mart_post_sk .................... [RUN]
[0m21:32:58.486104 [info ] [Thread-2 (]: 2 of 5 START test not_null_content_performance_mart_total_likes ................ [RUN]
[0m21:32:58.487035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05)
[0m21:32:58.487889 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c'
[0m21:32:58.488864 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:58.489613 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:58.505155 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:58.509946 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:58.515384 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:58.516134 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:58.529529 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:58.532009 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:58.536933 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:58.537847 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:58.538207 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: BEGIN
[0m21:32:58.538961 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: BEGIN
[0m21:32:58.539629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:58.540279 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:58.543816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:32:58.544208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:32:58.544854 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"
[0m21:32:58.545605 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"
[0m21:32:58.546391 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_sk
from "warehouse"."public"."content_performance_mart"
where post_sk is null



      
    ) dbt_internal_test
[0m21:32:58.547084 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_likes
from "warehouse"."public"."content_performance_mart"
where total_likes is null



      
    ) dbt_internal_test
[0m21:32:58.549098 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:32:58.566260 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: ROLLBACK
[0m21:32:58.567392 [debug] [Thread-1 (]: On test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05: Close
[0m21:32:58.568808 [info ] [Thread-1 (]: 1 of 5 PASS not_null_content_performance_mart_post_sk .......................... [[32mPASS[0m in 0.08s]
[0m21:32:58.570136 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05
[0m21:32:58.571130 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:58.572135 [info ] [Thread-1 (]: 3 of 5 START test not_null_location_analysis_mart_location ..................... [RUN]
[0m21:32:58.573410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_content_performance_mart_post_sk.1118472f05, now test.dbt_project.not_null_location_analysis_mart_location.7230e57461)
[0m21:32:58.574468 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:58.582151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:58.590406 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:58.595189 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:58.602595 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:58.603407 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: BEGIN
[0m21:32:58.604415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:58.608838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:32:58.610024 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"
[0m21:32:58.611650 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_location_analysis_mart_location.7230e57461"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location
from "warehouse"."public"."location_analysis_mart"
where location is null



      
    ) dbt_internal_test
[0m21:32:58.632337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m21:32:58.634822 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: ROLLBACK
[0m21:32:58.636350 [debug] [Thread-1 (]: On test.dbt_project.not_null_location_analysis_mart_location.7230e57461: Close
[0m21:32:58.637602 [info ] [Thread-1 (]: 3 of 5 PASS not_null_location_analysis_mart_location ........................... [[32mPASS[0m in 0.06s]
[0m21:32:58.639561 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_location_analysis_mart_location.7230e57461
[0m21:32:58.641050 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m21:32:58.642145 [info ] [Thread-1 (]: 4 of 5 START test not_null_tag_analysis_mart_tags .............................. [RUN]
[0m21:32:58.643738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_location_analysis_mart_location.7230e57461, now test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288)
[0m21:32:58.644916 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m21:32:58.650101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m21:32:58.658017 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m21:32:58.661313 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m21:32:58.668017 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m21:32:58.668831 [debug] [Thread-1 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: BEGIN
[0m21:32:58.669526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:58.673198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:32:58.674188 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"
[0m21:32:58.675203 [debug] [Thread-1 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tags
from "warehouse"."public"."tag_analysis_mart"
where tags is null



      
    ) dbt_internal_test
[0m21:32:58.698175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m21:32:58.701023 [debug] [Thread-1 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: ROLLBACK
[0m21:32:58.702988 [debug] [Thread-1 (]: On test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288: Close
[0m21:32:58.704483 [info ] [Thread-1 (]: 4 of 5 PASS not_null_tag_analysis_mart_tags .................................... [[32mPASS[0m in 0.06s]
[0m21:32:58.705688 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288
[0m21:32:58.706731 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb
[0m21:32:58.707650 [info ] [Thread-1 (]: 5 of 5 START test not_null_user_engagement_mart_user_sk ........................ [RUN]
[0m21:32:58.708702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_tag_analysis_mart_tags.b18384c288, now test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb)
[0m21:32:58.709590 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb
[0m21:32:58.714445 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb"
[0m21:32:58.721092 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb
[0m21:32:58.725131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb"
[0m21:32:58.732930 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb"
[0m21:32:58.733934 [debug] [Thread-1 (]: On test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb: BEGIN
[0m21:32:58.735024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:58.739848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:32:58.741008 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb"
[0m21:32:58.741802 [debug] [Thread-1 (]: On test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_sk
from "warehouse"."public"."user_engagement_mart"
where user_sk is null



      
    ) dbt_internal_test
[0m21:32:59.326406 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.584 seconds
[0m21:32:59.328957 [debug] [Thread-1 (]: On test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb: ROLLBACK
[0m21:32:59.330126 [debug] [Thread-1 (]: On test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb: Close
[0m21:32:59.331373 [info ] [Thread-1 (]: 5 of 5 PASS not_null_user_engagement_mart_user_sk .............................. [[32mPASS[0m in 0.62s]
[0m21:32:59.332581 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb
[0m21:32:59.532134 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.984 seconds
[0m21:32:59.534285 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: ROLLBACK
[0m21:32:59.535446 [debug] [Thread-2 (]: On test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c: Close
[0m21:32:59.536494 [info ] [Thread-2 (]: 2 of 5 PASS not_null_content_performance_mart_total_likes ...................... [[32mPASS[0m in 1.05s]
[0m21:32:59.537986 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c
[0m21:32:59.540542 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:59.541420 [debug] [MainThread]: On master: BEGIN
[0m21:32:59.542308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:59.545968 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:32:59.546805 [debug] [MainThread]: On master: COMMIT
[0m21:32:59.547461 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:59.548125 [debug] [MainThread]: On master: COMMIT
[0m21:32:59.548947 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:59.549593 [debug] [MainThread]: On master: Close
[0m21:32:59.550386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:59.551039 [debug] [MainThread]: Connection 'test.dbt_project.not_null_user_engagement_mart_user_sk.f77b9c83eb' was properly closed.
[0m21:32:59.551714 [debug] [MainThread]: Connection 'test.dbt_project.not_null_content_performance_mart_total_likes.156d0a023c' was properly closed.
[0m21:32:59.552438 [info ] [MainThread]: 
[0m21:32:59.553423 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m21:32:59.555150 [debug] [MainThread]: Command end result
[0m21:32:59.596969 [info ] [MainThread]: 
[0m21:32:59.599286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:59.600367 [info ] [MainThread]: 
[0m21:32:59.601298 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:32:59.602582 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8152242, "process_user_time": 1.628138, "process_kernel_time": 0.079421, "process_mem_max_rss": "111116", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:32:59.603478 [debug] [MainThread]: Command `dbt test` succeeded at 21:32:59.603368 after 1.82 seconds
[0m21:32:59.604200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb7d96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cf11cb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cf29c4d0>]}
[0m21:32:59.604920 [debug] [MainThread]: Flushing usage events
[0m03:51:54.559184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8a453090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8aad5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8a451e90>]}


============================== 03:51:54.561925 | 89034772-2e98-406a-b4f2-f46390f2a160 ==============================
[0m03:51:54.561925 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:51:54.562931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models marts --project-dir /app/dbt_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:51:54.563777 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m03:51:54.564741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89034772-2e98-406a-b4f2-f46390f2a160', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8a452d90>]}
[0m03:51:54.570104 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m03:51:54.571446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07094623, "process_user_time": 0.990646, "process_kernel_time": 0.070045, "process_mem_max_rss": "88412", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:51:54.572304 [debug] [MainThread]: Command `dbt run` failed at 03:51:54.572187 after 0.07 seconds
[0m03:51:54.573047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8a45de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8df40f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8a49b890>]}
[0m03:51:54.573803 [debug] [MainThread]: Flushing usage events
[0m16:18:51.149018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bb4b8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bb9aead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bb56a010>]}


============================== 16:18:51.158195 | 22c872a7-2ccc-4590-b38b-deada36bd74a ==============================
[0m16:18:51.158195 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:18:51.159844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:51.450179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba944a90>]}
[0m16:18:51.521544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bbb11ed0>]}
[0m16:18:51.525905 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:18:51.543057 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:18:51.685225 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:18:51.686860 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:18:51.688184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bc9bfe50>]}
[0m16:18:53.232267 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:18:53.233697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba5cb6d0>]}
[0m16:18:53.250005 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_users' in the 'models' section of file 'models/marts/schema.yml'
[0m16:18:53.255250 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_posts' in the 'models' section of file 'models/marts/schema.yml'
[0m16:18:53.264490 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_post_interactions' in the 'models' section of file 'models/marts/schema.yml'
[0m16:18:53.537609 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_user_sk.f0e7c6f32b' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:18:53.539466 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_users_user_sk.d698f5c511' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:18:53.541087 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_user_id.e754bb5812' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:18:53.542343 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_users_user_id.bcdc17b9f9' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:18:53.543562 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_username.5b75869fce' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:18:53.544815 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_posts_post_sk.803944b4d7' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:18:53.545884 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_posts_post_sk.057cbb334b' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:18:53.546916 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_posts_post_id.58e6ef274f' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:18:53.548068 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_posts_post_id.a230feec04' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:18:53.549333 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_fact_post_interactions_post_sk.17151d5a27' (models/marts/schema.yml) depends on a node named 'fact_post_interactions' in package '' which was not found
[0m16:18:53.550403 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_fact_post_interactions_user_sk.30ad83908b' (models/marts/schema.yml) depends on a node named 'fact_post_interactions' in package '' which was not found
[0m16:18:53.764299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:18:53.781395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b9975490>]}
[0m16:18:54.041544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba9eaed0>]}
[0m16:18:54.044106 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:18:54.046044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba1b5310>]}
[0m16:18:54.052980 [info ] [MainThread]: 
[0m16:18:54.056406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:18:54.068229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:18:54.176547 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:18:54.178213 [debug] [ThreadPool]: On list_warehouse: /* 1.8.6 running in dev mode */

    select distinct nspname from pg_namespace
  
[0m16:18:54.179468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:54.209020 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m16:18:54.212339 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:18:54.215585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m16:18:54.224550 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:18:54.226005 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:18:54.227332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:54.233204 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:18:54.234573 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:18:54.235780 [debug] [ThreadPool]: On list_warehouse_public: /* 1.8.6 running in dev mode */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:18:54.252948 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m16:18:54.255813 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:18:54.257420 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:18:54.266031 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.267536 [debug] [MainThread]: On master: BEGIN
[0m16:18:54.268805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:54.274079 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:18:54.275478 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.277101 [debug] [MainThread]: On master: /* 1.8.6 running in dev mode */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:18:54.299748 [debug] [MainThread]: SQL status: SELECT 8 in 0.021 seconds
[0m16:18:54.304289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179aeb63d0>]}
[0m16:18:54.305819 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:54.307471 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.308678 [debug] [MainThread]: On master: BEGIN
[0m16:18:54.310146 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:18:54.311451 [debug] [MainThread]: On master: COMMIT
[0m16:18:54.312611 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.313708 [debug] [MainThread]: On master: COMMIT
[0m16:18:54.315096 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:18:54.316242 [debug] [MainThread]: On master: Close
[0m16:18:54.317448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:54.318705 [info ] [MainThread]: 
[0m16:18:54.334387 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m16:18:54.335245 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m16:18:54.335889 [debug] [Thread-3 (]: Began running node model.dbt_project.tag_analysis_mart
[0m16:18:54.336632 [debug] [Thread-4 (]: Began running node model.dbt_project.user_engagement_mart
[0m16:18:54.337646 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m16:18:54.339546 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m16:18:54.341730 [info ] [Thread-3 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m16:18:54.343581 [info ] [Thread-4 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m16:18:54.345167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m16:18:54.346671 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m16:18:54.348243 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.tag_analysis_mart'
[0m16:18:54.349560 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.user_engagement_mart'
[0m16:18:54.350872 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m16:18:54.352049 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m16:18:54.353161 [debug] [Thread-3 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m16:18:54.354235 [debug] [Thread-4 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m16:18:54.366593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m16:18:54.371081 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m16:18:54.377045 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m16:18:54.381969 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m16:18:54.389256 [debug] [Thread-3 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m16:18:54.390103 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m16:18:54.396411 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m16:18:54.396947 [debug] [Thread-4 (]: Began executing node model.dbt_project.user_engagement_mart
[0m16:18:54.458962 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m16:18:54.460574 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m16:18:54.466624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m16:18:54.472079 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m16:18:54.479992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:18:54.480829 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:18:54.482000 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m16:18:54.482777 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:18:54.483490 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:18:54.484332 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m16:18:54.485886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:54.487452 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m16:18:54.488922 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m16:18:54.490510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:18:54.493345 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:54.494731 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:18:54.497755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:18:54.500120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:18:54.501724 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    select
    dp.post_sk,
    dp.post_id,
    dp.post_text,
    dp.post_timestamp,
    dp.tags,
    dp.location,
    COALESCE(SUM(fpi.like_count), 0) AS total_likes,  -- This ensures no NULLs in total_likes
    COALESCE(SUM(fpi.shares), 0) AS total_shares,
    COALESCE(COUNT(fpi.comment_text), 0) AS total_comments,
    COALESCE(SUM(fpi.angry), 0) AS total_angry,
    COALESCE(SUM(fpi.haha), 0) AS total_haha,
    COALESCE(SUM(fpi.love), 0) AS total_love,
    COALESCE(SUM(fpi.sad), 0) AS total_sad,
    COALESCE(SUM(fpi.wow), 0) AS total_wow,
    COALESCE(COUNT(DISTINCT fpi.user_sk), 0) AS total_users_interacted
FROM "warehouse"."public"."dim_posts" dp
LEFT JOIN "warehouse"."public"."fact_post_interactions" fpi
    ON dp.post_sk = fpi.post_sk
GROUP BY dp.post_sk, dp.post_id, dp.post_text, dp.post_timestamp, dp.tags, dp.location
  );
[0m16:18:54.502444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:18:54.503025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:18:54.504197 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:18:54.505854 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:18:54.507389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:18:54.508875 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:18:54.510597 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        COALESCE(dp.tags, '') AS tags,
        COALESCE(SUM(fpi.like_count), 0) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m16:18:54.512721 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m16:18:54.514514 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m16:18:54.529744 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m16:18:54.530374 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:18:54.530913 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m16:18:54.531458 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m16:18:54.543315 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:18:54.548429 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:18:54.554718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:18:54.560402 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:18:54.562071 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart" rename to "location_analysis_mart__dbt_backup"
[0m16:18:54.563819 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart" rename to "user_engagement_mart__dbt_backup"
[0m16:18:54.565380 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m16:18:54.566971 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m16:18:54.569584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.570242 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.571777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.573880 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.577976 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:18:54.583145 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:18:54.588398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:18:54.593678 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:18:54.595512 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m16:18:54.597017 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m16:18:54.598621 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m16:18:54.599925 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m16:18:54.601991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.603748 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.605025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.606341 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:54.635163 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:18:54.636004 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:18:54.638257 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:18:54.641393 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:18:54.642913 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:18:54.644509 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:18:54.645933 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:18:54.647595 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:18:54.648808 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:18:54.650100 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:18:54.651695 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:18:54.653250 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:18:54.656426 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:18:54.657431 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:18:54.658403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:18:54.659806 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:18:54.668206 [debug] [Thread-4 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m16:18:54.672134 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m16:18:54.676477 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m16:18:54.680735 [debug] [Thread-3 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m16:18:54.689048 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:18:54.690513 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:18:54.692390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:18:54.694377 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:18:54.696066 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m16:18:54.697258 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m16:18:54.698650 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m16:18:54.700169 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m16:18:54.708865 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:18:54.709962 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:18:54.710562 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:18:54.711143 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:18:54.714027 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: Close
[0m16:18:54.716969 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: Close
[0m16:18:54.719919 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m16:18:54.722515 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m16:18:54.725558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ae8cc50>]}
[0m16:18:54.727087 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ad0c250>]}
[0m16:18:54.728765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179aedae10>]}
[0m16:18:54.730399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c872a7-2ccc-4590-b38b-deada36bd74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba171950>]}
[0m16:18:54.731935 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.37s]
[0m16:18:54.733741 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.38s]
[0m16:18:54.735534 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.38s]
[0m16:18:54.737366 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.39s]
[0m16:18:54.739302 [debug] [Thread-4 (]: Finished running node model.dbt_project.user_engagement_mart
[0m16:18:54.741221 [debug] [Thread-3 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m16:18:54.743022 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m16:18:54.745090 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m16:18:54.752287 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.753703 [debug] [MainThread]: On master: BEGIN
[0m16:18:54.755005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:54.760573 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:18:54.762097 [debug] [MainThread]: On master: COMMIT
[0m16:18:54.763480 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.764728 [debug] [MainThread]: On master: COMMIT
[0m16:18:54.766545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:18:54.768030 [debug] [MainThread]: On master: Close
[0m16:18:54.769810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:54.771142 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m16:18:54.772526 [debug] [MainThread]: Connection 'model.dbt_project.location_analysis_mart' was properly closed.
[0m16:18:54.773783 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m16:18:54.775063 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m16:18:54.776451 [info ] [MainThread]: 
[0m16:18:54.778016 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m16:18:54.780856 [debug] [MainThread]: Command end result
[0m16:18:54.858357 [info ] [MainThread]: 
[0m16:18:54.860282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:54.862146 [info ] [MainThread]: 
[0m16:18:54.863601 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:18:54.867325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8033612, "process_user_time": 4.515145, "process_kernel_time": 0.344203, "process_mem_max_rss": "119640", "process_in_blocks": "103048", "process_out_blocks": "1160"}
[0m16:18:54.869679 [debug] [MainThread]: Command `dbt run` succeeded at 16:18:54.869421 after 3.81 seconds
[0m16:18:54.871367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bb4fced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bb4fd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bee008d0>]}
[0m16:18:54.872844 [debug] [MainThread]: Flushing usage events
[0m16:19:02.063424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ace3c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ace7bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ace33b90>]}


============================== 16:19:02.067608 | b87f584a-b28c-4d36-9cdd-d6165618957e ==============================
[0m16:19:02.067608 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:19:02.069316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:19:02.287647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b87f584a-b28c-4d36-9cdd-d6165618957e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ac995ed0>]}
[0m16:19:02.354579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b87f584a-b28c-4d36-9cdd-d6165618957e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aeba5ad0>]}
[0m16:19:02.356540 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:19:02.369665 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:19:02.610229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:02.611731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:02.619375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:19:02.676780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b87f584a-b28c-4d36-9cdd-d6165618957e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ac1c4510>]}
[0m16:19:02.861675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b87f584a-b28c-4d36-9cdd-d6165618957e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ab5cad90>]}
[0m16:19:02.863457 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:19:02.864937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b87f584a-b28c-4d36-9cdd-d6165618957e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ac583790>]}
[0m16:19:02.868305 [info ] [MainThread]: 
[0m16:19:02.869956 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:19:02.872853 [debug] [MainThread]: Command end result
[0m16:19:02.943096 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9647545, "process_user_time": 2.099, "process_kernel_time": 0.201827, "process_mem_max_rss": "101840", "process_in_blocks": "2064", "process_out_blocks": "0"}
[0m16:19:02.944643 [debug] [MainThread]: Command `dbt test` succeeded at 16:19:02.944472 after 0.97 seconds
[0m16:19:02.945910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ad1cd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b077cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b08fd210>]}
[0m16:19:02.946987 [debug] [MainThread]: Flushing usage events
[0m16:20:36.220962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34f3b9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34f791250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34f3b9b90>]}


============================== 16:20:36.228791 | 6adcd872-e639-4240-a572-cdb07bcfaddf ==============================
[0m16:20:36.228791 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:20:36.230301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:36.493162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34f2e2850>]}
[0m16:20:36.577092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff351112c50>]}
[0m16:20:36.579122 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:20:36.595397 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:20:36.872630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:36.874163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:36.881517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:20:36.930352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34e349690>]}
[0m16:20:37.111907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34e779150>]}
[0m16:20:37.113191 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:20:37.114655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34e7650d0>]}
[0m16:20:37.118099 [info ] [MainThread]: 
[0m16:20:37.119619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:37.126129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:20:37.177870 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:20:37.179051 [debug] [ThreadPool]: On list_warehouse: /* 1.8.6 running in dev mode */

    select distinct nspname from pg_namespace
  
[0m16:20:37.180228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:37.188490 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m16:20:37.190971 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:20:37.193814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m16:20:37.201899 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:20:37.203230 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:20:37.204348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:37.208968 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:20:37.210148 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:20:37.211160 [debug] [ThreadPool]: On list_warehouse_public: /* 1.8.6 running in dev mode */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:20:37.214939 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m16:20:37.217936 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:20:37.219273 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:20:37.227580 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.229046 [debug] [MainThread]: On master: BEGIN
[0m16:20:37.230308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:37.235225 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:20:37.236649 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.237822 [debug] [MainThread]: On master: /* 1.8.6 running in dev mode */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:37.251011 [debug] [MainThread]: SQL status: SELECT 8 in 0.012 seconds
[0m16:20:37.255358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34c7b8b90>]}
[0m16:20:37.256755 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:37.258127 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.259326 [debug] [MainThread]: On master: BEGIN
[0m16:20:37.261075 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:37.262110 [debug] [MainThread]: On master: COMMIT
[0m16:20:37.263551 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.264557 [debug] [MainThread]: On master: COMMIT
[0m16:20:37.265565 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:37.266393 [debug] [MainThread]: On master: Close
[0m16:20:37.267397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:37.268569 [info ] [MainThread]: 
[0m16:20:37.280350 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m16:20:37.280973 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m16:20:37.281497 [debug] [Thread-3 (]: Began running node model.dbt_project.tag_analysis_mart
[0m16:20:37.282026 [debug] [Thread-4 (]: Began running node model.dbt_project.user_engagement_mart
[0m16:20:37.282979 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m16:20:37.284690 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m16:20:37.285976 [info ] [Thread-3 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m16:20:37.287370 [info ] [Thread-4 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m16:20:37.288716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m16:20:37.290151 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m16:20:37.291508 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.tag_analysis_mart'
[0m16:20:37.292610 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.user_engagement_mart'
[0m16:20:37.293636 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m16:20:37.294631 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m16:20:37.295454 [debug] [Thread-3 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m16:20:37.296357 [debug] [Thread-4 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m16:20:37.307395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m16:20:37.312074 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m16:20:37.317074 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m16:20:37.322212 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m16:20:37.329860 [debug] [Thread-3 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m16:20:37.332014 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m16:20:37.338414 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m16:20:37.339007 [debug] [Thread-4 (]: Began executing node model.dbt_project.user_engagement_mart
[0m16:20:37.408470 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m16:20:37.410679 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m16:20:37.416251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m16:20:37.421837 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m16:20:37.429903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:20:37.431232 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:20:37.431948 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m16:20:37.432651 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:20:37.433715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:20:37.434206 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m16:20:37.435748 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:20:37.437344 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m16:20:37.438881 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m16:20:37.440382 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:20:37.443141 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:37.444861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:37.445964 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m16:20:37.450221 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:20:37.451612 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m16:20:37.452521 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        COALESCE(dp.tags, '') AS tags,
        COALESCE(SUM(fpi.like_count), 0) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m16:20:37.453506 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:20:37.454232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:20:37.455137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:20:37.457558 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:20:37.459075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:20:37.460230 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:20:37.461194 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m16:20:37.462735 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m16:20:37.464352 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    select
    dp.post_sk,
    dp.post_id,
    dp.post_text,
    dp.post_timestamp,
    dp.tags,
    dp.location,
    COALESCE(SUM(fpi.like_count), 0) AS total_likes,  -- This ensures no NULLs in total_likes
    COALESCE(SUM(fpi.shares), 0) AS total_shares,
    COALESCE(COUNT(fpi.comment_text), 0) AS total_comments,
    COALESCE(SUM(fpi.angry), 0) AS total_angry,
    COALESCE(SUM(fpi.haha), 0) AS total_haha,
    COALESCE(SUM(fpi.love), 0) AS total_love,
    COALESCE(SUM(fpi.sad), 0) AS total_sad,
    COALESCE(SUM(fpi.wow), 0) AS total_wow,
    COALESCE(COUNT(DISTINCT fpi.user_sk), 0) AS total_users_interacted
FROM "warehouse"."public"."dim_posts" dp
LEFT JOIN "warehouse"."public"."fact_post_interactions" fpi
    ON dp.post_sk = fpi.post_sk
GROUP BY dp.post_sk, dp.post_id, dp.post_text, dp.post_timestamp, dp.tags, dp.location
  );
[0m16:20:37.474246 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:20:37.478556 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:20:37.479134 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m16:20:37.480585 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:20:37.481088 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:20:37.485715 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:20:37.488232 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.493409 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:20:37.499173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:20:37.500941 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart" rename to "location_analysis_mart__dbt_backup"
[0m16:20:37.507125 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:20:37.508453 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart" rename to "user_engagement_mart__dbt_backup"
[0m16:20:37.510027 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m16:20:37.512022 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.512949 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m16:20:37.514836 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.516165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:37.521735 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:20:37.524251 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.528243 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:20:37.533331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:20:37.535030 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m16:20:37.558901 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m16:20:37.559769 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:20:37.561053 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m16:20:37.563321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.564897 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.565829 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:20:37.567910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:37.570466 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:20:37.573568 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:20:37.575396 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:20:37.578422 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:20:37.580134 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:20:37.581743 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:20:37.584516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:20:37.586074 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:20:37.587377 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:20:37.587887 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:20:37.589522 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:20:37.597646 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m16:20:37.600439 [debug] [Thread-3 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m16:20:37.603668 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:20:37.607311 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m16:20:37.607813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:20:37.615766 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:20:37.619624 [debug] [Thread-4 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m16:20:37.621701 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:20:37.625804 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m16:20:37.627371 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m16:20:37.629226 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:20:37.630839 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m16:20:37.632694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:20:37.635165 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m16:20:37.636627 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:20:37.638237 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m16:20:37.639283 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:20:37.643647 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: Close
[0m16:20:37.644238 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:20:37.647942 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m16:20:37.648516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:20:37.651329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34db7b910>]}
[0m16:20:37.653958 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: Close
[0m16:20:37.655727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34c6c5450>]}
[0m16:20:37.658275 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m16:20:37.660211 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.36s]
[0m16:20:37.662181 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34c7b1dd0>]}
[0m16:20:37.663842 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.37s]
[0m16:20:37.665509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adcd872-e639-4240-a572-cdb07bcfaddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34c78c390>]}
[0m16:20:37.667293 [debug] [Thread-3 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m16:20:37.668861 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.37s]
[0m16:20:37.670374 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m16:20:37.671740 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.38s]
[0m16:20:37.674336 [debug] [Thread-4 (]: Finished running node model.dbt_project.user_engagement_mart
[0m16:20:37.676247 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m16:20:37.679841 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.681006 [debug] [MainThread]: On master: BEGIN
[0m16:20:37.682160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:37.686728 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:20:37.688014 [debug] [MainThread]: On master: COMMIT
[0m16:20:37.689025 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.690006 [debug] [MainThread]: On master: COMMIT
[0m16:20:37.691270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:37.692198 [debug] [MainThread]: On master: Close
[0m16:20:37.693225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:37.694428 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m16:20:37.695431 [debug] [MainThread]: Connection 'model.dbt_project.location_analysis_mart' was properly closed.
[0m16:20:37.696373 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m16:20:37.697473 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m16:20:37.698612 [info ] [MainThread]: 
[0m16:20:37.699820 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m16:20:37.702143 [debug] [MainThread]: Command end result
[0m16:20:37.780152 [info ] [MainThread]: 
[0m16:20:37.781331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:37.782542 [info ] [MainThread]: 
[0m16:20:37.783873 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:20:37.785755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6654687, "process_user_time": 2.807526, "process_kernel_time": 0.177941, "process_mem_max_rss": "112284", "process_out_blocks": "1160", "process_in_blocks": "0"}
[0m16:20:37.787258 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:37.787103 after 1.67 seconds
[0m16:20:37.788391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff352cd8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34f791850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34f3bb2d0>]}
[0m16:20:37.789545 [debug] [MainThread]: Flushing usage events
[0m16:20:49.637634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5596fc3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5597359550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5596fcce10>]}


============================== 16:20:49.641273 | 9723d85e-74f0-41b3-812f-3db82385eb1f ==============================
[0m16:20:49.641273 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:20:49.642638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:49.835336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9723d85e-74f0-41b3-812f-3db82385eb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f559700a0d0>]}
[0m16:20:49.911213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9723d85e-74f0-41b3-812f-3db82385eb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5598d31b10>]}
[0m16:20:49.913500 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:20:49.926671 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:20:50.190591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:50.192126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:50.199554 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:20:50.247208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9723d85e-74f0-41b3-812f-3db82385eb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5595fbb550>]}
[0m16:20:50.416506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9723d85e-74f0-41b3-812f-3db82385eb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55953c6d10>]}
[0m16:20:50.418155 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:20:50.419357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9723d85e-74f0-41b3-812f-3db82385eb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f559637f790>]}
[0m16:20:50.423529 [info ] [MainThread]: 
[0m16:20:50.425063 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:20:50.428226 [debug] [MainThread]: Command end result
[0m16:20:50.495555 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9433601, "process_user_time": 2.107333, "process_kernel_time": 0.171409, "process_mem_max_rss": "101780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:20:50.497249 [debug] [MainThread]: Command `dbt test` succeeded at 16:20:50.497086 after 0.95 seconds
[0m16:20:50.498638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f559a908ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f559aa883d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f559aa88cd0>]}
[0m16:20:50.500042 [debug] [MainThread]: Flushing usage events
[0m16:23:42.620192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4ca4c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4ca3fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4ca4e5d0>]}


============================== 16:23:42.624458 | 57931c1a-d3e6-4822-9f60-c208c535d6f2 ==============================
[0m16:23:42.624458 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:23:42.626646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:42.756155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57931c1a-d3e6-4822-9f60-c208c535d6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4ca90a10>]}
[0m16:23:42.786073 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m16:23:42.787419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57931c1a-d3e6-4822-9f60-c208c535d6f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4c951990>]}
[0m16:23:42.853634 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.33669376, "process_user_time": 1.736788, "process_kernel_time": 0.059208, "process_mem_max_rss": "90528", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m16:23:42.855384 [debug] [MainThread]: Command `dbt clean` succeeded at 16:23:42.855120 after 0.34 seconds
[0m16:23:42.857041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4ca4c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4ca4df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb503d0950>]}
[0m16:23:42.858251 [debug] [MainThread]: Flushing usage events
[0m16:23:51.747703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7594c90310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75953b1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7595029150>]}


============================== 16:23:51.751316 | 00880a8d-5231-452c-ad24-caa8c288871b ==============================
[0m16:23:51.751316 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:23:51.752774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:23:51.965543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75941bb510>]}
[0m16:23:52.034893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7596a263d0>]}
[0m16:23:52.036926 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:23:52.050256 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:23:52.055848 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:23:52.057206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7594c87110>]}
[0m16:23:53.378271 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:23:53.380054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7593942c90>]}
[0m16:23:53.395126 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_users' in the 'models' section of file 'models/marts/schema.yml'
[0m16:23:53.400143 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_posts' in the 'models' section of file 'models/marts/schema.yml'
[0m16:23:53.407105 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_post_interactions' in the 'models' section of file 'models/marts/schema.yml'
[0m16:23:53.663408 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_user_sk.f0e7c6f32b' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:23:53.665287 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_users_user_sk.d698f5c511' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:23:53.666646 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_user_id.e754bb5812' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:23:53.667977 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_users_user_id.bcdc17b9f9' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:23:53.669260 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_username.5b75869fce' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:23:53.670542 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_posts_post_sk.803944b4d7' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:23:53.671774 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_posts_post_sk.057cbb334b' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:23:53.672836 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_posts_post_id.58e6ef274f' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:23:53.673872 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_posts_post_id.a230feec04' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:23:53.674857 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_fact_post_interactions_post_sk.17151d5a27' (models/marts/schema.yml) depends on a node named 'fact_post_interactions' in package '' which was not found
[0m16:23:53.675868 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_fact_post_interactions_user_sk.30ad83908b' (models/marts/schema.yml) depends on a node named 'fact_post_interactions' in package '' which was not found
[0m16:23:53.792728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:23:53.805330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7596410790>]}
[0m16:23:54.013881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f759355d310>]}
[0m16:23:54.015584 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:23:54.017025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7592d14ad0>]}
[0m16:23:54.020320 [info ] [MainThread]: 
[0m16:23:54.021806 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:54.028595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:23:54.072762 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:23:54.074488 [debug] [ThreadPool]: On list_warehouse: /* 1.8.6 running in dev mode */

    select distinct nspname from pg_namespace
  
[0m16:23:54.075943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:54.082365 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:23:54.084996 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:23:54.088126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m16:23:54.096696 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:23:54.098331 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:23:54.099732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:54.105123 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:23:54.106791 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:23:54.108261 [debug] [ThreadPool]: On list_warehouse_public: /* 1.8.6 running in dev mode */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:23:54.112463 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m16:23:54.115402 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:23:54.117210 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:23:54.125683 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.127310 [debug] [MainThread]: On master: BEGIN
[0m16:23:54.128845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:54.134058 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:23:54.135652 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.137288 [debug] [MainThread]: On master: /* 1.8.6 running in dev mode */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:54.149984 [debug] [MainThread]: SQL status: SELECT 8 in 0.011 seconds
[0m16:23:54.154430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7592d2d110>]}
[0m16:23:54.156043 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:54.157675 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.159048 [debug] [MainThread]: On master: BEGIN
[0m16:23:54.160931 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:23:54.162290 [debug] [MainThread]: On master: COMMIT
[0m16:23:54.163632 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.164845 [debug] [MainThread]: On master: COMMIT
[0m16:23:54.166323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:54.167559 [debug] [MainThread]: On master: Close
[0m16:23:54.168965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:23:54.170357 [info ] [MainThread]: 
[0m16:23:54.175713 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m16:23:54.176265 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m16:23:54.176820 [debug] [Thread-3 (]: Began running node model.dbt_project.tag_analysis_mart
[0m16:23:54.177391 [debug] [Thread-4 (]: Began running node model.dbt_project.user_engagement_mart
[0m16:23:54.178326 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m16:23:54.179685 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m16:23:54.180988 [info ] [Thread-3 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m16:23:54.182917 [info ] [Thread-4 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m16:23:54.184445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m16:23:54.186039 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m16:23:54.187327 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.tag_analysis_mart'
[0m16:23:54.188647 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.user_engagement_mart'
[0m16:23:54.189752 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m16:23:54.191160 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m16:23:54.192469 [debug] [Thread-3 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m16:23:54.193500 [debug] [Thread-4 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m16:23:54.205835 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m16:23:54.210503 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m16:23:54.216643 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m16:23:54.221660 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m16:23:54.235989 [debug] [Thread-3 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m16:23:54.251580 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m16:23:54.263241 [debug] [Thread-4 (]: Began executing node model.dbt_project.user_engagement_mart
[0m16:23:54.275157 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m16:23:54.290464 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m16:23:54.291683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m16:23:54.296601 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m16:23:54.302103 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m16:23:54.316874 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:23:54.318229 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m16:23:54.319328 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:23:54.320257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:23:54.322137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:23:54.323139 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m16:23:54.323625 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:23:54.324635 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m16:23:54.325120 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m16:23:54.325897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:54.326738 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m16:23:54.327599 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:23:54.328480 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:23:54.330271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:23:54.332008 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        COALESCE(dp.tags, '') AS tags,
        COALESCE(SUM(fpi.like_count), 0) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m16:23:54.332914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:23:54.334396 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:23:54.335327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:23:54.336562 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:23:54.337205 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m16:23:54.337723 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:23:54.338545 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    select
    dp.post_sk,
    dp.post_id,
    dp.post_text,
    dp.post_timestamp,
    dp.tags,
    dp.location,
    COALESCE(SUM(fpi.like_count), 0) AS total_likes,  -- This ensures no NULLs in total_likes
    COALESCE(SUM(fpi.shares), 0) AS total_shares,
    COALESCE(COUNT(fpi.comment_text), 0) AS total_comments,
    COALESCE(SUM(fpi.angry), 0) AS total_angry,
    COALESCE(SUM(fpi.haha), 0) AS total_haha,
    COALESCE(SUM(fpi.love), 0) AS total_love,
    COALESCE(SUM(fpi.sad), 0) AS total_sad,
    COALESCE(SUM(fpi.wow), 0) AS total_wow,
    COALESCE(COUNT(DISTINCT fpi.user_sk), 0) AS total_users_interacted
FROM "warehouse"."public"."dim_posts" dp
LEFT JOIN "warehouse"."public"."fact_post_interactions" fpi
    ON dp.post_sk = fpi.post_sk
GROUP BY dp.post_sk, dp.post_id, dp.post_text, dp.post_timestamp, dp.tags, dp.location
  );
[0m16:23:54.339519 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m16:23:54.340443 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:23:54.348960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:23:54.352435 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m16:23:54.354087 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m16:23:54.354648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:23:54.355102 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:23:54.357900 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:54.362521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:23:54.363040 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:23:54.367969 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:23:54.372487 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:23:54.374074 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m16:23:54.378858 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:23:54.380453 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart" rename to "location_analysis_mart__dbt_backup"
[0m16:23:54.381897 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m16:23:54.384074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:54.384930 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart" rename to "user_engagement_mart__dbt_backup"
[0m16:23:54.386815 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:54.387634 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:23:54.391570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:23:54.393304 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:23:54.396882 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:23:54.418946 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:23:54.419500 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m16:23:54.425722 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:23:54.427374 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m16:23:54.428916 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:23:54.431406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:54.431883 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m16:23:54.434121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:54.435186 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:23:54.438309 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:23:54.440250 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:54.442563 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:23:54.444609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:23:54.445475 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:54.448014 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:23:54.449324 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:23:54.450397 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:23:54.459370 [debug] [Thread-3 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m16:23:54.460550 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:23:54.462009 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:23:54.470899 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:23:54.471541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:23:54.472850 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:23:54.475719 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m16:23:54.476331 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:54.480288 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m16:23:54.483490 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:54.487107 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m16:23:54.487666 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:23:54.489409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:23:54.494309 [debug] [Thread-4 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m16:23:54.496490 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:23:54.500052 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: Close
[0m16:23:54.501286 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m16:23:54.503008 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:23:54.504244 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m16:23:54.506553 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75935bbfd0>]}
[0m16:23:54.508457 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m16:23:54.509780 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:54.511736 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:54.511242 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.32s]
[0m16:23:54.514767 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m16:23:54.515243 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:54.517342 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m16:23:54.518689 [debug] [Thread-3 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m16:23:54.519853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7590785550>]}
[0m16:23:54.522068 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: Close
[0m16:23:54.523226 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f759079fc50>]}
[0m16:23:54.525423 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.34s]
[0m16:23:54.526806 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00880a8d-5231-452c-ad24-caa8c288871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7590755790>]}
[0m16:23:54.527983 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.34s]
[0m16:23:54.529417 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m16:23:54.530782 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.34s]
[0m16:23:54.532481 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m16:23:54.534471 [debug] [Thread-4 (]: Finished running node model.dbt_project.user_engagement_mart
[0m16:23:54.537885 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.539047 [debug] [MainThread]: On master: BEGIN
[0m16:23:54.539912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:54.543951 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:23:54.544922 [debug] [MainThread]: On master: COMMIT
[0m16:23:54.545786 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.546623 [debug] [MainThread]: On master: COMMIT
[0m16:23:54.547574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:54.548420 [debug] [MainThread]: On master: Close
[0m16:23:54.549344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:54.550147 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m16:23:54.551066 [debug] [MainThread]: Connection 'model.dbt_project.location_analysis_mart' was properly closed.
[0m16:23:54.552020 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m16:23:54.552842 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m16:23:54.553730 [info ] [MainThread]: 
[0m16:23:54.554696 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:23:54.556691 [debug] [MainThread]: Command end result
[0m16:23:54.625213 [info ] [MainThread]: 
[0m16:23:54.626715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:54.628067 [info ] [MainThread]: 
[0m16:23:54.629424 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:23:54.631394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9648964, "process_user_time": 3.945775, "process_kernel_time": 0.132888, "process_mem_max_rss": "116644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:23:54.632691 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:54.632535 after 2.97 seconds
[0m16:23:54.633660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7594cce190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7594cd33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75985f48d0>]}
[0m16:23:54.634664 [debug] [MainThread]: Flushing usage events
[0m16:24:00.487308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b78f808d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7941e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b78fc3910>]}


============================== 16:24:00.491382 | 9c2eef9c-4016-466a-8a16-b72ba2f65521 ==============================
[0m16:24:00.491382 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:24:00.493002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:00.691694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c2eef9c-4016-466a-8a16-b72ba2f65521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b78f77ad0>]}
[0m16:24:00.759523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c2eef9c-4016-466a-8a16-b72ba2f65521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ad29e10>]}
[0m16:24:00.761891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:24:00.779630 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:24:01.059632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:01.060952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:01.069497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:24:01.124734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2eef9c-4016-466a-8a16-b72ba2f65521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77f2b410>]}
[0m16:24:01.294692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2eef9c-4016-466a-8a16-b72ba2f65521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77386e10>]}
[0m16:24:01.296460 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:24:01.298034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2eef9c-4016-466a-8a16-b72ba2f65521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b78fbe510>]}
[0m16:24:01.301370 [info ] [MainThread]: 
[0m16:24:01.302752 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:24:01.306020 [debug] [MainThread]: Command end result
[0m16:24:01.367642 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9643214, "process_user_time": 2.068043, "process_kernel_time": 0.060824, "process_mem_max_rss": "101864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:24:01.369212 [debug] [MainThread]: Command `dbt test` succeeded at 16:24:01.369058 after 0.97 seconds
[0m16:24:01.370538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7c904950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ca84350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ca84c50>]}
[0m16:24:01.371803 [debug] [MainThread]: Flushing usage events
[0m16:26:30.422633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd1d1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd103790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd103c10>]}


============================== 16:26:30.426673 | 730cb319-0099-4b38-86f3-56ee7f5e0e70 ==============================
[0m16:26:30.426673 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:26:30.428042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:26:30.545381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '730cb319-0099-4b38-86f3-56ee7f5e0e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd02f790>]}
[0m16:26:30.573218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m16:26:30.574435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '730cb319-0099-4b38-86f3-56ee7f5e0e70', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd01a810>]}
[0m16:26:30.623794 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.28448066, "process_user_time": 1.560778, "process_kernel_time": 0.117794, "process_mem_max_rss": "90568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:26:30.625384 [debug] [MainThread]: Command `dbt clean` succeeded at 16:26:30.625213 after 0.29 seconds
[0m16:26:30.626724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeccfd5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd4a57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0a3ca10>]}
[0m16:26:30.628213 [debug] [MainThread]: Flushing usage events
[0m16:26:34.621356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8866fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8866f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b88622d10>]}


============================== 16:26:34.625458 | 3f86224a-7f29-4ffb-9ff7-138829952af1 ==============================
[0m16:26:34.625458 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:26:34.627094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:26:34.838883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b88bc1810>]}
[0m16:26:34.904850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8a3d1c10>]}
[0m16:26:34.907005 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:26:34.920097 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:26:34.925115 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:26:34.926491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b88b3a3d0>]}
[0m16:26:36.172695 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:26:36.174381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b877add10>]}
[0m16:26:36.189063 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_users' in the 'models' section of file 'models/marts/schema.yml'
[0m16:26:36.194424 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_posts' in the 'models' section of file 'models/marts/schema.yml'
[0m16:26:36.201706 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_post_interactions' in the 'models' section of file 'models/marts/schema.yml'
[0m16:26:36.433685 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_user_sk.f0e7c6f32b' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:26:36.435538 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_users_user_sk.d698f5c511' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:26:36.436928 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_user_id.e754bb5812' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:26:36.438286 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_users_user_id.bcdc17b9f9' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:26:36.439541 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_users_username.5b75869fce' (models/marts/schema.yml) depends on a node named 'dim_users' in package '' which was not found
[0m16:26:36.441002 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_posts_post_sk.803944b4d7' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:26:36.442220 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_posts_post_sk.057cbb334b' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:26:36.443373 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_posts_post_id.58e6ef274f' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:26:36.444503 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_posts_post_id.a230feec04' (models/marts/schema.yml) depends on a node named 'dim_posts' in package '' which was not found
[0m16:26:36.445593 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_fact_post_interactions_post_sk.17151d5a27' (models/marts/schema.yml) depends on a node named 'fact_post_interactions' in package '' which was not found
[0m16:26:36.446741 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_fact_post_interactions_user_sk.30ad83908b' (models/marts/schema.yml) depends on a node named 'fact_post_interactions' in package '' which was not found
[0m16:26:36.560461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:26:36.572710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b86fd3790>]}
[0m16:26:36.800003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b86760f50>]}
[0m16:26:36.801874 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:26:36.803240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f86224a-7f29-4ffb-9ff7-138829952af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8678b610>]}
[0m16:26:36.806435 [info ] [MainThread]: 
[0m16:26:36.807771 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:26:36.809640 [debug] [MainThread]: Command end result
[0m16:26:36.871952 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3378804, "process_user_time": 3.316129, "process_kernel_time": 0.149375, "process_mem_max_rss": "107712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:26:36.873533 [debug] [MainThread]: Command `dbt test` succeeded at 16:26:36.873397 after 2.34 seconds
[0m16:26:36.874745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8bfb0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8c130350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8c130c50>]}
[0m16:26:36.875993 [debug] [MainThread]: Flushing usage events
[0m16:27:19.686712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe63298210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe63625550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe63625390>]}


============================== 16:27:19.690621 | 98366ca0-5015-4e06-8b66-2146df9bad27 ==============================
[0m16:27:19.690621 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:27:19.691887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:27:19.887492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe62782390>]}
[0m16:27:19.952545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe64ffdd50>]}
[0m16:27:19.954339 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:27:19.967513 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:27:20.232494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:20.233638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:20.242497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:27:20.291025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe61faa390>]}
[0m16:27:20.444180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe62320b90>]}
[0m16:27:20.445703 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:27:20.447209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe62362390>]}
[0m16:27:20.451319 [info ] [MainThread]: 
[0m16:27:20.453053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:27:20.459446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:27:20.503961 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:27:20.505327 [debug] [ThreadPool]: On list_warehouse: /* 1.8.6 running in dev mode */

    select distinct nspname from pg_namespace
  
[0m16:27:20.506310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:20.512157 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:27:20.514613 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:27:20.517527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m16:27:20.526561 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:27:20.527927 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:27:20.528927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:20.533572 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:27:20.534707 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:27:20.535712 [debug] [ThreadPool]: On list_warehouse_public: /* 1.8.6 running in dev mode */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:27:20.539455 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m16:27:20.541949 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:27:20.543247 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:27:20.551955 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.553161 [debug] [MainThread]: On master: BEGIN
[0m16:27:20.554362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:20.559962 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:27:20.561252 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.562552 [debug] [MainThread]: On master: /* 1.8.6 running in dev mode */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:20.577170 [debug] [MainThread]: SQL status: SELECT 8 in 0.013 seconds
[0m16:27:20.581458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe61b99490>]}
[0m16:27:20.582662 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:20.583866 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.585167 [debug] [MainThread]: On master: BEGIN
[0m16:27:20.586570 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:27:20.587636 [debug] [MainThread]: On master: COMMIT
[0m16:27:20.588605 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.589693 [debug] [MainThread]: On master: COMMIT
[0m16:27:20.591024 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:27:20.592350 [debug] [MainThread]: On master: Close
[0m16:27:20.593724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:27:20.594838 [info ] [MainThread]: 
[0m16:27:20.600145 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m16:27:20.600733 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m16:27:20.601280 [debug] [Thread-3 (]: Began running node model.dbt_project.tag_analysis_mart
[0m16:27:20.602033 [debug] [Thread-4 (]: Began running node model.dbt_project.user_engagement_mart
[0m16:27:20.602991 [info ] [Thread-1 (]: 1 of 4 START sql view model public.content_performance_mart .................... [RUN]
[0m16:27:20.604276 [info ] [Thread-2 (]: 2 of 4 START sql view model public.location_analysis_mart ...................... [RUN]
[0m16:27:20.605646 [info ] [Thread-3 (]: 3 of 4 START sql view model public.tag_analysis_mart ........................... [RUN]
[0m16:27:20.607110 [info ] [Thread-4 (]: 4 of 4 START sql view model public.user_engagement_mart ........................ [RUN]
[0m16:27:20.608273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m16:27:20.609455 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m16:27:20.610508 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.tag_analysis_mart'
[0m16:27:20.611557 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.user_engagement_mart'
[0m16:27:20.612671 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m16:27:20.614040 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m16:27:20.615088 [debug] [Thread-3 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m16:27:20.616038 [debug] [Thread-4 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m16:27:20.627209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m16:27:20.632019 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m16:27:20.637287 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m16:27:20.642447 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m16:27:20.658381 [debug] [Thread-3 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m16:27:20.666675 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m16:27:20.713983 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.tag_analysis_mart"
[0m16:27:20.717242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.content_performance_mart"
[0m16:27:20.717826 [debug] [Thread-4 (]: Began executing node model.dbt_project.user_engagement_mart
[0m16:27:20.718416 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m16:27:20.725973 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.user_engagement_mart"
[0m16:27:20.731780 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.location_analysis_mart"
[0m16:27:20.745037 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:27:20.746844 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: BEGIN
[0m16:27:20.748121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:27:20.748657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:27:20.750721 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:27:20.752048 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: BEGIN
[0m16:27:20.752998 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:27:20.753891 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: BEGIN
[0m16:27:20.754420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:27:20.755333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:20.756625 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: BEGIN
[0m16:27:20.757797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:27:20.758986 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:27:20.761037 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:27:20.763915 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."location_analysis_mart__dbt_tmp"
    
    
  as (
    WITH location_performance AS (
    SELECT 
        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts
        SUM(fpi.like_count) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts
    GROUP BY dp.location  -- Group by location from dim_posts
)

SELECT * FROM location_performance
  );
[0m16:27:20.765329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:27:20.767022 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:27:20.769237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:27:20.770618 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:27:20.771175 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:27:20.771988 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:27:20.773380 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."content_performance_mart__dbt_tmp"
    
    
  as (
    select
    dp.post_sk,
    dp.post_id,
    dp.post_text,
    dp.post_timestamp,
    dp.tags,
    dp.location,
    COALESCE(SUM(fpi.like_count), 0) AS total_likes,  -- This ensures no NULLs in total_likes
    COALESCE(SUM(fpi.shares), 0) AS total_shares,
    COALESCE(COUNT(fpi.comment_text), 0) AS total_comments,
    COALESCE(SUM(fpi.angry), 0) AS total_angry,
    COALESCE(SUM(fpi.haha), 0) AS total_haha,
    COALESCE(SUM(fpi.love), 0) AS total_love,
    COALESCE(SUM(fpi.sad), 0) AS total_sad,
    COALESCE(SUM(fpi.wow), 0) AS total_wow,
    COALESCE(COUNT(DISTINCT fpi.user_sk), 0) AS total_users_interacted
FROM "warehouse"."public"."dim_posts" dp
LEFT JOIN "warehouse"."public"."fact_post_interactions" fpi
    ON dp.post_sk = fpi.post_sk
GROUP BY dp.post_sk, dp.post_id, dp.post_text, dp.post_timestamp, dp.tags, dp.location
  );
[0m16:27:20.775077 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:27:20.776666 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."tag_analysis_mart__dbt_tmp"
    
    
  as (
    WITH tag_analysis AS (
    SELECT 
        COALESCE(dp.tags, '') AS tags,
        COALESCE(SUM(fpi.like_count), 0) AS total_likes,
        SUM(fpi.shares) AS total_shares,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,
        AVG(fpi.like_count) AS avg_likes_per_tag
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_posts" dp ON fpi.post_sk = dp.post_sk
    GROUP BY dp.tags
)

SELECT * FROM tag_analysis
  );
[0m16:27:20.786854 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:27:20.789606 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */

  create view "warehouse"."public"."user_engagement_mart__dbt_tmp"
    
    
  as (
    WITH user_engagement AS (
    SELECT 
        fpi.user_sk,
        du.username,
        SUM(fpi.shares) AS total_shares,
        SUM(fpi.like_count) AS total_likes,
        COUNT(fpi.comment_text) AS total_comments,
        SUM(fpi.angry) AS total_angry,
        SUM(fpi.haha) AS total_haha,
        SUM(fpi.love) AS total_love,
        SUM(fpi.sad) AS total_sad,
        SUM(fpi.wow) AS total_wow,
        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank
    FROM "warehouse"."public"."fact_post_interactions" fpi
    JOIN "warehouse"."public"."dim_users" du ON fpi.user_sk = du.user_sk
    GROUP BY fpi.user_sk, du.username
)

SELECT * FROM user_engagement
  );
[0m16:27:20.791314 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:27:20.793165 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart" rename to "location_analysis_mart__dbt_backup"
[0m16:27:20.794308 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:27:20.801538 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:27:20.801014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:27:20.803404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.808750 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:27:20.815964 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:27:20.817198 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart" rename to "content_performance_mart__dbt_backup"
[0m16:27:20.822128 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:27:20.823511 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart" rename to "tag_analysis_mart__dbt_backup"
[0m16:27:20.824993 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart" rename to "user_engagement_mart__dbt_backup"
[0m16:27:20.827180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.827816 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."location_analysis_mart__dbt_tmp" rename to "location_analysis_mart"
[0m16:27:20.829948 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.831156 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.835688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:27:20.837870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.842655 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:27:20.849682 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:27:20.850923 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."content_performance_mart__dbt_tmp" rename to "content_performance_mart"
[0m16:27:20.874668 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."tag_analysis_mart__dbt_tmp" rename to "tag_analysis_mart"
[0m16:27:20.879612 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:27:20.880984 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
alter table "warehouse"."public"."user_engagement_mart__dbt_tmp" rename to "user_engagement_mart"
[0m16:27:20.882763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.884022 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.884574 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:27:20.886237 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:27:20.888063 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:27:20.890819 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:27:20.892145 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: COMMIT
[0m16:27:20.895028 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:27:20.896235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:27:20.897642 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:27:20.899742 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:27:20.900876 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:27:20.901591 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: COMMIT
[0m16:27:20.902954 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: COMMIT
[0m16:27:20.904378 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: COMMIT
[0m16:27:20.919615 [debug] [Thread-2 (]: Applying DROP to: "warehouse"."public"."location_analysis_mart__dbt_backup"
[0m16:27:20.923015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:27:20.924151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:27:20.934439 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.location_analysis_mart"
[0m16:27:20.935033 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m16:27:20.941200 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."content_performance_mart__dbt_backup"
[0m16:27:20.946338 [debug] [Thread-3 (]: Applying DROP to: "warehouse"."public"."tag_analysis_mart__dbt_backup"
[0m16:27:20.947819 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."location_analysis_mart__dbt_backup" cascade
[0m16:27:20.953381 [debug] [Thread-4 (]: Applying DROP to: "warehouse"."public"."user_engagement_mart__dbt_backup"
[0m16:27:20.955553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.content_performance_mart"
[0m16:27:20.957605 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.tag_analysis_mart"
[0m16:27:20.961395 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.user_engagement_mart"
[0m16:27:20.962449 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:27:20.963759 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."content_performance_mart__dbt_backup" cascade
[0m16:27:20.965029 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."tag_analysis_mart__dbt_backup" cascade
[0m16:27:20.966542 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: /* 1.8.6 running in dev mode */
drop view if exists "warehouse"."public"."user_engagement_mart__dbt_backup" cascade
[0m16:27:20.971973 [debug] [Thread-2 (]: On model.dbt_project.location_analysis_mart: Close
[0m16:27:20.978198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:27:20.979410 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe607f7e90>]}
[0m16:27:20.980002 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:27:20.980521 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:27:20.983268 [debug] [Thread-1 (]: On model.dbt_project.content_performance_mart: Close
[0m16:27:20.985241 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.location_analysis_mart ................. [[32mCREATE VIEW[0m in 0.37s]
[0m16:27:20.989342 [debug] [Thread-3 (]: On model.dbt_project.tag_analysis_mart: Close
[0m16:27:20.992233 [debug] [Thread-4 (]: On model.dbt_project.user_engagement_mart: Close
[0m16:27:20.994038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe606647d0>]}
[0m16:27:20.996009 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m16:27:20.998449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6328e410>]}
[0m16:27:21.000290 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98366ca0-5015-4e06-8b66-2146df9bad27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe606c0250>]}
[0m16:27:21.002216 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.content_performance_mart ............... [[32mCREATE VIEW[0m in 0.39s]
[0m16:27:21.005742 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.tag_analysis_mart ...................... [[32mCREATE VIEW[0m in 0.39s]
[0m16:27:21.009807 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.user_engagement_mart ................... [[32mCREATE VIEW[0m in 0.39s]
[0m16:27:21.012461 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m16:27:21.014445 [debug] [Thread-3 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m16:27:21.016746 [debug] [Thread-4 (]: Finished running node model.dbt_project.user_engagement_mart
[0m16:27:21.024630 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:21.026862 [debug] [MainThread]: On master: BEGIN
[0m16:27:21.028556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:21.034697 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:27:21.036473 [debug] [MainThread]: On master: COMMIT
[0m16:27:21.038087 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:21.039637 [debug] [MainThread]: On master: COMMIT
[0m16:27:21.041634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:27:21.043116 [debug] [MainThread]: On master: Close
[0m16:27:21.044871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:21.046934 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m16:27:21.048492 [debug] [MainThread]: Connection 'model.dbt_project.location_analysis_mart' was properly closed.
[0m16:27:21.049977 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m16:27:21.051550 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m16:27:21.053154 [info ] [MainThread]: 
[0m16:27:21.054709 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m16:27:21.057812 [debug] [MainThread]: Command end result
[0m16:27:21.151580 [info ] [MainThread]: 
[0m16:27:21.153130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:21.154765 [info ] [MainThread]: 
[0m16:27:21.157019 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:27:21.159245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5421932, "process_user_time": 2.456466, "process_kernel_time": 0.138671, "process_mem_max_rss": "110336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:27:21.161055 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:21.160792 after 1.54 seconds
[0m16:27:21.162634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe66bd4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6330a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe66d54410>]}
[0m16:27:21.163927 [debug] [MainThread]: Flushing usage events
[0m16:27:25.763962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f2544550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f28d9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f253bb10>]}


============================== 16:27:25.768205 | 17d11a83-2b0d-4da2-988a-2fd0e8e8aa0c ==============================
[0m16:27:25.768205 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:27:25.769959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:27:25.980654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17d11a83-2b0d-4da2-988a-2fd0e8e8aa0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f1d82750>]}
[0m16:27:26.049077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17d11a83-2b0d-4da2-988a-2fd0e8e8aa0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f42b20d0>]}
[0m16:27:26.051122 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:27:26.065522 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:27:26.352510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:26.354091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:26.362395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m16:27:26.413870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17d11a83-2b0d-4da2-988a-2fd0e8e8aa0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f15aa390>]}
[0m16:27:26.590395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17d11a83-2b0d-4da2-988a-2fd0e8e8aa0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f09c7650>]}
[0m16:27:26.591973 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m16:27:26.593483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17d11a83-2b0d-4da2-988a-2fd0e8e8aa0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f2586250>]}
[0m16:27:26.596592 [info ] [MainThread]: 
[0m16:27:26.597890 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:27:26.601304 [debug] [MainThread]: Command end result
[0m16:27:26.665007 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9930734, "process_user_time": 2.187993, "process_kernel_time": 0.092018, "process_mem_max_rss": "101828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:27:26.666206 [debug] [MainThread]: Command `dbt test` succeeded at 16:27:26.666045 after 0.99 seconds
[0m16:27:26.667304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f28d9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f5e84ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f6004e50>]}
[0m16:27:26.668387 [debug] [MainThread]: Flushing usage events
[0m19:20:57.054198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa4fce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa5299d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aac5d990>]}


============================== 19:20:57.063871 | 4f2e452e-2d6c-4e6e-bce8-63d978eb3c6b ==============================
[0m19:20:57.063871 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:20:57.065693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:57.302646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f2e452e-2d6c-4e6e-bce8-63d978eb3c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa5295d0>]}
[0m19:20:57.371397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f2e452e-2d6c-4e6e-bce8-63d978eb3c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aaa49d90>]}
[0m19:21:24.588332 [error] [MainThread]: Encountered an error:

[0m19:21:24.615132 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:21:24.629969 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 27.661848, "process_user_time": 1.928509, "process_kernel_time": 0.615911, "process_mem_max_rss": "97732", "process_in_blocks": "3392", "process_out_blocks": "1192", "command_success": false}
[0m19:21:24.641596 [debug] [MainThread]: Command `dbt docs serve` failed at 19:21:24.640953 after 27.67 seconds
[0m19:21:24.647396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa53d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa4fd4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa4fc090>]}
[0m19:21:24.652179 [debug] [MainThread]: Flushing usage events
[0m19:21:47.723513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b99e8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b99de8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b9f7d990>]}


============================== 19:21:47.727783 | f8cdbb1f-f855-432a-8494-0bc8d0f90269 ==============================
[0m19:21:47.727783 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:21:47.729309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m19:21:47.942778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8cdbb1f-f855-432a-8494-0bc8d0f90269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b954add0>]}
[0m19:21:48.010058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8cdbb1f-f855-432a-8494-0bc8d0f90269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24bb791e10>]}
[0m19:21:48.012410 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:21:48.030894 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:21:48.336114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:48.337642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:48.345440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.marts
[0m19:21:48.392956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8cdbb1f-f855-432a-8494-0bc8d0f90269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b91d4050>]}
[0m19:21:48.428488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8cdbb1f-f855-432a-8494-0bc8d0f90269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b9a2b890>]}
[0m19:21:48.430223 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m19:21:48.431734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8cdbb1f-f855-432a-8494-0bc8d0f90269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b8d08990>]}
[0m19:21:48.435097 [info ] [MainThread]: 
[0m19:21:48.436496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:21:48.442786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:21:48.533736 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:21:48.535156 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:21:48.536444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:48.552102 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:21:48.553576 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:21:48.554799 [debug] [ThreadPool]: On list_warehouse_public: /* 1.8.6 running in dev mode */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:21:48.569105 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m19:21:48.571845 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:21:48.573305 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:21:48.581643 [debug] [MainThread]: Using postgres connection "master"
[0m19:21:48.583051 [debug] [MainThread]: On master: BEGIN
[0m19:21:48.584460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:48.589836 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:21:48.591486 [debug] [MainThread]: Using postgres connection "master"
[0m19:21:48.593113 [debug] [MainThread]: On master: /* 1.8.6 running in dev mode */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:21:48.617480 [debug] [MainThread]: SQL status: SELECT 8 in 0.023 seconds
[0m19:21:48.622100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8cdbb1f-f855-432a-8494-0bc8d0f90269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b94bced0>]}
[0m19:21:48.623660 [debug] [MainThread]: On master: ROLLBACK
[0m19:21:48.625289 [debug] [MainThread]: On master: Close
[0m19:21:48.627116 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:21:48.628477 [info ] [MainThread]: 
[0m19:21:48.640600 [debug] [Thread-1 (]: Began running node model.dbt_project.content_performance_mart
[0m19:21:48.641316 [debug] [Thread-2 (]: Began running node model.dbt_project.location_analysis_mart
[0m19:21:48.641945 [debug] [Thread-3 (]: Began running node model.dbt_project.tag_analysis_mart
[0m19:21:48.642541 [debug] [Thread-4 (]: Began running node model.dbt_project.user_engagement_mart
[0m19:21:48.643513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.dbt_project.content_performance_mart)
[0m19:21:48.644909 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.location_analysis_mart'
[0m19:21:48.646539 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.tag_analysis_mart'
[0m19:21:48.648233 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.user_engagement_mart'
[0m19:21:48.649782 [debug] [Thread-1 (]: Began compiling node model.dbt_project.content_performance_mart
[0m19:21:48.651076 [debug] [Thread-2 (]: Began compiling node model.dbt_project.location_analysis_mart
[0m19:21:48.652412 [debug] [Thread-3 (]: Began compiling node model.dbt_project.tag_analysis_mart
[0m19:21:48.653823 [debug] [Thread-4 (]: Began compiling node model.dbt_project.user_engagement_mart
[0m19:21:48.664973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.content_performance_mart"
[0m19:21:48.670063 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.location_analysis_mart"
[0m19:21:48.676293 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.tag_analysis_mart"
[0m19:21:48.681485 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.user_engagement_mart"
[0m19:21:48.691971 [debug] [Thread-3 (]: Began executing node model.dbt_project.tag_analysis_mart
[0m19:21:48.692534 [debug] [Thread-2 (]: Began executing node model.dbt_project.location_analysis_mart
[0m19:21:48.693531 [debug] [Thread-4 (]: Began executing node model.dbt_project.user_engagement_mart
[0m19:21:48.694668 [debug] [Thread-3 (]: Finished running node model.dbt_project.tag_analysis_mart
[0m19:21:48.695447 [debug] [Thread-1 (]: Began executing node model.dbt_project.content_performance_mart
[0m19:21:48.696894 [debug] [Thread-2 (]: Finished running node model.dbt_project.location_analysis_mart
[0m19:21:48.698687 [debug] [Thread-4 (]: Finished running node model.dbt_project.user_engagement_mart
[0m19:21:48.701539 [debug] [Thread-1 (]: Finished running node model.dbt_project.content_performance_mart
[0m19:21:48.706009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:48.707007 [debug] [MainThread]: Connection 'model.dbt_project.content_performance_mart' was properly closed.
[0m19:21:48.707946 [debug] [MainThread]: Connection 'model.dbt_project.location_analysis_mart' was properly closed.
[0m19:21:48.708976 [debug] [MainThread]: Connection 'model.dbt_project.tag_analysis_mart' was properly closed.
[0m19:21:48.709945 [debug] [MainThread]: Connection 'model.dbt_project.user_engagement_mart' was properly closed.
[0m19:21:48.711736 [debug] [MainThread]: Command end result
[0m19:21:48.886792 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:21:48.887862 [info ] [MainThread]: Building catalog
[0m19:21:48.901711 [debug] [ThreadPool]: Acquiring new postgres connection 'warehouse.information_schema'
[0m19:21:48.912137 [debug] [ThreadPool]: Using postgres connection "warehouse.information_schema"
[0m19:21:48.913618 [debug] [ThreadPool]: On warehouse.information_schema: BEGIN
[0m19:21:48.915029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:48.920218 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:21:48.921704 [debug] [ThreadPool]: Using postgres connection "warehouse.information_schema"
[0m19:21:48.923107 [debug] [ThreadPool]: On warehouse.information_schema: /* 1.8.6 running in dev mode */

    
    

    select
        'warehouse' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('user_engagement_mart')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('tag_analysis_mart')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_posts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('content_performance_mart')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('location_analysis_mart')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_post_interactions')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:21:48.938100 [debug] [ThreadPool]: SQL status: SELECT 74 in 0.013 seconds
[0m19:21:48.947454 [debug] [ThreadPool]: On warehouse.information_schema: ROLLBACK
[0m19:21:48.949311 [debug] [ThreadPool]: On warehouse.information_schema: Close
[0m19:21:49.029660 [info ] [MainThread]: Catalog written to /app/target/catalog.json
[0m19:21:49.031971 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3880641, "process_user_time": 2.28291, "process_kernel_time": 0.176362, "process_mem_max_rss": "109104", "process_in_blocks": "48", "process_out_blocks": "152"}
[0m19:21:49.033773 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:21:49.033597 after 1.39 seconds
[0m19:21:49.035058 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:21:49.036557 [debug] [MainThread]: Connection 'warehouse.information_schema' was properly closed.
[0m19:21:49.038016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24bd36cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24bafa9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b9109890>]}
[0m19:21:49.039164 [debug] [MainThread]: Flushing usage events
