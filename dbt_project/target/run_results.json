{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-10-04T19:21:48.710822Z", "invocation_id": "f8cdbb1f-f855-432a-8494-0bc8d0f90269", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-04T19:21:48.672388Z", "completed_at": "2024-10-04T19:21:48.691673Z"}, {"name": "execute", "started_at": "2024-10-04T19:21:48.693928Z", "completed_at": "2024-10-04T19:21:48.693956Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.047803640365600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_project.tag_analysis_mart", "compiled": true, "compiled_code": "WITH tag_analysis AS (\n    SELECT \n        COALESCE(dp.tags, '') AS tags,\n        COALESCE(SUM(fpi.like_count), 0) AS total_likes,\n        SUM(fpi.shares) AS total_shares,\n        COUNT(fpi.comment_text) AS total_comments,\n        SUM(fpi.angry) AS total_angry,\n        SUM(fpi.haha) AS total_haha,\n        SUM(fpi.love) AS total_love,\n        SUM(fpi.sad) AS total_sad,\n        SUM(fpi.wow) AS total_wow,\n        COUNT(DISTINCT fpi.post_sk) AS total_posts_with_tag,\n        AVG(fpi.like_count) AS avg_likes_per_tag\n    FROM \"warehouse\".\"public\".\"fact_post_interactions\" fpi\n    JOIN \"warehouse\".\"public\".\"dim_posts\" dp ON fpi.post_sk = dp.post_sk\n    GROUP BY dp.tags\n)\n\nSELECT * FROM tag_analysis", "relation_name": "\"warehouse\".\"public\".\"tag_analysis_mart\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-04T19:21:48.666112Z", "completed_at": "2024-10-04T19:21:48.692330Z"}, {"name": "execute", "started_at": "2024-10-04T19:21:48.696387Z", "completed_at": "2024-10-04T19:21:48.696404Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05183744430541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_project.location_analysis_mart", "compiled": true, "compiled_code": "WITH location_performance AS (\n    SELECT \n        COALESCE(dp.location, 'Unknown Location') AS location,  -- Use location from dim_posts\n        SUM(fpi.like_count) AS total_likes,\n        SUM(fpi.shares) AS total_shares,\n        COUNT(fpi.comment_text) AS total_comments,\n        SUM(fpi.angry) AS total_angry,\n        SUM(fpi.haha) AS total_haha,\n        SUM(fpi.love) AS total_love,\n        SUM(fpi.sad) AS total_sad,\n        SUM(fpi.wow) AS total_wow,\n        COUNT(DISTINCT fpi.user_sk) AS total_users_in_location\n    FROM \"warehouse\".\"public\".\"fact_post_interactions\" fpi\n    JOIN \"warehouse\".\"public\".\"dim_posts\" dp ON fpi.post_sk = dp.post_sk  -- Join with dim_posts\n    GROUP BY dp.location  -- Group by location from dim_posts\n)\n\nSELECT * FROM location_performance", "relation_name": "\"warehouse\".\"public\".\"location_analysis_mart\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-04T19:21:48.677947Z", "completed_at": "2024-10-04T19:21:48.693287Z"}, {"name": "execute", "started_at": "2024-10-04T19:21:48.698171Z", "completed_at": "2024-10-04T19:21:48.698186Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05028104782104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_project.user_engagement_mart", "compiled": true, "compiled_code": "WITH user_engagement AS (\n    SELECT \n        fpi.user_sk,\n        du.username,\n        SUM(fpi.shares) AS total_shares,\n        SUM(fpi.like_count) AS total_likes,\n        COUNT(fpi.comment_text) AS total_comments,\n        SUM(fpi.angry) AS total_angry,\n        SUM(fpi.haha) AS total_haha,\n        SUM(fpi.love) AS total_love,\n        SUM(fpi.sad) AS total_sad,\n        SUM(fpi.wow) AS total_wow,\n        RANK() OVER (ORDER BY SUM(fpi.like_count) DESC) AS engagement_rank\n    FROM \"warehouse\".\"public\".\"fact_post_interactions\" fpi\n    JOIN \"warehouse\".\"public\".\"dim_users\" du ON fpi.user_sk = du.user_sk\n    GROUP BY fpi.user_sk, du.username\n)\n\nSELECT * FROM user_engagement", "relation_name": "\"warehouse\".\"public\".\"user_engagement_mart\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-04T19:21:48.654930Z", "completed_at": "2024-10-04T19:21:48.695210Z"}, {"name": "execute", "started_at": "2024-10-04T19:21:48.701010Z", "completed_at": "2024-10-04T19:21:48.701026Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.057855844497680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_project.content_performance_mart", "compiled": true, "compiled_code": "select\n    dp.post_sk,\n    dp.post_id,\n    dp.post_text,\n    dp.post_timestamp,\n    dp.tags,\n    dp.location,\n    COALESCE(SUM(fpi.like_count), 0) AS total_likes,  -- This ensures no NULLs in total_likes\n    COALESCE(SUM(fpi.shares), 0) AS total_shares,\n    COALESCE(COUNT(fpi.comment_text), 0) AS total_comments,\n    COALESCE(SUM(fpi.angry), 0) AS total_angry,\n    COALESCE(SUM(fpi.haha), 0) AS total_haha,\n    COALESCE(SUM(fpi.love), 0) AS total_love,\n    COALESCE(SUM(fpi.sad), 0) AS total_sad,\n    COALESCE(SUM(fpi.wow), 0) AS total_wow,\n    COALESCE(COUNT(DISTINCT fpi.user_sk), 0) AS total_users_interacted\nFROM \"warehouse\".\"public\".\"dim_posts\" dp\nLEFT JOIN \"warehouse\".\"public\".\"fact_post_interactions\" fpi\n    ON dp.post_sk = fpi.post_sk\nGROUP BY dp.post_sk, dp.post_id, dp.post_text, dp.post_timestamp, dp.tags, dp.location", "relation_name": "\"warehouse\".\"public\".\"content_performance_mart\""}], "elapsed_time": 0.2745819091796875, "args": {"favor_state": false, "project_dir": "/app", "empty_catalog": false, "populate_cache": true, "require_resource_names_without_spaces": false, "profiles_dir": "/root/.dbt", "use_colors": true, "vars": {}, "log_level": "info", "macro_debugging": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "log_level_file": "debug", "print": true, "invocation_command": "dbt docs generate", "select": [], "printer_width": 80, "indirect_selection": "eager", "static": false, "require_explicit_package_overrides_for_builtin_materializations": true, "version_check": true, "static_parser": true, "log_format": "default", "cache_selected_only": false, "partial_parse": true, "fail_fast": true, "exclude": [], "source_freshness_run_project_hooks": false, "strict_mode": false, "use_colors_file": true, "show_resource_report": false, "log_path": "/app/logs", "introspect": true, "quiet": false, "which": "generate", "warn_error_options": {"include": [], "exclude": []}, "defer": false, "log_format_file": "debug", "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "compile": true, "write_json": true}}